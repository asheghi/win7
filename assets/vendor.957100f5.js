var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e};function makeMap(e,t){const r=Object.create(null),n=e.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return t?e=>!!r[e.toLowerCase()]:e=>!!r[e]}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(e){return!!e||""===e}function normalizeStyle(e){if(isArray(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=isString(n)?parseStringStyle(n):normalizeStyle(n);if(i)for(const e in i)t[e]=i[e]}return t}return isString(e)||isObject(e)?e:void 0}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:(.+)/;function parseStringStyle(e){const t={};return e.split(listDelimiterRE).forEach((e=>{if(e){const r=e.split(propertyDelimiterRE);r.length>1&&(t[r[0].trim()]=r[1].trim())}})),t}function normalizeClass(e){let t="";if(isString(e))t=e;else if(isArray(e))for(let r=0;r<e.length;r++){const n=normalizeClass(e[r]);n&&(t+=n+" ")}else if(isObject(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}function normalizeProps(e){if(!e)return null;let{class:t,style:r}=e;return t&&!isString(t)&&(e.class=normalizeClass(t)),r&&(e.style=normalizeStyle(r)),e}const toDisplayString=e=>null==e?"":isArray(e)||isObject(e)&&(e.toString===objectToString||!isFunction(e.toString))?JSON.stringify(e,replacer,2):String(e),replacer=(e,t)=>t&&t.__v_isRef?replacer(e,t.value):isMap(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,r])=>(e[`${t} =>`]=r,e)),{})}:isSet(t)?{[`Set(${t.size})`]:[...t.values()]}:!isObject(t)||isArray(t)||isPlainObject(t)?t:String(t),EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,onRE=/^on[^a-z]/,isOn=e=>onRE.test(e),isModelListener=e=>e.startsWith("onUpdate:"),extend=Object.assign,remove=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},hasOwnProperty=Object.prototype.hasOwnProperty,hasOwn=(e,t)=>hasOwnProperty.call(e,t),isArray=Array.isArray,isMap=e=>"[object Map]"===toTypeString(e),isSet=e=>"[object Set]"===toTypeString(e),isFunction=e=>"function"==typeof e,isString=e=>"string"==typeof e,isSymbol=e=>"symbol"==typeof e,isObject=e=>null!==e&&"object"==typeof e,isPromise=e=>isObject(e)&&isFunction(e.then)&&isFunction(e.catch),objectToString=Object.prototype.toString,toTypeString=e=>objectToString.call(e),toRawType=e=>toTypeString(e).slice(8,-1),isPlainObject=e=>"[object Object]"===toTypeString(e),isIntegerKey=e=>isString(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,isReservedProp=makeMap(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction((e=>e.replace(camelizeRE,((e,t)=>t?t.toUpperCase():"")))),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction((e=>e.replace(hyphenateRE,"-$1").toLowerCase())),capitalize=cacheStringFunction((e=>e.charAt(0).toUpperCase()+e.slice(1))),toHandlerKey=cacheStringFunction((e=>e?`on${capitalize(e)}`:"")),hasChanged=(e,t)=>!Object.is(e,t),invokeArrayFns=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},def=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},toNumber=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let activeEffectScope;const effectScopeStack=[];class EffectScope{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&activeEffectScope&&(this.parent=activeEffectScope,this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}run(e){if(this.active)try{return this.on(),e()}finally{this.off()}}on(){this.active&&(effectScopeStack.push(this),activeEffectScope=this)}off(){this.active&&(effectScopeStack.pop(),activeEffectScope=effectScopeStack[effectScopeStack.length-1])}stop(e){if(this.active){if(this.effects.forEach((e=>e.stop())),this.cleanups.forEach((e=>e())),this.scopes&&this.scopes.forEach((e=>e.stop(!0))),this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}function recordEffectScope(e,t){(t=t||activeEffectScope)&&t.active&&t.effects.push(e)}const createDep=e=>{const t=new Set(e);return t.w=0,t.n=0,t},wasTracked=e=>(e.w&trackOpBit)>0,newTracked=e=>(e.n&trackOpBit)>0,initDepMarkers=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=trackOpBit},finalizeDepMarkers=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const i=t[n];wasTracked(i)&&!newTracked(i)?i.delete(e):t[r++]=i,i.w&=~trackOpBit,i.n&=~trackOpBit}t.length=r}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30,effectStack=[];let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(e,t=null,r){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],recordEffectScope(this,r)}run(){if(!this.active)return this.fn();if(!effectStack.includes(this))try{return effectStack.push(activeEffect=this),enableTracking(),trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,resetTracking(),effectStack.pop();const e=effectStack.length;activeEffect=e>0?effectStack[e-1]:void 0}}stop(){this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function enableTracking(){trackStack.push(shouldTrack),shouldTrack=!0}function resetTracking(){const e=trackStack.pop();shouldTrack=void 0===e||e}function track(e,t,r){if(!isTracking())return;let n=targetMap.get(e);n||targetMap.set(e,n=new Map);let i=n.get(r);i||n.set(r,i=createDep()),trackEffects(i)}function isTracking(){return shouldTrack&&void 0!==activeEffect}function trackEffects(e,t){let r=!1;effectTrackDepth<=maxMarkerBits?newTracked(e)||(e.n|=trackOpBit,r=!wasTracked(e)):r=!e.has(activeEffect),r&&(e.add(activeEffect),activeEffect.deps.push(e))}function trigger$1(e,t,r,n,i,o){const a=targetMap.get(e);if(!a)return;let s=[];if("clear"===t)s=[...a.values()];else if("length"===r&&isArray(e))a.forEach(((e,t)=>{("length"===t||t>=n)&&s.push(e)}));else switch(void 0!==r&&s.push(a.get(r)),t){case"add":isArray(e)?isIntegerKey(r)&&s.push(a.get("length")):(s.push(a.get(ITERATE_KEY)),isMap(e)&&s.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray(e)||(s.push(a.get(ITERATE_KEY)),isMap(e)&&s.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(e)&&s.push(a.get(ITERATE_KEY))}if(1===s.length)s[0]&&triggerEffects(s[0]);else{const e=[];for(const t of s)t&&e.push(...t);triggerEffects(createDep(e))}}function triggerEffects(e,t){for(const r of isArray(e)?e:[...e])(r!==activeEffect||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(isSymbol)),get=createGetter(),shallowGet=createGetter(!1,!0),readonlyGet=createGetter(!0),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const r=toRaw(this);for(let t=0,i=this.length;t<i;t++)track(r,"get",t+"");const n=r[t](...e);return-1===n||!1===n?r[t](...e.map(toRaw)):n}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){pauseTracking();const r=toRaw(this)[t].apply(this,e);return resetTracking(),r}})),e}function createGetter(e=!1,t=!1){return function(r,n,i){if("__v_isReactive"===n)return!e;if("__v_isReadonly"===n)return e;if("__v_raw"===n&&i===(e?t?shallowReadonlyMap:readonlyMap:t?shallowReactiveMap:reactiveMap).get(r))return r;const o=isArray(r);if(!e&&o&&hasOwn(arrayInstrumentations,n))return Reflect.get(arrayInstrumentations,n,i);const a=Reflect.get(r,n,i);if(isSymbol(n)?builtInSymbols.has(n):isNonTrackableKeys(n))return a;if(e||track(r,"get",n),t)return a;if(isRef(a)){return!o||!isIntegerKey(n)?a.value:a}return isObject(a)?e?readonly(a):reactive(a):a}}const set=createSetter(),shallowSet=createSetter(!0);function createSetter(e=!1){return function(t,r,n,i){let o=t[r];if(!e&&(n=toRaw(n),o=toRaw(o),!isArray(t)&&isRef(o)&&!isRef(n)))return o.value=n,!0;const a=isArray(t)&&isIntegerKey(r)?Number(r)<t.length:hasOwn(t,r),s=Reflect.set(t,r,n,i);return t===toRaw(i)&&(a?hasChanged(n,o)&&trigger$1(t,"set",r,n):trigger$1(t,"add",r,n)),s}}function deleteProperty(e,t){const r=hasOwn(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&trigger$1(e,"delete",t,void 0),n}function has(e,t){const r=Reflect.has(e,t);return isSymbol(t)&&builtInSymbols.has(t)||track(e,"has",t),r}function ownKeys(e){return track(e,"iterate",isArray(e)?"length":ITERATE_KEY),Reflect.ownKeys(e)}const mutableHandlers={get:get,set:set,deleteProperty:deleteProperty,has:has,ownKeys:ownKeys},readonlyHandlers={get:readonlyGet,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},shallowReactiveHandlers=extend({},mutableHandlers,{get:shallowGet,set:shallowSet}),toReactive=e=>isObject(e)?reactive(e):e,toReadonly=e=>isObject(e)?readonly(e):e,toShallow=e=>e,getProto=e=>Reflect.getPrototypeOf(e);function get$1(e,t,r=!1,n=!1){const i=toRaw(e=e.__v_raw),o=toRaw(t);t!==o&&!r&&track(i,"get",t),!r&&track(i,"get",o);const{has:a}=getProto(i),s=n?toShallow:r?toReadonly:toReactive;return a.call(i,t)?s(e.get(t)):a.call(i,o)?s(e.get(o)):void(e!==i&&e.get(t))}function has$1(e,t=!1){const r=this.__v_raw,n=toRaw(r),i=toRaw(e);return e!==i&&!t&&track(n,"has",e),!t&&track(n,"has",i),e===i?r.has(e):r.has(e)||r.has(i)}function size(e,t=!1){return e=e.__v_raw,!t&&track(toRaw(e),"iterate",ITERATE_KEY),Reflect.get(e,"size",e)}function add(e){e=toRaw(e);const t=toRaw(this);return getProto(t).has.call(t,e)||(t.add(e),trigger$1(t,"add",e,e)),this}function set$1(e,t){t=toRaw(t);const r=toRaw(this),{has:n,get:i}=getProto(r);let o=n.call(r,e);o||(e=toRaw(e),o=n.call(r,e));const a=i.call(r,e);return r.set(e,t),o?hasChanged(t,a)&&trigger$1(r,"set",e,t):trigger$1(r,"add",e,t),this}function deleteEntry(e){const t=toRaw(this),{has:r,get:n}=getProto(t);let i=r.call(t,e);i||(e=toRaw(e),i=r.call(t,e)),n&&n.call(t,e);const o=t.delete(e);return i&&trigger$1(t,"delete",e,void 0),o}function clear(){const e=toRaw(this),t=0!==e.size,r=e.clear();return t&&trigger$1(e,"clear",void 0,void 0),r}function createForEach(e,t){return function(r,n){const i=this,o=i.__v_raw,a=toRaw(o),s=t?toShallow:e?toReadonly:toReactive;return!e&&track(a,"iterate",ITERATE_KEY),o.forEach(((e,t)=>r.call(n,s(e),s(t),i)))}}function createIterableMethod(e,t,r){return function(...n){const i=this.__v_raw,o=toRaw(i),a=isMap(o),s="entries"===e||e===Symbol.iterator&&a,c="keys"===e&&a,u=i[e](...n),l=r?toShallow:t?toReadonly:toReactive;return!t&&track(o,"iterate",c?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:s?[l(e[0]),l(e[1])]:l(e),done:t}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(e){return function(...t){return"delete"!==e&&this}}function createInstrumentations(){const e={get(e){return get$1(this,e)},get size(){return size(this)},has:has$1,add:add,set:set$1,delete:deleteEntry,clear:clear,forEach:createForEach(!1,!1)},t={get(e){return get$1(this,e,!1,!0)},get size(){return size(this)},has:has$1,add:add,set:set$1,delete:deleteEntry,clear:clear,forEach:createForEach(!1,!0)},r={get(e){return get$1(this,e,!0)},get size(){return size(this,!0)},has(e){return has$1.call(this,e,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},n={get(e){return get$1(this,e,!0,!0)},get size(){return size(this,!0)},has(e){return has$1.call(this,e,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((i=>{e[i]=createIterableMethod(i,!1,!1),r[i]=createIterableMethod(i,!0,!1),t[i]=createIterableMethod(i,!1,!0),n[i]=createIterableMethod(i,!0,!0)})),[e,r,t,n]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(e,t){const r=t?e?shallowReadonlyInstrumentations:shallowInstrumentations:e?readonlyInstrumentations:mutableInstrumentations;return(t,n,i)=>"__v_isReactive"===n?!e:"__v_isReadonly"===n?e:"__v_raw"===n?t:Reflect.get(hasOwn(r,n)&&n in t?r:t,n,i)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(e){return e.__v_skip||!Object.isExtensible(e)?0:targetTypeMap(toRawType(e))}function reactive(e){return e&&e.__v_isReadonly?e:createReactiveObject(e,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(e){return createReactiveObject(e,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(e){return createReactiveObject(e,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(e,t,r,n,i){if(!isObject(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const o=i.get(e);if(o)return o;const a=getTargetType(e);if(0===a)return e;const s=new Proxy(e,2===a?n:r);return i.set(e,s),s}function isReactive(e){return isReadonly(e)?isReactive(e.__v_raw):!(!e||!e.__v_isReactive)}function isReadonly(e){return!(!e||!e.__v_isReadonly)}function isProxy(e){return isReactive(e)||isReadonly(e)}function toRaw(e){const t=e&&e.__v_raw;return t?toRaw(t):e}function markRaw(e){return def(e,"__v_skip",!0),e}function trackRefValue(e){isTracking()&&((e=toRaw(e)).dep||(e.dep=createDep()),trackEffects(e.dep))}function triggerRefValue(e,t){(e=toRaw(e)).dep&&triggerEffects(e.dep)}function isRef(e){return Boolean(e&&!0===e.__v_isRef)}function unref(e){return isRef(e)?e.value:e}const shallowUnwrapHandlers={get:(e,t,r)=>unref(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return isRef(i)&&!isRef(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function proxyRefs(e){return isReactive(e)?e:new Proxy(e,shallowUnwrapHandlers)}class ComputedRefImpl{constructor(e,t,r){this._setter=t,this.dep=void 0,this._dirty=!0,this.__v_isRef=!0,this.effect=new ReactiveEffect(e,(()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))})),this.__v_isReadonly=r}get value(){const e=toRaw(this);return trackRefValue(e),e._dirty&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function computed(e,t){let r,n;isFunction(e)?(r=e,n=NOOP):(r=e.get,n=e.set);return new ComputedRefImpl(r,n,isFunction(e)||!e.set)}Promise.resolve();const globalCompatConfig={MODE:2};function getCompatConfigForKey(e,t){const r=t&&t.type.compatConfig;return r&&e in r?r[e]:globalCompatConfig[e]}function isCompatEnabled(e,t,r=!1){if(!r&&t&&t.type.__isBuiltIn)return!1;const n=getCompatConfigForKey("MODE",t)||2,i=getCompatConfigForKey(e,t);return 2===(isFunction(n)?n(t&&t.type):n)?!1!==i:!0===i||"suppress-warning"===i}function emit(e,t,...r){const n=e.vnode.props||EMPTY_OBJ;let i=r;const o=t.startsWith("update:"),a=o&&t.slice(7);if(a&&a in n){const e=`${"modelValue"===a?"model":a}Modifiers`,{number:t,trim:o}=n[e]||EMPTY_OBJ;o?i=r.map((e=>e.trim())):t&&(i=r.map(toNumber))}let s,c=n[s=toHandlerKey(t)]||n[s=toHandlerKey(camelize(t))];!c&&o&&(c=n[s=toHandlerKey(hyphenate(t))]),c&&callWithAsyncErrorHandling(c,e,6,i);const u=n[s+"Once"];if(u){if(e.emitted){if(e.emitted[s])return}else e.emitted={};e.emitted[s]=!0,callWithAsyncErrorHandling(u,e,6,i)}}function normalizeEmitsOptions(e,t,r=!1){const n=t.emitsCache,i=n.get(e);if(void 0!==i)return i;const o=e.emits;let a={},s=!1;if(!isFunction(e)){const n=e=>{const r=normalizeEmitsOptions(e,t,!0);r&&(s=!0,extend(a,r))};!r&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}return o||s?(isArray(o)?o.forEach((e=>a[e]=null)):extend(a,o),n.set(e,a),a):(n.set(e,null),null)}function isEmitListener(e,t){return!(!e||!isOn(t))&&(t=t.slice(2).replace(/Once$/,""),hasOwn(e,t[0].toLowerCase()+t.slice(1))||hasOwn(e,hyphenate(t))||hasOwn(e,t))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(e){const t=currentRenderingInstance;return currentRenderingInstance=e,currentScopeId=e&&e.type.__scopeId||null,t}function pushScopeId(e){currentScopeId=e}function popScopeId(){currentScopeId=null}function withCtx(e,t=currentRenderingInstance,r){if(!t)return e;if(e._n)return e;const n=(...r)=>{n._d&&setBlockTracking(-1);const i=setCurrentRenderingInstance(t),o=e(...r);return setCurrentRenderingInstance(i),n._d&&setBlockTracking(1),o};return n._n=!0,n._c=!0,n._d=!0,n}let accessedAttrs=!1;function markAttrsAccessed(){accessedAttrs=!0}function renderComponentRoot(e){const{type:t,vnode:r,proxy:n,withProxy:i,props:o,propsOptions:[a],slots:s,attrs:c,emit:u,render:l,renderCache:p,data:f,setupState:d,ctx:h,inheritAttrs:m}=e;let g;const y=setCurrentRenderingInstance(e);try{let e;if(4&r.shapeFlag){const t=i||n;g=normalizeVNode(l.call(t,t,p,o,d,f,h)),e=c}else{const r=t;0,g=normalizeVNode(r.length>1?r(o,{attrs:c,slots:s,emit:u}):r(o,null)),e=t.props?c:getFunctionalFallthrough(c)}let y=g;if(e&&!1!==m){const t=Object.keys(e),{shapeFlag:r}=y;t.length&&7&r&&(a&&t.some(isModelListener)&&(e=filterModelListeners(e,a)),y=cloneVNode(y,e))}0,r.dirs&&(y.dirs=y.dirs?y.dirs.concat(r.dirs):r.dirs),r.transition&&(y.transition=r.transition),g=y}catch(v){blockStack.length=0,handleError(v,e,1),g=createVNode(Comment$1)}return setCurrentRenderingInstance(y),g}const getChildRoot=e=>{const t=e.children,r=e.dynamicChildren,n=filterSingleRoot(t);if(!n)return[e,void 0];const i=t.indexOf(n),o=r?r.indexOf(n):-1;return[normalizeVNode(n),n=>{t[i]=n,r&&(o>-1?r[o]=n:n.patchFlag>0&&(e.dynamicChildren=[...r,n]))}]};function filterSingleRoot(e){let t;for(let r=0;r<e.length;r++){const n=e[r];if(!isVNode(n))return;if(n.type!==Comment$1||"v-if"===n.children){if(t)return;t=n}}return t}const getFunctionalFallthrough=e=>{let t;for(const r in e)("class"===r||"style"===r||isOn(r))&&((t||(t={}))[r]=e[r]);return t},filterModelListeners=(e,t)=>{const r={};for(const n in e)isModelListener(n)&&n.slice(9)in t||(r[n]=e[n]);return r},isElementRoot=e=>7&e.shapeFlag||e.type===Comment$1;function shouldUpdateComponent(e,t,r){const{props:n,children:i,component:o}=e,{props:a,children:s,patchFlag:c}=t,u=o.emitsOptions;if(t.dirs||t.transition)return!0;if(!(r&&c>=0))return!(!i&&!s||s&&s.$stable)||n!==a&&(n?!a||hasPropsChanged(n,a,u):!!a);if(1024&c)return!0;if(16&c)return n?hasPropsChanged(n,a,u):!!a;if(8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const r=e[t];if(a[r]!==n[r]&&!isEmitListener(u,r))return!0}}return!1}function hasPropsChanged(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const o=n[i];if(t[o]!==e[o]&&!isEmitListener(r,o))return!0}return!1}function updateHOCHostEl({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const isSuspense=e=>e.__isSuspense;function queueEffectWithSuspense(e,t){t&&t.pendingBranch?isArray(e)?t.effects.push(...e):t.effects.push(e):queuePostFlushCb(e)}function provide(e,t){if(currentInstance){let r=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===r&&(r=currentInstance.provides=Object.create(n)),r[e]=t}else;}function inject(e,t,r=!1){const n=currentInstance||currentRenderingInstance;if(n){const i=null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return r&&isFunction(t)?t.call(n.proxy):t}}const isAsyncWrapper=e=>!!e.type.__asyncLoader,isKeepAlive=e=>e.type.__isKeepAlive;function onActivated(e,t){registerKeepAliveHook(e,"a",t)}function onDeactivated(e,t){registerKeepAliveHook(e,"da",t)}function registerKeepAliveHook(e,t,r=currentInstance){const n=e.__wdc||(e.__wdc=()=>{let t=r;for(;t;){if(t.isDeactivated)return;t=t.parent}e()});if(injectHook(t,n,r),r){let e=r.parent;for(;e&&e.parent;)isKeepAlive(e.parent.vnode)&&injectToKeepAliveRoot(n,t,r,e),e=e.parent}}function injectToKeepAliveRoot(e,t,r,n){const i=injectHook(t,e,n,!0);onUnmounted((()=>{remove(n[t],i)}),r)}function injectHook(e,t,r=currentInstance,n=!1){if(r){const i=r[e]||(r[e]=[]),o=t.__weh||(t.__weh=(...n)=>{if(r.isUnmounted)return;pauseTracking(),setCurrentInstance(r);const i=callWithAsyncErrorHandling(t,r,e,n);return unsetCurrentInstance(),resetTracking(),i});return n?i.unshift(o):i.push(o),o}}const createHook=e=>(t,r=currentInstance)=>(!isInSSRComponentSetup||"sp"===e)&&injectHook(e,t,r),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(e,t=currentInstance){injectHook("ec",e,t)}let shouldCacheAccess=!0;function applyOptions(e){const t=resolveMergedOptions(e),r=e.proxy,n=e.ctx;shouldCacheAccess=!1,t.beforeCreate&&callHook(t.beforeCreate,e,"bc");const{data:i,computed:o,methods:a,watch:s,provide:c,inject:u,created:l,beforeMount:p,mounted:f,beforeUpdate:d,updated:h,activated:m,deactivated:g,beforeDestroy:y,beforeUnmount:v,destroyed:_,unmounted:b,render:w,renderTracked:T,renderTriggered:k,errorCaptured:E,serverPrefetch:S,expose:I,inheritAttrs:P,components:A,directives:C,filters:F}=t;if(u&&resolveInjections(u,n,null,e.appContext.config.unwrapInjectedRef),a)for(const O in a){const e=a[O];isFunction(e)&&(n[O]=e.bind(r))}if(i){const t=i.call(r,r);isObject(t)&&(e.data=reactive(t))}if(shouldCacheAccess=!0,o)for(const O in o){const e=o[O],t=computed({get:isFunction(e)?e.bind(r,r):isFunction(e.get)?e.get.bind(r,r):NOOP,set:!isFunction(e)&&isFunction(e.set)?e.set.bind(r):NOOP});Object.defineProperty(n,O,{enumerable:!0,configurable:!0,get:()=>t.value,set:e=>t.value=e})}if(s)for(const O in s)createWatcher(s[O],n,r,O);if(c){const e=isFunction(c)?c.call(r):c;Reflect.ownKeys(e).forEach((t=>{provide(t,e[t])}))}function D(e,t){isArray(t)?t.forEach((t=>e(t.bind(r)))):t&&e(t.bind(r))}if(l&&callHook(l,e,"c"),D(onBeforeMount,p),D(onMounted,f),D(onBeforeUpdate,d),D(onUpdated,h),D(onActivated,m),D(onDeactivated,g),D(onErrorCaptured,E),D(onRenderTracked,T),D(onRenderTriggered,k),D(onBeforeUnmount,v),D(onUnmounted,b),D(onServerPrefetch,S),isArray(I))if(I.length){const t=e.exposed||(e.exposed={});I.forEach((e=>{Object.defineProperty(t,e,{get:()=>r[e],set:t=>r[e]=t})}))}else e.exposed||(e.exposed={});w&&e.render===NOOP&&(e.render=w),null!=P&&(e.inheritAttrs=P),A&&(e.components=A),C&&(e.directives=C)}function resolveInjections(e,t,r=NOOP,n=!1){isArray(e)&&(e=normalizeInject(e));for(const i in e){const r=e[i];let o;o=isObject(r)?"default"in r?inject(r.from||i,r.default,!0):inject(r.from||i):inject(r),isRef(o)&&n?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:e=>o.value=e}):t[i]=o}}function callHook(e,t,r){callWithAsyncErrorHandling(isArray(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,r)}function createWatcher(e,t,r,n){const i=n.includes(".")?createPathGetter(r,n):()=>r[n];if(isString(e)){const r=t[e];isFunction(r)&&watch(i,r)}else if(isFunction(e))watch(i,e.bind(r));else if(isObject(e))if(isArray(e))e.forEach((e=>createWatcher(e,t,r,n)));else{const n=isFunction(e.handler)?e.handler.bind(r):t[e.handler];isFunction(n)&&watch(i,n,e)}}function resolveMergedOptions(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:a}}=e.appContext,s=o.get(t);let c;return s?c=s:i.length||r||n?(c={},i.length&&i.forEach((e=>mergeOptions(c,e,a,!0))),mergeOptions(c,t,a)):c=t,o.set(t,c),c}function mergeOptions(e,t,r,n=!1){const{mixins:i,extends:o}=t;o&&mergeOptions(e,o,r,!0),i&&i.forEach((t=>mergeOptions(e,t,r,!0)));for(const a in t)if(n&&"expose"===a);else{const n=internalOptionMergeStrats[a]||r&&r[a];e[a]=n?n(e[a],t[a]):t[a]}return e}const internalOptionMergeStrats={data:mergeDataFn,props:mergeObjectOptions,emits:mergeObjectOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,destroyed:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(e,t){return t?e?function(){return extend(isFunction(e)?e.call(this,this):e,isFunction(t)?t.call(this,this):t)}:t:e}function mergeInject(e,t){return mergeObjectOptions(normalizeInject(e),normalizeInject(t))}function normalizeInject(e){if(isArray(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function mergeAsArray(e,t){return e?[...new Set([].concat(e,t))]:t}function mergeObjectOptions(e,t){return e?extend(extend(Object.create(null),e),t):t}function mergeWatchOptions(e,t){if(!e)return t;if(!t)return e;const r=extend(Object.create(null),e);for(const n in t)r[n]=mergeAsArray(e[n],t[n]);return r}function initProps(e,t,r,n=!1){const i={},o={};def(o,InternalObjectKey,1),e.propsDefaults=Object.create(null),setFullProps(e,t,i,o);for(const a in e.propsOptions[0])a in i||(i[a]=void 0);r?e.props=n?i:shallowReactive(i):e.type.props?e.props=i:e.props=o,e.attrs=o}function updateProps(e,t,r,n){const{props:i,attrs:o,vnode:{patchFlag:a}}=e,s=toRaw(i),[c]=e.propsOptions;let u=!1;if(!(n||a>0)||16&a){let n;setFullProps(e,t,i,o)&&(u=!0);for(const o in s)t&&(hasOwn(t,o)||(n=hyphenate(o))!==o&&hasOwn(t,n))||(c?!r||void 0===r[o]&&void 0===r[n]||(i[o]=resolvePropValue(c,s,o,void 0,e,!0)):delete i[o]);if(o!==s)for(const e in o)t&&hasOwn(t,e)||(delete o[e],u=!0)}else if(8&a){const r=e.vnode.dynamicProps;for(let n=0;n<r.length;n++){let a=r[n];const l=t[a];if(c)if(hasOwn(o,a))l!==o[a]&&(o[a]=l,u=!0);else{const t=camelize(a);i[t]=resolvePropValue(c,s,t,l,e,!1)}else l!==o[a]&&(o[a]=l,u=!0)}}u&&trigger$1(e,"set","$attrs")}function setFullProps(e,t,r,n){const[i,o]=e.propsOptions;let a,s=!1;if(t)for(let c in t){if(isReservedProp(c))continue;const u=t[c];let l;i&&hasOwn(i,l=camelize(c))?o&&o.includes(l)?(a||(a={}))[l]=u:r[l]=u:isEmitListener(e.emitsOptions,c)||u!==n[c]&&(n[c]=u,s=!0)}if(o){const t=toRaw(r),n=a||EMPTY_OBJ;for(let a=0;a<o.length;a++){const s=o[a];r[s]=resolvePropValue(i,t,s,n[s],e,!hasOwn(n,s))}}return s}function resolvePropValue(e,t,r,n,i,o){const a=e[r];if(null!=a){const e=hasOwn(a,"default");if(e&&void 0===n){const e=a.default;if(a.type!==Function&&isFunction(e)){const{propsDefaults:o}=i;r in o?n=o[r]:(setCurrentInstance(i),n=o[r]=e.call(null,t),unsetCurrentInstance())}else n=e}a[0]&&(o&&!e?n=!1:!a[1]||""!==n&&n!==hyphenate(r)||(n=!0))}return n}function normalizePropsOptions(e,t,r=!1){const n=t.propsCache,i=n.get(e);if(i)return i;const o=e.props,a={},s=[];let c=!1;if(!isFunction(e)){const n=e=>{c=!0;const[r,n]=normalizePropsOptions(e,t,!0);extend(a,r),n&&s.push(...n)};!r&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}if(!o&&!c)return n.set(e,EMPTY_ARR),EMPTY_ARR;if(isArray(o))for(let l=0;l<o.length;l++){const e=camelize(o[l]);validatePropName(e)&&(a[e]=EMPTY_OBJ)}else if(o)for(const l in o){const e=camelize(l);if(validatePropName(e)){const t=o[l],r=a[e]=isArray(t)||isFunction(t)?{type:t}:t;if(r){const t=getTypeIndex(Boolean,r.type),n=getTypeIndex(String,r.type);r[0]=t>-1,r[1]=n<0||t<n,(t>-1||hasOwn(r,"default"))&&s.push(e)}}}const u=[a,s];return n.set(e,u),u}function validatePropName(e){return"$"!==e[0]}function getType(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function isSameType(e,t){return getType(e)===getType(t)}function getTypeIndex(e,t){return isArray(t)?t.findIndex((t=>isSameType(t,e))):isFunction(t)&&isSameType(t,e)?0:-1}const isInternalKey=e=>"_"===e[0]||"$stable"===e,normalizeSlotValue=e=>isArray(e)?e.map(normalizeVNode):[normalizeVNode(e)],normalizeSlot=(e,t,r)=>{const n=withCtx(((...e)=>normalizeSlotValue(t(...e))),r);return n._c=!1,n},normalizeObjectSlots=(e,t,r)=>{const n=e._ctx;for(const i in e){if(isInternalKey(i))continue;const r=e[i];if(isFunction(r))t[i]=normalizeSlot(i,r,n);else if(null!=r){const e=normalizeSlotValue(r);t[i]=()=>e}}},normalizeVNodeSlots=(e,t)=>{const r=normalizeSlotValue(t);e.slots.default=()=>r},initSlots=(e,t)=>{if(32&e.vnode.shapeFlag){const r=t._;r?(e.slots=toRaw(t),def(t,"_",r)):normalizeObjectSlots(t,e.slots={})}else e.slots={},t&&normalizeVNodeSlots(e,t);def(e.slots,InternalObjectKey,1)},updateSlots=(e,t,r)=>{const{vnode:n,slots:i}=e;let o=!0,a=EMPTY_OBJ;if(32&n.shapeFlag){const e=t._;e?r&&1===e?o=!1:(extend(i,t),r||1!==e||delete i._):(o=!t.$stable,normalizeObjectSlots(t,i)),a=t}else t&&(normalizeVNodeSlots(e,t),a={default:1});if(o)for(const s in i)isInternalKey(s)||s in a||delete i[s]};function withDirectives(e,t){if(null===currentRenderingInstance)return e;const r=currentRenderingInstance.proxy,n=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[e,o,a,s=EMPTY_OBJ]=t[i];isFunction(e)&&(e={mounted:e,updated:e}),e.deep&&traverse(o),n.push({dir:e,instance:r,value:o,oldValue:void 0,arg:a,modifiers:s})}return e}function invokeDirectiveHook(e,t,r,n){const i=e.dirs,o=t&&t.dirs;for(let a=0;a<i.length;a++){const s=i[a];o&&(s.oldValue=o[a].value);let c=s.dir[n];c&&(pauseTracking(),callWithAsyncErrorHandling(c,r,8,[e.el,s,e,t]),resetTracking())}}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid=0;function createAppAPI(e,t){return function(r,n=null){null==n||isObject(n)||(n=null);const i=createAppContext(),o=new Set;let a=!1;const s=i.app={_uid:uid++,_component:r,_props:n,_container:null,_context:i,_instance:null,version:version,get config(){return i.config},set config(e){},use:(e,...t)=>(o.has(e)||(e&&isFunction(e.install)?(o.add(e),e.install(s,...t)):isFunction(e)&&(o.add(e),e(s,...t))),s),mixin:e=>(i.mixins.includes(e)||i.mixins.push(e),s),component:(e,t)=>t?(i.components[e]=t,s):i.components[e],directive:(e,t)=>t?(i.directives[e]=t,s):i.directives[e],mount(o,c,u){if(!a){const l=createVNode(r,n);return l.appContext=i,c&&t?t(l,o):e(l,o,u),a=!0,s._container=o,o.__vue_app__=s,l.component.proxy}},unmount(){a&&(e(null,s._container),delete s._container.__vue_app__)},provide:(e,t)=>(i.provides[e]=t,s)};return s}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(e){return baseCreateRenderer(e)}function baseCreateRenderer(e,t){const{insert:r,remove:n,patchProp:i,createElement:o,createText:a,createComment:s,setText:c,setElementText:u,parentNode:l,nextSibling:p,setScopeId:f=NOOP,cloneNode:d,insertStaticContent:h}=e,m=(e,t,r,n=null,i=null,o=null,a=!1,s=null,c=!!t.dynamicChildren)=>{if(e===t)return;e&&!isSameVNodeType(e,t)&&(n=z(e),N(e,i,o,!0),e=null),-2===t.patchFlag&&(c=!1,t.dynamicChildren=null);const{type:u,ref:l,shapeFlag:p}=t;switch(u){case Text:g(e,t,r,n);break;case Comment$1:y(e,t,r,n);break;case Static:null==e&&v(t,r,n,a);break;case Fragment:I(e,t,r,n,i,o,a,s,c);break;default:1&p?_(e,t,r,n,i,o,a,s,c):6&p?P(e,t,r,n,i,o,a,s,c):(64&p||128&p)&&u.process(e,t,r,n,i,o,a,s,c,H)}null!=l&&i&&setRef(l,e&&e.ref,o,t||e,!t)},g=(e,t,n,i)=>{if(null==e)r(t.el=a(t.children),n,i);else{const r=t.el=e.el;t.children!==e.children&&c(r,t.children)}},y=(e,t,n,i)=>{null==e?r(t.el=s(t.children||""),n,i):t.el=e.el},v=(e,t,r,n)=>{[e.el,e.anchor]=h(e.children,t,r,n)},_=(e,t,r,n,i,o,a,s,c)=>{a=a||"svg"===t.type,null==e?b(t,r,n,i,o,a,s,c):k(e,t,i,o,a,s,c)},b=(e,t,n,a,s,c,l,p)=>{let f,h;const{type:m,props:g,shapeFlag:y,transition:v,patchFlag:_,dirs:b}=e;if(e.el&&void 0!==d&&-1===_)f=e.el=d(e.el);else{if(f=e.el=o(e.type,c,g&&g.is,g),8&y?u(f,e.children):16&y&&T(e.children,f,null,a,s,c&&"foreignObject"!==m,l,p),b&&invokeDirectiveHook(e,null,a,"created"),g){for(const t in g)"value"===t||isReservedProp(t)||i(f,t,null,g[t],c,e.children,a,s,U);"value"in g&&i(f,"value",null,g.value),(h=g.onVnodeBeforeMount)&&invokeVNodeHook(h,a,e)}w(f,e,e.scopeId,l,a)}b&&invokeDirectiveHook(e,null,a,"beforeMount");const k=(!s||s&&!s.pendingBranch)&&v&&!v.persisted;k&&v.beforeEnter(f),r(f,t,n),((h=g&&g.onVnodeMounted)||k||b)&&queuePostRenderEffect((()=>{h&&invokeVNodeHook(h,a,e),k&&v.enter(f),b&&invokeDirectiveHook(e,null,a,"mounted")}),s)},w=(e,t,r,n,i)=>{if(r&&f(e,r),n)for(let o=0;o<n.length;o++)f(e,n[o]);if(i){if(t===i.subTree){const t=i.vnode;w(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},T=(e,t,r,n,i,o,a,s,c=0)=>{for(let u=c;u<e.length;u++){const c=e[u]=s?cloneIfMounted(e[u]):normalizeVNode(e[u]);m(null,c,t,r,n,i,o,a,s)}},k=(e,t,r,n,o,a,s)=>{const c=t.el=e.el;let{patchFlag:l,dynamicChildren:p,dirs:f}=t;l|=16&e.patchFlag;const d=e.props||EMPTY_OBJ,h=t.props||EMPTY_OBJ;let m;(m=h.onVnodeBeforeUpdate)&&invokeVNodeHook(m,r,t,e),f&&invokeDirectiveHook(t,e,r,"beforeUpdate");const g=o&&"foreignObject"!==t.type;if(p?E(e.dynamicChildren,p,c,r,n,g,a):s||O(e,t,c,null,r,n,g,a,!1),l>0){if(16&l)S(c,t,d,h,r,n,o);else if(2&l&&d.class!==h.class&&i(c,"class",null,h.class,o),4&l&&i(c,"style",d.style,h.style,o),8&l){const a=t.dynamicProps;for(let t=0;t<a.length;t++){const s=a[t],u=d[s],l=h[s];l===u&&"value"!==s||i(c,s,u,l,o,e.children,r,n,U)}}1&l&&e.children!==t.children&&u(c,t.children)}else s||null!=p||S(c,t,d,h,r,n,o);((m=h.onVnodeUpdated)||f)&&queuePostRenderEffect((()=>{m&&invokeVNodeHook(m,r,t,e),f&&invokeDirectiveHook(t,e,r,"updated")}),n)},E=(e,t,r,n,i,o,a)=>{for(let s=0;s<t.length;s++){const c=e[s],u=t[s],p=c.el&&(c.type===Fragment||!isSameVNodeType(c,u)||70&c.shapeFlag)?l(c.el):r;m(c,u,p,null,n,i,o,a,!0)}},S=(e,t,r,n,o,a,s)=>{if(r!==n){for(const c in n){if(isReservedProp(c))continue;const u=n[c],l=r[c];u!==l&&"value"!==c&&i(e,c,l,u,s,t.children,o,a,U)}if(r!==EMPTY_OBJ)for(const c in r)isReservedProp(c)||c in n||i(e,c,r[c],null,s,t.children,o,a,U);"value"in n&&i(e,"value",r.value,n.value)}},I=(e,t,n,i,o,s,c,u,l)=>{const p=t.el=e?e.el:a(""),f=t.anchor=e?e.anchor:a("");let{patchFlag:d,dynamicChildren:h,slotScopeIds:m}=t;m&&(u=u?u.concat(m):m),null==e?(r(p,n,i),r(f,n,i),T(t.children,n,f,o,s,c,u,l)):d>0&&64&d&&h&&e.dynamicChildren?(E(e.dynamicChildren,h,n,o,s,c,u),(null!=t.key||o&&t===o.subTree)&&traverseStaticChildren(e,t,!0)):O(e,t,n,f,o,s,c,u,l)},P=(e,t,r,n,i,o,a,s,c)=>{t.slotScopeIds=s,null==e?512&t.shapeFlag?i.ctx.activate(t,r,n,a,c):A(t,r,n,i,o,a,c):C(e,t,c)},A=(e,t,r,n,i,o,a)=>{const s=e.component=createComponentInstance(e,n,i);if(isKeepAlive(e)&&(s.ctx.renderer=H),setupComponent(s),s.asyncDep){if(i&&i.registerDep(s,F),!e.el){const e=s.subTree=createVNode(Comment$1);y(null,e,t,r)}}else F(s,e,t,r,i,o,a)},C=(e,t,r)=>{const n=t.component=e.component;if(shouldUpdateComponent(e,t,r)){if(n.asyncDep&&!n.asyncResolved)return void D(n,t,r);n.next=t,invalidateJob(n.update),n.update()}else t.component=e.component,t.el=e.el,n.vnode=t},F=(e,t,r,n,i,o,a)=>{const s=new ReactiveEffect((()=>{if(e.isMounted){let t,{next:r,bu:n,u:c,parent:u,vnode:p}=e,f=r;s.allowRecurse=!1,r?(r.el=p.el,D(e,r,a)):r=p,n&&invokeArrayFns(n),(t=r.props&&r.props.onVnodeBeforeUpdate)&&invokeVNodeHook(t,u,r,p),s.allowRecurse=!0;const d=renderComponentRoot(e),h=e.subTree;e.subTree=d,m(h,d,l(h.el),z(h),e,i,o),r.el=d.el,null===f&&updateHOCHostEl(e,d.el),c&&queuePostRenderEffect(c,i),(t=r.props&&r.props.onVnodeUpdated)&&queuePostRenderEffect((()=>invokeVNodeHook(t,u,r,p)),i)}else{let a;const{el:c,props:u}=t,{bm:l,m:p,parent:f}=e,d=isAsyncWrapper(t);if(s.allowRecurse=!1,l&&invokeArrayFns(l),!d&&(a=u&&u.onVnodeBeforeMount)&&invokeVNodeHook(a,f,t),s.allowRecurse=!0,c&&V){const r=()=>{e.subTree=renderComponentRoot(e),V(c,e.subTree,e,i,null)};d?t.type.__asyncLoader().then((()=>!e.isUnmounted&&r())):r()}else{const a=e.subTree=renderComponentRoot(e);m(null,a,r,n,e,i,o),t.el=a.el}if(p&&queuePostRenderEffect(p,i),!d&&(a=u&&u.onVnodeMounted)){const e=t;queuePostRenderEffect((()=>invokeVNodeHook(a,f,e)),i)}256&t.shapeFlag&&e.a&&queuePostRenderEffect(e.a,i),e.isMounted=!0,t=r=n=null}}),(()=>queueJob(e.update)),e.scope),c=e.update=s.run.bind(s);c.id=e.uid,s.allowRecurse=c.allowRecurse=!0,c()},D=(e,t,r)=>{t.component=e;const n=e.vnode.props;e.vnode=t,e.next=null,updateProps(e,t.props,n,r),updateSlots(e,t.children,r),pauseTracking(),flushPreFlushCbs(void 0,e.update),resetTracking()},O=(e,t,r,n,i,o,a,s,c=!1)=>{const l=e&&e.children,p=e?e.shapeFlag:0,f=t.children,{patchFlag:d,shapeFlag:h}=t;if(d>0){if(128&d)return void R(l,f,r,n,i,o,a,s,c);if(256&d)return void x(l,f,r,n,i,o,a,s,c)}8&h?(16&p&&U(l,i,o),f!==l&&u(r,f)):16&p?16&h?R(l,f,r,n,i,o,a,s,c):U(l,i,o,!0):(8&p&&u(r,""),16&h&&T(f,r,n,i,o,a,s,c))},x=(e,t,r,n,i,o,a,s,c)=>{t=t||EMPTY_ARR;const u=(e=e||EMPTY_ARR).length,l=t.length,p=Math.min(u,l);let f;for(f=0;f<p;f++){const n=t[f]=c?cloneIfMounted(t[f]):normalizeVNode(t[f]);m(e[f],n,r,null,i,o,a,s,c)}u>l?U(e,i,o,!0,!1,p):T(t,r,n,i,o,a,s,c,p)},R=(e,t,r,n,i,o,a,s,c)=>{let u=0;const l=t.length;let p=e.length-1,f=l-1;for(;u<=p&&u<=f;){const n=e[u],l=t[u]=c?cloneIfMounted(t[u]):normalizeVNode(t[u]);if(!isSameVNodeType(n,l))break;m(n,l,r,null,i,o,a,s,c),u++}for(;u<=p&&u<=f;){const n=e[p],u=t[f]=c?cloneIfMounted(t[f]):normalizeVNode(t[f]);if(!isSameVNodeType(n,u))break;m(n,u,r,null,i,o,a,s,c),p--,f--}if(u>p){if(u<=f){const e=f+1,p=e<l?t[e].el:n;for(;u<=f;)m(null,t[u]=c?cloneIfMounted(t[u]):normalizeVNode(t[u]),r,p,i,o,a,s,c),u++}}else if(u>f)for(;u<=p;)N(e[u],i,o,!0),u++;else{const d=u,h=u,g=new Map;for(u=h;u<=f;u++){const e=t[u]=c?cloneIfMounted(t[u]):normalizeVNode(t[u]);null!=e.key&&g.set(e.key,u)}let y,v=0;const _=f-h+1;let b=!1,w=0;const T=new Array(_);for(u=0;u<_;u++)T[u]=0;for(u=d;u<=p;u++){const n=e[u];if(v>=_){N(n,i,o,!0);continue}let l;if(null!=n.key)l=g.get(n.key);else for(y=h;y<=f;y++)if(0===T[y-h]&&isSameVNodeType(n,t[y])){l=y;break}void 0===l?N(n,i,o,!0):(T[l-h]=u+1,l>=w?w=l:b=!0,m(n,t[l],r,null,i,o,a,s,c),v++)}const k=b?getSequence(T):EMPTY_ARR;for(y=k.length-1,u=_-1;u>=0;u--){const e=h+u,p=t[e],f=e+1<l?t[e+1].el:n;0===T[u]?m(null,p,r,f,i,o,a,s,c):b&&(y<0||u!==k[y]?M(p,r,f,2):y--)}}},M=(e,t,n,i,o=null)=>{const{el:a,type:s,transition:c,children:u,shapeFlag:l}=e;if(6&l)return void M(e.component.subTree,t,n,i);if(128&l)return void e.suspense.move(t,n,i);if(64&l)return void s.move(e,t,n,H);if(s===Fragment){r(a,t,n);for(let e=0;e<u.length;e++)M(u[e],t,n,i);return void r(e.anchor,t,n)}if(s===Static)return void(({el:e,anchor:t},n,i)=>{let o;for(;e&&e!==t;)o=p(e),r(e,n,i),e=o;r(t,n,i)})(e,t,n);if(2!==i&&1&l&&c)if(0===i)c.beforeEnter(a),r(a,t,n),queuePostRenderEffect((()=>c.enter(a)),o);else{const{leave:e,delayLeave:i,afterLeave:o}=c,s=()=>r(a,t,n),u=()=>{e(a,(()=>{s(),o&&o()}))};i?i(a,s,u):u()}else r(a,t,n)},N=(e,t,r,n=!1,i=!1)=>{const{type:o,props:a,ref:s,children:c,dynamicChildren:u,shapeFlag:l,patchFlag:p,dirs:f}=e;if(null!=s&&setRef(s,null,r,e,!0),256&l)return void t.ctx.deactivate(e);const d=1&l&&f,h=!isAsyncWrapper(e);let m;if(h&&(m=a&&a.onVnodeBeforeUnmount)&&invokeVNodeHook(m,t,e),6&l)L(e.component,r,n);else{if(128&l)return void e.suspense.unmount(r,n);d&&invokeDirectiveHook(e,null,t,"beforeUnmount"),64&l?e.type.remove(e,t,r,i,H,n):u&&(o!==Fragment||p>0&&64&p)?U(u,t,r,!1,!0):(o===Fragment&&384&p||!i&&16&l)&&U(c,t,r),n&&$(e)}(h&&(m=a&&a.onVnodeUnmounted)||d)&&queuePostRenderEffect((()=>{m&&invokeVNodeHook(m,t,e),d&&invokeDirectiveHook(e,null,t,"unmounted")}),r)},$=e=>{const{type:t,el:r,anchor:i,transition:o}=e;if(t===Fragment)return void B(r,i);if(t===Static)return void(({el:e,anchor:t})=>{let r;for(;e&&e!==t;)r=p(e),n(e),e=r;n(t)})(e);const a=()=>{n(r),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&e.shapeFlag&&o&&!o.persisted){const{leave:t,delayLeave:n}=o,i=()=>t(r,a);n?n(e.el,a,i):i()}else a()},B=(e,t)=>{let r;for(;e!==t;)r=p(e),n(e),e=r;n(t)},L=(e,t,r)=>{const{bum:n,scope:i,update:o,subTree:a,um:s}=e;n&&invokeArrayFns(n),i.stop(),o&&(o.active=!1,N(a,e,t,r)),s&&queuePostRenderEffect(s,t),queuePostRenderEffect((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},U=(e,t,r,n=!1,i=!1,o=0)=>{for(let a=o;a<e.length;a++)N(e[a],t,r,n,i)},z=e=>6&e.shapeFlag?z(e.component.subTree):128&e.shapeFlag?e.suspense.next():p(e.anchor||e.el),j=(e,t,r)=>{null==e?t._vnode&&N(t._vnode,null,null,!0):m(t._vnode||null,e,t,null,null,null,r),flushPostFlushCbs(),t._vnode=e},H={p:m,um:N,m:M,r:$,mt:A,mc:T,pc:O,pbc:E,n:z,o:e};let G,V;return t&&([G,V]=t(H)),{render:j,hydrate:G,createApp:createAppAPI(j,G)}}function setRef(e,t,r,n,i=!1){if(isArray(e))return void e.forEach(((e,o)=>setRef(e,t&&(isArray(t)?t[o]:t),r,n,i)));if(isAsyncWrapper(n)&&!i)return;const o=4&n.shapeFlag?getExposeProxy(n.component)||n.component.proxy:n.el,a=i?null:o,{i:s,r:c}=e,u=t&&t.r,l=s.refs===EMPTY_OBJ?s.refs={}:s.refs,p=s.setupState;if(null!=u&&u!==c&&(isString(u)?(l[u]=null,hasOwn(p,u)&&(p[u]=null)):isRef(u)&&(u.value=null)),isString(c)){const e=()=>{l[c]=a,hasOwn(p,c)&&(p[c]=a)};a?(e.id=-1,queuePostRenderEffect(e,r)):e()}else if(isRef(c)){const e=()=>{c.value=a};a?(e.id=-1,queuePostRenderEffect(e,r)):e()}else isFunction(c)&&callWithErrorHandling(c,s,12,[a,l])}function invokeVNodeHook(e,t,r,n=null){callWithAsyncErrorHandling(e,t,7,[r,n])}function traverseStaticChildren(e,t,r=!1){const n=e.children,i=t.children;if(isArray(n)&&isArray(i))for(let o=0;o<n.length;o++){const e=n[o];let t=i[o];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=i[o]=cloneIfMounted(i[o]),t.el=e.el),r||traverseStaticChildren(e,t))}}function getSequence(e){const t=e.slice(),r=[0];let n,i,o,a,s;const c=e.length;for(n=0;n<c;n++){const c=e[n];if(0!==c){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}for(o=0,a=r.length-1;o<a;)s=o+a>>1,e[r[s]]<c?o=s+1:a=s;c<e[r[o]]&&(o>0&&(t[n]=r[o-1]),r[o]=n)}}for(o=r.length,a=r[o-1];o-- >0;)r[o]=a,a=t[a];return r}const isTeleport=e=>e.__isTeleport,isTeleportDisabled=e=>e&&(e.disabled||""===e.disabled),isTargetSVG=e=>"undefined"!=typeof SVGElement&&e instanceof SVGElement,resolveTarget=(e,t)=>{const r=e&&e.to;if(isString(r)){if(t){return t(r)}return null}return r},TeleportImpl={__isTeleport:!0,process(e,t,r,n,i,o,a,s,c,u){const{mc:l,pc:p,pbc:f,o:{insert:d,querySelector:h,createText:m,createComment:g}}=u,y=isTeleportDisabled(t.props);let{shapeFlag:v,children:_,dynamicChildren:b}=t;if(null==e){const e=t.el=m(""),u=t.anchor=m("");d(e,r,n),d(u,r,n);const p=t.target=resolveTarget(t.props,h),f=t.targetAnchor=m("");p&&(d(f,p),a=a||isTargetSVG(p));const g=(e,t)=>{16&v&&l(_,e,t,i,o,a,s,c)};y?g(r,u):p&&g(p,f)}else{t.el=e.el;const n=t.anchor=e.anchor,l=t.target=e.target,d=t.targetAnchor=e.targetAnchor,m=isTeleportDisabled(e.props),g=m?r:l,v=m?n:d;if(a=a||isTargetSVG(l),b?(f(e.dynamicChildren,b,g,i,o,a,s),traverseStaticChildren(e,t,!0)):c||p(e,t,g,v,i,o,a,s,!1),y)m||moveTeleport(t,r,n,u,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const e=t.target=resolveTarget(t.props,h);e&&moveTeleport(t,e,null,u,0)}else m&&moveTeleport(t,l,d,u,1)}},remove(e,t,r,n,{um:i,o:{remove:o}},a){const{shapeFlag:s,children:c,anchor:u,targetAnchor:l,target:p,props:f}=e;if(p&&o(l),(a||!isTeleportDisabled(f))&&(o(u),16&s))for(let d=0;d<c.length;d++){const e=c[d];i(e,t,r,!0,!!e.dynamicChildren)}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(e,t,r,{o:{insert:n},m:i},o=2){0===o&&n(e.targetAnchor,t,r);const{el:a,anchor:s,shapeFlag:c,children:u,props:l}=e,p=2===o;if(p&&n(a,t,r),(!p||isTeleportDisabled(l))&&16&c)for(let f=0;f<u.length;f++)i(u[f],t,r,2);p&&n(s,t,r)}function hydrateTeleport(e,t,r,n,i,o,{o:{nextSibling:a,parentNode:s,querySelector:c}},u){const l=t.target=resolveTarget(t.props,c);if(l){const c=l._lpa||l.firstChild;16&t.shapeFlag&&(isTeleportDisabled(t.props)?(t.anchor=u(a(e),t,s(e),r,n,i,o),t.targetAnchor=c):(t.anchor=a(e),t.targetAnchor=u(c,t,l,r,n,i,o)),l._lpa=t.targetAnchor&&a(t.targetAnchor))}return t.anchor&&a(t.anchor)}const Teleport=TeleportImpl,COMPONENTS="components";function resolveComponent(e,t){return resolveAsset(COMPONENTS,e,!0,t)||e}const NULL_DYNAMIC_COMPONENT=Symbol();function resolveAsset(e,t,r=!0,n=!1){const i=currentRenderingInstance||currentInstance;if(i){const r=i.type;if(e===COMPONENTS){const e=getComponentName(r);if(e&&(e===t||e===camelize(t)||e===capitalize(camelize(t))))return r}const o=resolve(i[e]||r[e],t)||resolve(i.appContext[e],t);return!o&&n?r:o}}function resolve(e,t){return e&&(e[t]||e[camelize(t)]||e[capitalize(camelize(t))])}const Fragment=Symbol(void 0),Text=Symbol(void 0),Comment$1=Symbol(void 0),Static=Symbol(void 0),blockStack=[];let currentBlock=null;function openBlock(e=!1){blockStack.push(currentBlock=e?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(e){isBlockTreeEnabled+=e}function setupBlock(e){return e.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(e),e}function createElementBlock(e,t,r,n,i,o){return setupBlock(createBaseVNode(e,t,r,n,i,o,!0))}function createBlock(e,t,r,n,i){return setupBlock(createVNode(e,t,r,n,i,!0))}function isVNode(e){return!!e&&!0===e.__v_isVNode}function isSameVNodeType(e,t){return e.type===t.type&&e.key===t.key}const InternalObjectKey="__vInternal",normalizeKey=({key:e})=>null!=e?e:null,normalizeRef=({ref:e})=>null!=e?isString(e)||isRef(e)||isFunction(e)?{i:currentRenderingInstance,r:e}:e:null;function createBaseVNode(e,t=null,r=null,n=0,i=null,o=(e===Fragment?0:1),a=!1,s=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&normalizeKey(t),ref:t&&normalizeRef(t),scopeId:currentScopeId,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};return s?(normalizeChildren(c,r),128&o&&e.normalize(c)):r&&(c.shapeFlag|=isString(r)?8:16),isBlockTreeEnabled>0&&!a&&currentBlock&&(c.patchFlag>0||6&o)&&32!==c.patchFlag&&currentBlock.push(c),c}const createVNode=_createVNode;function _createVNode(e,t=null,r=null,n=0,i=null,o=!1){if(e&&e!==NULL_DYNAMIC_COMPONENT||(e=Comment$1),isVNode(e)){const n=cloneVNode(e,t,!0);return r&&normalizeChildren(n,r),n}if(isClassComponent(e)&&(e=e.__vccOpts),t){t=guardReactiveProps(t);let{class:e,style:r}=t;e&&!isString(e)&&(t.class=normalizeClass(e)),isObject(r)&&(isProxy(r)&&!isArray(r)&&(r=extend({},r)),t.style=normalizeStyle(r))}return createBaseVNode(e,t,r,n,i,isString(e)?1:isSuspense(e)?128:isTeleport(e)?64:isObject(e)?4:isFunction(e)?2:0,o,!0)}function guardReactiveProps(e){return e?isProxy(e)||InternalObjectKey in e?extend({},e):e:null}function cloneVNode(e,t,r=!1){const{props:n,ref:i,patchFlag:o,children:a}=e,s=t?mergeProps(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&normalizeKey(s),ref:t&&t.ref?r&&i?isArray(i)?i.concat(normalizeRef(t)):[i,normalizeRef(t)]:normalizeRef(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Fragment?-1===o?16:16|o:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&cloneVNode(e.ssContent),ssFallback:e.ssFallback&&cloneVNode(e.ssFallback),el:e.el,anchor:e.anchor}}function createTextVNode(e=" ",t=0){return createVNode(Text,null,e,t)}function createStaticVNode(e,t){const r=createVNode(Static,null,e);return r.staticCount=t,r}function createCommentVNode(e="",t=!1){return t?(openBlock(),createBlock(Comment$1,null,e)):createVNode(Comment$1,null,e)}function normalizeVNode(e){return null==e||"boolean"==typeof e?createVNode(Comment$1):isArray(e)?createVNode(Fragment,null,e.slice()):"object"==typeof e?cloneIfMounted(e):createVNode(Text,null,String(e))}function cloneIfMounted(e){return null===e.el||e.memo?e:cloneVNode(e)}function normalizeChildren(e,t){let r=0;const{shapeFlag:n}=e;if(null==t)t=null;else if(isArray(t))r=16;else if("object"==typeof t){if(65&n){const r=t.default;return void(r&&(r._c&&(r._d=!1),normalizeChildren(e,r()),r._c&&(r._d=!0)))}{r=32;const n=t._;n||InternalObjectKey in t?3===n&&currentRenderingInstance&&(1===currentRenderingInstance.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=currentRenderingInstance}}else isFunction(t)?(t={default:t,_ctx:currentRenderingInstance},r=32):(t=String(t),64&n?(r=16,t=[createTextVNode(t)]):r=8);e.children=t,e.shapeFlag|=r}function mergeProps(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const e in n)if("class"===e)t.class!==n.class&&(t.class=normalizeClass([t.class,n.class]));else if("style"===e)t.style=normalizeStyle([t.style,n.style]);else if(isOn(e)){const r=t[e],i=n[e];r!==i&&(t[e]=r?[].concat(r,i):i)}else""!==e&&(t[e]=n[e])}return t}function renderList(e,t,r,n){let i;const o=r&&r[n];if(isArray(e)||isString(e)){i=new Array(e.length);for(let r=0,n=e.length;r<n;r++)i[r]=t(e[r],r,void 0,o&&o[r])}else if("number"==typeof e){i=new Array(e);for(let r=0;r<e;r++)i[r]=t(r+1,r,void 0,o&&o[r])}else if(isObject(e))if(e[Symbol.iterator])i=Array.from(e,((e,r)=>t(e,r,void 0,o&&o[r])));else{const r=Object.keys(e);i=new Array(r.length);for(let n=0,a=r.length;n<a;n++){const a=r[n];i[n]=t(e[a],a,n,o&&o[n])}}else i=[];return r&&(r[n]=i),i}function renderSlot(e,t,r={},n,i){if(currentRenderingInstance.isCE)return createVNode("slot","default"===t?null:{name:t},n&&n());let o=e[t];o&&o._c&&(o._d=!1),openBlock();const a=o&&ensureValidVNode(o(r)),s=createBlock(Fragment,{key:r.key||`_${t}`},a||(n?n():[]),a&&1===e._?64:-2);return!i&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),o&&o._c&&(o._d=!0),s}function ensureValidVNode(e){return e.some((e=>!isVNode(e)||e.type!==Comment$1&&!(e.type===Fragment&&!ensureValidVNode(e.children))))?e:null}const getPublicInstance=e=>e?isStatefulComponent(e)?getExposeProxy(e)||e.proxy:getPublicInstance(e.parent):null,publicPropertiesMap=extend(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>getPublicInstance(e.parent),$root:e=>getPublicInstance(e.root),$emit:e=>e.emit,$options:e=>resolveMergedOptions(e),$forceUpdate:e=>()=>queueJob(e.update),$nextTick:e=>nextTick.bind(e.proxy),$watch:e=>instanceWatch.bind(e)}),PublicInstanceProxyHandlers={get({_:e},t){const{ctx:r,setupState:n,data:i,props:o,accessCache:a,type:s,appContext:c}=e;let u;if("$"!==t[0]){const s=a[t];if(void 0!==s)switch(s){case 0:return n[t];case 1:return i[t];case 3:return r[t];case 2:return o[t]}else{if(n!==EMPTY_OBJ&&hasOwn(n,t))return a[t]=0,n[t];if(i!==EMPTY_OBJ&&hasOwn(i,t))return a[t]=1,i[t];if((u=e.propsOptions[0])&&hasOwn(u,t))return a[t]=2,o[t];if(r!==EMPTY_OBJ&&hasOwn(r,t))return a[t]=3,r[t];shouldCacheAccess&&(a[t]=4)}}const l=publicPropertiesMap[t];let p,f;return l?("$attrs"===t&&track(e,"get",t),l(e)):(p=s.__cssModules)&&(p=p[t])?p:r!==EMPTY_OBJ&&hasOwn(r,t)?(a[t]=3,r[t]):(f=c.config.globalProperties,hasOwn(f,t)?f[t]:void 0)},set({_:e},t,r){const{data:n,setupState:i,ctx:o}=e;if(i!==EMPTY_OBJ&&hasOwn(i,t))i[t]=r;else if(n!==EMPTY_OBJ&&hasOwn(n,t))n[t]=r;else if(hasOwn(e.props,t))return!1;return("$"!==t[0]||!(t.slice(1)in e))&&(o[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,propsOptions:o}},a){let s;return void 0!==r[a]||e!==EMPTY_OBJ&&hasOwn(e,a)||t!==EMPTY_OBJ&&hasOwn(t,a)||(s=o[0])&&hasOwn(s,a)||hasOwn(n,a)||hasOwn(publicPropertiesMap,a)||hasOwn(i.config.globalProperties,a)}},emptyAppContext=createAppContext();let uid$1=0;function createComponentInstance(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||emptyAppContext,o={uid:uid$1++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,i),emitsOptions:normalizeEmitsOptions(n,i),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=emit.bind(null,o),e.ce&&e.ce(o),o}let currentInstance=null;const setCurrentInstance=e=>{currentInstance=e,e.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),currentInstance=null};function isStatefulComponent(e){return 4&e.vnode.shapeFlag}let isInSSRComponentSetup=!1;function setupComponent(e,t=!1){isInSSRComponentSetup=t;const{props:r,children:n}=e.vnode,i=isStatefulComponent(e);initProps(e,r,i,t),initSlots(e,n);const o=i?setupStatefulComponent(e,t):void 0;return isInSSRComponentSetup=!1,o}function setupStatefulComponent(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=markRaw(new Proxy(e.ctx,PublicInstanceProxyHandlers));const{setup:n}=r;if(n){const r=e.setupContext=n.length>1?createSetupContext(e):null;setCurrentInstance(e),pauseTracking();const i=callWithErrorHandling(n,e,0,[e.props,r]);if(resetTracking(),unsetCurrentInstance(),isPromise(i)){if(i.then(unsetCurrentInstance,unsetCurrentInstance),t)return i.then((t=>{handleSetupResult(e,t)})).catch((t=>{handleError(t,e,0)}));e.asyncDep=i}else handleSetupResult(e,i)}else finishComponentSetup(e)}function handleSetupResult(e,t,r){isFunction(t)?e.render=t:isObject(t)&&(e.setupState=proxyRefs(t)),finishComponentSetup(e)}function finishComponentSetup(e,t,r){const n=e.type;e.render||(e.render=n.render||NOOP),setCurrentInstance(e),pauseTracking(),applyOptions(e),resetTracking(),unsetCurrentInstance()}function createAttrsProxy(e){return new Proxy(e.attrs,{get:(t,r)=>(track(e,"get","$attrs"),t[r])})}function createSetupContext(e){const t=t=>{e.exposed=t||{}};let r;return{get attrs(){return r||(r=createAttrsProxy(e))},slots:e.slots,emit:e.emit,expose:t}}function getExposeProxy(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(proxyRefs(markRaw(e.exposed)),{get:(t,r)=>r in t?t[r]:r in publicPropertiesMap?publicPropertiesMap[r](e):void 0}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=e=>e.replace(classifyRE,(e=>e.toUpperCase())).replace(/[-_]/g,"");function getComponentName(e){return isFunction(e)&&e.displayName||e.name}function formatComponentName(e,t,r=!1){let n=getComponentName(t);if(!n&&t.__file){const e=t.__file.match(/([^/\\]+)\.\w+$/);e&&(n=e[1])}if(!n&&e&&e.parent){const r=e=>{for(const r in e)if(e[r]===t)return r};n=r(e.components||e.parent.type.components)||r(e.appContext.components)}return n?classify(n):r?"App":"Anonymous"}function isClassComponent(e){return isFunction(e)&&"__vccOpts"in e}const stack=[];function warn(e,...t){pauseTracking();const r=stack.length?stack[stack.length-1].component:null,n=r&&r.appContext.config.warnHandler,i=getComponentTrace();if(n)callWithErrorHandling(n,r,11,[e+t.join(""),r&&r.proxy,i.map((({vnode:e})=>`at <${formatComponentName(r,e.type)}>`)).join("\n"),i]);else{const r=[`[Vue warn]: ${e}`,...t];i.length&&r.push("\n",...formatTrace(i)),console.warn(...r)}resetTracking()}function getComponentTrace(){let e=stack[stack.length-1];if(!e)return[];const t=[];for(;e;){const r=t[0];r&&r.vnode===e?r.recurseCount++:t.push({vnode:e,recurseCount:0});const n=e.component&&e.component.parent;e=n&&n.vnode}return t}function formatTrace(e){const t=[];return e.forEach(((e,r)=>{t.push(...0===r?[]:["\n"],...formatTraceEntry(e))})),t}function formatTraceEntry({vnode:e,recurseCount:t}){const r=t>0?`... (${t} recursive calls)`:"",n=!!e.component&&null==e.component.parent,i=` at <${formatComponentName(e.component,e.type,n)}`,o=">"+r;return e.props?[i,...formatProps(e.props),o]:[i+o]}function formatProps(e){const t=[],r=Object.keys(e);return r.slice(0,3).forEach((r=>{t.push(...formatProp(r,e[r]))})),r.length>3&&t.push(" ..."),t}function formatProp(e,t,r){return isString(t)?(t=JSON.stringify(t),r?t:[`${e}=${t}`]):"number"==typeof t||"boolean"==typeof t||null==t?r?t:[`${e}=${t}`]:isRef(t)?(t=formatProp(e,toRaw(t.value),!0),r?t:[`${e}=Ref<`,t,">"]):isFunction(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=toRaw(t),r?t:[`${e}=`,t])}function callWithErrorHandling(e,t,r,n){let i;try{i=n?e(...n):e()}catch(o){handleError(o,t,r)}return i}function callWithAsyncErrorHandling(e,t,r,n){if(isFunction(e)){const i=callWithErrorHandling(e,t,r,n);return i&&isPromise(i)&&i.catch((e=>{handleError(e,t,r)})),i}const i=[];for(let o=0;o<e.length;o++)i.push(callWithAsyncErrorHandling(e[o],t,r,n));return i}function handleError(e,t,r,n=!0){const i=t?t.vnode:null;if(t){let n=t.parent;const i=t.proxy,o=r;for(;n;){const t=n.ec;if(t)for(let r=0;r<t.length;r++)if(!1===t[r](e,i,o))return;n=n.parent}const a=t.appContext.config.errorHandler;if(a)return void callWithErrorHandling(a,null,10,[e,i,o])}logError(e,r,i,n)}function logError(e,t,r,n=!0){console.error(e)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPreFlushCbs=[];let activePreFlushCbs=null,preFlushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null,currentPreFlushParentJob=null;const RECURSION_LIMIT=100;function nextTick(e){const t=currentFlushPromise||resolvedPromise;return e?t.then(this?e.bind(this):e):t}function findInsertionIndex(e){let t=flushIndex+1,r=queue.length;for(;t<r;){const n=t+r>>>1;getId(queue[n])<e?t=n+1:r=n}return t}function queueJob(e){queue.length&&queue.includes(e,isFlushing&&e.allowRecurse?flushIndex+1:flushIndex)||e===currentPreFlushParentJob||(null==e.id?queue.push(e):queue.splice(findInsertionIndex(e.id),0,e),queueFlush())}function queueFlush(){isFlushing||isFlushPending||(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(e){const t=queue.indexOf(e);t>flushIndex&&queue.splice(t,1)}function queueCb(e,t,r,n){isArray(e)?r.push(...e):t&&t.includes(e,e.allowRecurse?n+1:n)||r.push(e),queueFlush()}function queuePreFlushCb(e){queueCb(e,activePreFlushCbs,pendingPreFlushCbs,preFlushIndex)}function queuePostFlushCb(e){queueCb(e,activePostFlushCbs,pendingPostFlushCbs,postFlushIndex)}function flushPreFlushCbs(e,t=null){if(pendingPreFlushCbs.length){for(currentPreFlushParentJob=t,activePreFlushCbs=[...new Set(pendingPreFlushCbs)],pendingPreFlushCbs.length=0,preFlushIndex=0;preFlushIndex<activePreFlushCbs.length;preFlushIndex++)activePreFlushCbs[preFlushIndex]();activePreFlushCbs=null,preFlushIndex=0,currentPreFlushParentJob=null,flushPreFlushCbs(e,t)}}function flushPostFlushCbs(e){if(pendingPostFlushCbs.length){const e=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs)return void activePostFlushCbs.push(...e);for(activePostFlushCbs=e,activePostFlushCbs.sort(((e,t)=>getId(e)-getId(t))),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=e=>null==e.id?1/0:e.id;function flushJobs(e){isFlushPending=!1,isFlushing=!0,flushPreFlushCbs(e),queue.sort(((e,t)=>getId(e)-getId(t)));try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&!1!==e.active&&callWithErrorHandling(e,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPreFlushCbs.length||pendingPostFlushCbs.length)&&flushJobs(e)}}function checkRecursiveUpdates(e,t){if(e.has(t)){const r=e.get(t);if(r>RECURSION_LIMIT){const e=t.ownerInstance,r=e&&getComponentName(e.type);return warn(`Maximum recursive updates exceeded${r?` in component <${r}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`),!0}e.set(t,r+1)}else e.set(t,1)}const INITIAL_WATCHER_VALUE={};function watch(e,t,r){return doWatch(e,t,r)}function doWatch(e,t,{immediate:r,deep:n,flush:i,onTrack:o,onTrigger:a}=EMPTY_OBJ){const s=currentInstance;let c,u,l=!1,p=!1;if(isRef(e)?(c=()=>e.value,l=!!e._shallow):isReactive(e)?(c=()=>e,n=!0):isArray(e)?(p=!0,l=e.some(isReactive),c=()=>e.map((e=>isRef(e)?e.value:isReactive(e)?traverse(e):isFunction(e)?callWithErrorHandling(e,s,2):void 0))):c=isFunction(e)?t?()=>callWithErrorHandling(e,s,2):()=>{if(!s||!s.isUnmounted)return u&&u(),callWithAsyncErrorHandling(e,s,3,[f])}:NOOP,t&&n){const e=c;c=()=>traverse(e())}let f=e=>{u=g.onStop=()=>{callWithErrorHandling(e,s,4)}},d=p?[]:INITIAL_WATCHER_VALUE;const h=()=>{if(g.active)if(t){const e=g.run();(n||l||(p?e.some(((e,t)=>hasChanged(e,d[t]))):hasChanged(e,d)))&&(u&&u(),callWithAsyncErrorHandling(t,s,3,[e,d===INITIAL_WATCHER_VALUE?void 0:d,f]),d=e)}else g.run()};let m;h.allowRecurse=!!t,m="sync"===i?h:"post"===i?()=>queuePostRenderEffect(h,s&&s.suspense):()=>{!s||s.isMounted?queuePreFlushCb(h):h()};const g=new ReactiveEffect(c,m);return t?r?h():d=g.run():"post"===i?queuePostRenderEffect(g.run.bind(g),s&&s.suspense):g.run(),()=>{g.stop(),s&&s.scope&&remove(s.scope.effects,g)}}function instanceWatch(e,t,r){const n=this.proxy,i=isString(e)?e.includes(".")?createPathGetter(n,e):()=>n[e]:e.bind(n,n);let o;isFunction(t)?o=t:(o=t.handler,r=t);const a=currentInstance;setCurrentInstance(this);const s=doWatch(i,o.bind(n),r);return a?setCurrentInstance(a):unsetCurrentInstance(),s}function createPathGetter(e,t){const r=t.split(".");return()=>{let t=e;for(let e=0;e<r.length&&t;e++)t=t[r[e]];return t}}function traverse(e,t=new Set){if(!isObject(e)||e.__v_skip)return e;if((t=t||new Set).has(e))return e;if(t.add(e),isRef(e))traverse(e.value,t);else if(isArray(e))for(let r=0;r<e.length;r++)traverse(e[r],t);else if(isSet(e)||isMap(e))e.forEach((e=>{traverse(e,t)}));else if(isPlainObject(e))for(const r in e)traverse(e[r],t);return e}function h$1(e,t,r){const n=arguments.length;return 2===n?isObject(t)&&!isArray(t)?isVNode(t)?createVNode(e,null,[t]):createVNode(e,t):createVNode(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):3===n&&isVNode(r)&&(r=[r]),createVNode(e,t,r))}const version="3.2.4",svgNS="http://www.w3.org/2000/svg",doc="undefined"!=typeof document?document:null,staticTemplateCache=new Map,nodeOps={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t?doc.createElementNS(svgNS,e):doc.createElement(e,r?{is:r}:void 0);return"select"===e&&n&&null!=n.multiple&&i.setAttribute("multiple",n.multiple),i},createText:e=>doc.createTextNode(e),createComment:e=>doc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>doc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n){const i=r?r.previousSibling:t.lastChild;let o=staticTemplateCache.get(e);if(!o){const t=doc.createElement("template");if(t.innerHTML=n?`<svg>${e}</svg>`:e,o=t.content,n){const e=o.firstChild;for(;e.firstChild;)o.appendChild(e.firstChild);o.removeChild(e)}staticTemplateCache.set(e,o)}return t.insertBefore(o.cloneNode(!0),r),[i?i.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function patchClass(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),null==t?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function patchStyle(e,t,r){const n=e.style;if(r)if(isString(r)){if(t!==r){const t=n.display;n.cssText=r,"_vod"in e&&(n.display=t)}}else{for(const e in r)setStyle(n,e,r[e]);if(t&&!isString(t))for(const e in t)null==r[e]&&setStyle(n,e,"")}else e.removeAttribute("style")}const importantRE=/\s*!important$/;function setStyle(e,t,r){if(isArray(r))r.forEach((r=>setStyle(e,t,r)));else if(t.startsWith("--"))e.setProperty(t,r);else{const n=autoPrefix(e,t);importantRE.test(r)?e.setProperty(hyphenate(n),r.replace(importantRE,""),"important"):e[n]=r}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(e,t){const r=prefixCache[t];if(r)return r;let n=camelize(t);if("filter"!==n&&n in e)return prefixCache[t]=n;n=capitalize(n);for(let i=0;i<prefixes.length;i++){const r=prefixes[i]+n;if(r in e)return prefixCache[t]=r}return t}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(e,t,r,n,i){if(n&&t.startsWith("xlink:"))null==r?e.removeAttributeNS(xlinkNS,t.slice(6,t.length)):e.setAttributeNS(xlinkNS,t,r);else{const n=isSpecialBooleanAttr(t);null==r||n&&!includeBooleanAttr(r)?e.removeAttribute(t):e.setAttribute(t,n?"":r)}}function patchDOMProp(e,t,r,n,i,o,a){if("innerHTML"===t||"textContent"===t)return n&&a(n,i,o),void(e[t]=null==r?"":r);if("value"===t&&"PROGRESS"!==e.tagName){e._value=r;const n=null==r?"":r;return e.value!==n&&(e.value=n),void(null==r&&e.removeAttribute(t))}if(""===r||null==r){const n=typeof e[t];if("boolean"===n)return void(e[t]=includeBooleanAttr(r));if(null==r&&"string"===n)return e[t]="",void e.removeAttribute(t);if("number"===n){try{e[t]=0}catch(s){}return void e.removeAttribute(t)}}try{e[t]=r}catch(c){}}let _getNow=Date.now,skipTimestampCheck=!1;if("undefined"!=typeof window){_getNow()>document.createEvent("Event").timeStamp&&(_getNow=()=>performance.now());const e=navigator.userAgent.match(/firefox\/(\d+)/i);skipTimestampCheck=!!(e&&Number(e[1])<=53)}let cachedNow=0;const p=Promise.resolve(),reset=()=>{cachedNow=0},getNow=()=>cachedNow||(p.then(reset),cachedNow=_getNow());function addEventListener(e,t,r,n){e.addEventListener(t,r,n)}function removeEventListener(e,t,r,n){e.removeEventListener(t,r,n)}function patchEvent(e,t,r,n,i=null){const o=e._vei||(e._vei={}),a=o[t];if(n&&a)a.value=n;else{const[r,s]=parseName(t);if(n){addEventListener(e,r,o[t]=createInvoker(n,i),s)}else a&&(removeEventListener(e,r,a,s),o[t]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(e){let t;if(optionsModifierRE.test(e)){let r;for(t={};r=e.match(optionsModifierRE);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[hyphenate(e.slice(2)),t]}function createInvoker(e,t){const r=e=>{const n=e.timeStamp||_getNow();(skipTimestampCheck||n>=r.attached-1)&&callWithAsyncErrorHandling(patchStopImmediatePropagation(e,r.value),t,5,[e])};return r.value=e,r.attached=getNow(),r}function patchStopImmediatePropagation(e,t){if(isArray(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e(t)))}return t}const nativeOnRE=/^on[a-z]/,patchProp=(e,t,r,n,i=!1,o,a,s,c)=>{"class"===t?patchClass(e,n,i):"style"===t?patchStyle(e,r,n):isOn(t)?isModelListener(t)||patchEvent(e,t,r,n,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):shouldSetAsProp(e,t,n,i))?patchDOMProp(e,t,n,o,a,s,c):("true-value"===t?e._trueValue=n:"false-value"===t&&(e._falseValue=n),patchAttr(e,t,n,i))};function shouldSetAsProp(e,t,r,n){return n?"innerHTML"===t||"textContent"===t||!!(t in e&&nativeOnRE.test(t)&&isFunction(r)):"spellcheck"!==t&&"draggable"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!nativeOnRE.test(t)||!isString(r))&&t in e))))}const getModelAssigner=e=>{const t=e.props["onUpdate:modelValue"];return isArray(t)?e=>invokeArrayFns(t,e):t};function onCompositionStart(e){e.target.composing=!0}function onCompositionEnd(e){const t=e.target;t.composing&&(t.composing=!1,trigger(t,"input"))}function trigger(e,t){const r=document.createEvent("HTMLEvents");r.initEvent(t,!0,!0),e.dispatchEvent(r)}const vModelText={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e._assign=getModelAssigner(i);const o=n||i.props&&"number"===i.props.type;addEventListener(e,t?"change":"input",(t=>{if(t.target.composing)return;let n=e.value;r?n=n.trim():o&&(n=toNumber(n)),e._assign(n)})),r&&addEventListener(e,"change",(()=>{e.value=e.value.trim()})),t||(addEventListener(e,"compositionstart",onCompositionStart),addEventListener(e,"compositionend",onCompositionEnd),addEventListener(e,"change",onCompositionEnd))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:i}},o){if(e._assign=getModelAssigner(o),e.composing)return;if(document.activeElement===e){if(r)return;if(n&&e.value.trim()===t)return;if((i||"number"===e.type)&&toNumber(e.value)===t)return}const a=null==t?"":t;e.value!==a&&(e.value=a)}},systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>systemModifiers.some((r=>e[`${r}Key`]&&!t.includes(r)))},withModifiers=(e,t)=>(r,...n)=>{for(let e=0;e<t.length;e++){const n=modifierGuards[t[e]];if(n&&n(r,t))return}return e(r,...n)},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(e,t)=>r=>{if(!("key"in r))return;const n=hyphenate(r.key);return t.some((e=>e===n||keyNames[e]===n))?e(r):void 0},vShow={beforeMount(e,{value:t},{transition:r}){e._vod="none"===e.style.display?"":e.style.display,r&&t?r.beforeEnter(e):setDisplay(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),setDisplay(e,!0),n.enter(e)):n.leave(e,(()=>{setDisplay(e,!1)})):setDisplay(e,t))},beforeUnmount(e,{value:t}){setDisplay(e,t)}};function setDisplay(e,t){e.style.display=t?e._vod:"none"}const rendererOptions=extend({patchProp:patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...e)=>{const t=ensureRenderer().createApp(...e),{mount:r}=t;return t.mount=e=>{const n=normalizeContainer(e);if(!n)return;const i=t._component;isFunction(i)||i.render||i.template||(i.template=n.innerHTML),n.innerHTML="";const o=r(n,!1,n instanceof SVGElement);return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};function normalizeContainer(e){if(isString(e)){return document.querySelector(e)}return e}const e=e=>e.split("").map((e=>(/[A-Z]/.test(e)?"-":"")+e.toLowerCase())).join(""),t=e=>{throw new Error(`[VueComponentStyle] ${e}`)},s$1=e=>toString.call(e).match(/\s([a-zA-Z]+)/)[1],n=(e,t)=>"Object"===s$1(e)?Object.keys(e).forEach((r=>t(r,e[r]))):e.forEach(t),i="data-vcs-id",o="text/css",c=(t,r)=>e(`vcs-${t}-${r}`),r=(t,i)=>{const o=[`${t} {`,"}"];let a=1;return n(i,((n,i)=>{"Object"===s$1(i)?o.push(r(n.split("&").join(t),i)):(o.splice(a,0,`${e(n)}:${i};`),a+=1)})),o.join("")};var l={emits:["styleChange"],created(){this.$calcStyle()},methods:{$calcStyle(){const a=this.$options.style;if("Undefined"!==s$1(a)){const s="undefined"!=typeof document?document:void 0,u=this._ssrAppObject,l=this.$lastStyleId;if("Undefined"!==s$1(l)&&function(e,t,r){if(void 0!==t){const r=t.querySelector(`style[${i}="${e}"]`);r&&r.remove()}else if(void 0!==r){const t=r.head.style.findIndex((t=>t[i]===e));-1!==t&&r.splice(t,1)}}(l,s,u),"Function"===s$1(a)){const l=`${Math.floor(99999*Math.random())}${Date.now()}`.padStart(18,0),p=(t=>{const i={};return{maps:i,className(e,n={}){const o=c(t,e),a=r(`.${o}`,n);return i[e]=o,a},mediaQuery:(t,r=[])=>`@media screen and (${(()=>{const r=[];return n(t,((t,n)=>{r.push(`${e(t)}: ${n}`)})),r.join(" and ")})()}){${r.join(" ")}}`,keyFrames(o,a){const s=c(t,o);return i[o]=c,a?`@keyframes ${s} { ${(()=>{const t=[];return n(a,((n,i)=>{t.push(r(e(n),i))})),t.join(" ")})()} }`:s},custom:(t,n)=>r(e(t),n)}})(l),f=a.call(this,p);"Array"!==s$1(f)&&t("'style' function should returns Array!"),function(e,t,r,n){if(void 0!==r){const n=r.querySelector(`style[${i}="${e}"]`)||r.createElement("style");n.setAttribute(i,e),n.type=o,n.innerHTML=t,r.head.appendChild(n)}else if(void 0!==n){const r=n.head.style.find((t=>t[i]===e));r?r.innerHTML=t:n.head.style.push({[i]:e,type:o,innerHTML:t})}}(l,f.join(""),s,u),this.$style=p.maps,this.$lastStyleId=l,this.$nextTick((()=>{setTimeout((()=>{this.$emit("styleChange",this.$style)}))}))}else t("'style' should be function!")}}}},a={install(e){e.mixin(l)}},commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getAugmentedNamespace(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browserfs={exports:{}},factory;function assertPath(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function normalizeStringPosix(e,t){for(var r,n="",i=0,o=-1,a=0,s=0;s<=e.length;++s){if(s<e.length)r=e.charCodeAt(s);else{if(47===r)break;r=47}if(47===r){if(o===s-1||1===a);else if(o!==s-1&&2===a){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var c=n.lastIndexOf("/");if(c!==n.length-1){-1===c?(n="",i=0):i=(n=n.slice(0,c)).length-1-n.lastIndexOf("/"),o=s,a=0;continue}}else if(2===n.length||1===n.length){n="",i=0,o=s,a=0;continue}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(o+1,s):n=e.slice(o+1,s),i=s-o-1;o=s,a=0}else 46===r&&-1!==a?++a:a=-1}return n}function _format(e,t){var r=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+n:r+e+n:n}factory=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){(function(e,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a,s,c=r(2),u=r(9);(s=a||(a={}))[s.EPERM=1]="EPERM",s[s.ENOENT=2]="ENOENT",s[s.EIO=5]="EIO",s[s.EBADF=9]="EBADF",s[s.EACCES=13]="EACCES",s[s.EBUSY=16]="EBUSY",s[s.EEXIST=17]="EEXIST",s[s.ENOTDIR=20]="ENOTDIR",s[s.EISDIR=21]="EISDIR",s[s.EINVAL=22]="EINVAL",s[s.EFBIG=27]="EFBIG",s[s.ENOSPC=28]="ENOSPC",s[s.EROFS=30]="EROFS",s[s.ENOTEMPTY=39]="ENOTEMPTY",s[s.ENOTSUP=95]="ENOTSUP";var l={};l[a.EPERM]="Operation not permitted.",l[a.ENOENT]="No such file or directory.",l[a.EIO]="Input/output error.",l[a.EBADF]="Bad file descriptor.",l[a.EACCES]="Permission denied.",l[a.EBUSY]="Resource busy or locked.",l[a.EEXIST]="File exists.",l[a.ENOTDIR]="File is not a directory.",l[a.EISDIR]="File is a directory.",l[a.EINVAL]="Invalid argument.",l[a.EFBIG]="File is too big.",l[a.ENOSPC]="No space left on disk.",l[a.EROFS]="Cannot modify a read-only file system.",l[a.ENOTEMPTY]="Directory is not empty.",l[a.ENOTSUP]="Operation is not supported.";var p,f,d=function(t){function r(e,r,n){void 0===r&&(r=l[e]),t.call(this,r),this.syscall="",this.errno=e,this.code=a[e],this.path=n,this.stack=(new t).stack,this.message="Error: "+this.code+": "+r+(this.path?", '"+this.path+"'":"")}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.fromJSON=function(e){var t=new r(0);return t.errno=e.errno,t.code=e.code,t.path=e.path,t.stack=e.stack,t.message=e.message,t},r.fromBuffer=function(e,t){return void 0===t&&(t=0),r.fromJSON(JSON.parse(e.toString("utf8",t+4,t+4+e.readUInt32LE(t))))},r.FileError=function(e,t){return new r(e,l[e],t)},r.ENOENT=function(e){return this.FileError(a.ENOENT,e)},r.EEXIST=function(e){return this.FileError(a.EEXIST,e)},r.EISDIR=function(e){return this.FileError(a.EISDIR,e)},r.ENOTDIR=function(e){return this.FileError(a.ENOTDIR,e)},r.EPERM=function(e){return this.FileError(a.EPERM,e)},r.ENOTEMPTY=function(e){return this.FileError(a.ENOTEMPTY,e)},r.prototype.toString=function(){return this.message},r.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},r.prototype.writeToBuffer=function(t,r){void 0===t&&(t=e.alloc(this.bufferSize())),void 0===r&&(r=0);var n=t.write(JSON.stringify(this.toJSON()),r+4);return t.writeUInt32LE(n,r),t},r.prototype.bufferSize=function(){return 4+e.byteLength(JSON.stringify(this.toJSON()))},r}(Error),h=Object.freeze({get ErrorCode(){return a},ErrorStrings:l,ApiError:d});(f=p||(p={}))[f.NOP=0]="NOP",f[f.THROW_EXCEPTION=1]="THROW_EXCEPTION",f[f.TRUNCATE_FILE=2]="TRUNCATE_FILE",f[f.CREATE_FILE=3]="CREATE_FILE";var m,g,y=function e(t){if(this.flagStr=t,e.validFlagStrs.indexOf(t)<0)throw new d(a.EINVAL,"Invalid flag: "+t)};y.getFileFlag=function(e){return y.flagCache.hasOwnProperty(e)?y.flagCache[e]:y.flagCache[e]=new y(e)},y.prototype.getFlagString=function(){return this.flagStr},y.prototype.isReadable=function(){return-1!==this.flagStr.indexOf("r")||-1!==this.flagStr.indexOf("+")},y.prototype.isWriteable=function(){return-1!==this.flagStr.indexOf("w")||-1!==this.flagStr.indexOf("a")||-1!==this.flagStr.indexOf("+")},y.prototype.isTruncating=function(){return-1!==this.flagStr.indexOf("w")},y.prototype.isAppendable=function(){return-1!==this.flagStr.indexOf("a")},y.prototype.isSynchronous=function(){return-1!==this.flagStr.indexOf("s")},y.prototype.isExclusive=function(){return-1!==this.flagStr.indexOf("x")},y.prototype.pathExistsAction=function(){return this.isExclusive()?p.THROW_EXCEPTION:this.isTruncating()?p.TRUNCATE_FILE:p.NOP},y.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&"r+"!==this.flagStr?p.CREATE_FILE:p.THROW_EXCEPTION},y.flagCache={},y.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"],(g=m||(m={}))[g.FILE=32768]="FILE",g[g.DIRECTORY=16384]="DIRECTORY",g[g.SYMLINK=40960]="SYMLINK";var v=function(e,t,r,n,i,o){if(void 0===n&&(n=new Date),void 0===i&&(i=new Date),void 0===o&&(o=new Date),this.size=t,this.atime=n,this.mtime=i,this.ctime=o,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,r)this.mode=r;else switch(e){case m.FILE:this.mode=420;break;case m.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(t/512),this.mode<4096&&(this.mode|=e)};v.fromBuffer=function(e){var t=e.readUInt32LE(0),r=e.readUInt32LE(4),n=e.readDoubleLE(8),i=e.readDoubleLE(16),o=e.readDoubleLE(24);return new v(61440&r,t,4095&r,new Date(n),new Date(i),new Date(o))},v.prototype.toBuffer=function(){var t=e.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t},v.prototype.clone=function(){return new v(61440&this.mode,this.size,4095&this.mode,this.atime,this.mtime,this.ctime)},v.prototype.isFile=function(){return(61440&this.mode)===m.FILE},v.prototype.isDirectory=function(){return(61440&this.mode)===m.DIRECTORY},v.prototype.isSymbolicLink=function(){return(61440&this.mode)===m.SYMLINK},v.prototype.chmod=function(e){this.mode=61440&this.mode|e},v.prototype.isSocket=function(){return!1},v.prototype.isBlockDevice=function(){return!1},v.prototype.isCharacterDevice=function(){return!1},v.prototype.isFIFO=function(){return!1};var _=function(e,t){return e};function b(e){if(e)return e;throw new d(a.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function w(e,t){switch(typeof e){case"number":return e;case"string":var r=parseInt(e,8);return isNaN(r)?t:r;default:return t}}function T(e){if(e instanceof Date)return e;if("number"==typeof e)return new Date(1e3*e);throw new d(a.EINVAL,"Invalid time.")}function k(e){if(e.indexOf("\0")>=0)throw new d(a.EINVAL,"Path must be a string without null bytes.");if(""===e)throw new d(a.EINVAL,"Path must not be empty.");return u.resolve(e)}function E(e,t,r,n){switch(typeof e){case"object":return{encoding:void 0!==e.encoding?e.encoding:t,flag:void 0!==e.flag?e.flag:r,mode:w(e.mode,n)};case"string":return{encoding:e,flag:r,mode:n};default:return{encoding:t,flag:r,mode:n}}}function S(){}var I=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};I.prototype.initialize=function(e){if(!e.constructor.isAvailable())throw new d(a.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=e},I.prototype._toUnixTimestamp=function(e){if("number"==typeof e)return e;if(e instanceof Date)return e.getTime()/1e3;throw new Error("Cannot parse time: "+e)},I.prototype.getRootFS=function(){return this.root?this.root:null},I.prototype.rename=function(e,t,r){void 0===r&&(r=S);var n=_(r,1);try{b(this.root).rename(k(e),k(t),n)}catch(i){n(i)}},I.prototype.renameSync=function(e,t){b(this.root).renameSync(k(e),k(t))},I.prototype.exists=function(e,t){void 0===t&&(t=S);var r=_(t,1);try{return b(this.root).exists(k(e),r)}catch(n){return r(!1)}},I.prototype.existsSync=function(e){try{return b(this.root).existsSync(k(e))}catch(t){return!1}},I.prototype.stat=function(e,t){void 0===t&&(t=S);var r=_(t,2);try{return b(this.root).stat(k(e),!1,r)}catch(n){return r(n)}},I.prototype.statSync=function(e){return b(this.root).statSync(k(e),!1)},I.prototype.lstat=function(e,t){void 0===t&&(t=S);var r=_(t,2);try{return b(this.root).stat(k(e),!0,r)}catch(n){return r(n)}},I.prototype.lstatSync=function(e){return b(this.root).statSync(k(e),!0)},I.prototype.truncate=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=S);var n=0;"function"==typeof t?r=t:"number"==typeof t&&(n=t);var i=_(r,1);try{if(n<0)throw new d(a.EINVAL);return b(this.root).truncate(k(e),n,i)}catch(o){return i(o)}},I.prototype.truncateSync=function(e,t){if(void 0===t&&(t=0),t<0)throw new d(a.EINVAL);return b(this.root).truncateSync(k(e),t)},I.prototype.unlink=function(e,t){void 0===t&&(t=S);var r=_(t,1);try{return b(this.root).unlink(k(e),r)}catch(n){return r(n)}},I.prototype.unlinkSync=function(e){return b(this.root).unlinkSync(k(e))},I.prototype.open=function(e,t,r,n){var i=this;void 0===n&&(n=S);var o=w(r,420),a=_(n="function"==typeof r?r:n,2);try{b(this.root).open(k(e),y.getFileFlag(t),o,(function(e,t){t?a(e,i.getFdForFile(t)):a(e)}))}catch(s){a(s)}},I.prototype.openSync=function(e,t,r){return void 0===r&&(r=420),this.getFdForFile(b(this.root).openSync(k(e),y.getFileFlag(t),w(r,420)))},I.prototype.readFile=function(e,t,r){void 0===t&&(t={}),void 0===r&&(r=S);var n=E(t,null,"r",null),i=_(r="function"==typeof t?t:r,2);try{var o=y.getFileFlag(n.flag);return o.isReadable()?b(this.root).readFile(k(e),n.encoding,o,i):i(new d(a.EINVAL,"Flag passed to readFile must allow for reading."))}catch(s){return i(s)}},I.prototype.readFileSync=function(e,t){void 0===t&&(t={});var r=E(t,null,"r",null),n=y.getFileFlag(r.flag);if(!n.isReadable())throw new d(a.EINVAL,"Flag passed to readFile must allow for reading.");return b(this.root).readFileSync(k(e),r.encoding,n)},I.prototype.writeFile=function(e,t,r,n){void 0===r&&(r={}),void 0===n&&(n=S);var i=E(r,"utf8","w",420),o=_(n="function"==typeof r?r:n,1);try{var s=y.getFileFlag(i.flag);return s.isWriteable()?b(this.root).writeFile(k(e),t,i.encoding,s,i.mode,o):o(new d(a.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(c){return o(c)}},I.prototype.writeFileSync=function(e,t,r){var n=E(r,"utf8","w",420),i=y.getFileFlag(n.flag);if(!i.isWriteable())throw new d(a.EINVAL,"Flag passed to writeFile must allow for writing.");return b(this.root).writeFileSync(k(e),t,n.encoding,i,n.mode)},I.prototype.appendFile=function(e,t,r,n){void 0===n&&(n=S);var i=E(r,"utf8","a",420),o=_(n="function"==typeof r?r:n,1);try{var s=y.getFileFlag(i.flag);if(!s.isAppendable())return o(new d(a.EINVAL,"Flag passed to appendFile must allow for appending."));b(this.root).appendFile(k(e),t,i.encoding,s,i.mode,o)}catch(c){o(c)}},I.prototype.appendFileSync=function(e,t,r){var n=E(r,"utf8","a",420),i=y.getFileFlag(n.flag);if(!i.isAppendable())throw new d(a.EINVAL,"Flag passed to appendFile must allow for appending.");return b(this.root).appendFileSync(k(e),t,n.encoding,i,n.mode)},I.prototype.fstat=function(e,t){void 0===t&&(t=S);var r=_(t,2);try{this.fd2file(e).stat(r)}catch(n){r(n)}},I.prototype.fstatSync=function(e){return this.fd2file(e).statSync()},I.prototype.close=function(e,t){var r=this;void 0===t&&(t=S);var n=_(t,1);try{this.fd2file(e).close((function(t){t||r.closeFd(e),n(t)}))}catch(i){n(i)}},I.prototype.closeSync=function(e){this.fd2file(e).closeSync(),this.closeFd(e)},I.prototype.ftruncate=function(e,t,r){void 0===r&&(r=S);var n="number"==typeof t?t:0,i=_(r="function"==typeof t?t:r,1);try{var o=this.fd2file(e);if(n<0)throw new d(a.EINVAL);o.truncate(n,i)}catch(s){i(s)}},I.prototype.ftruncateSync=function(e,t){void 0===t&&(t=0);var r=this.fd2file(e);if(t<0)throw new d(a.EINVAL);r.truncateSync(t)},I.prototype.fsync=function(e,t){void 0===t&&(t=S);var r=_(t,1);try{this.fd2file(e).sync(r)}catch(n){r(n)}},I.prototype.fsyncSync=function(e){this.fd2file(e).syncSync()},I.prototype.fdatasync=function(e,t){void 0===t&&(t=S);var r=_(t,1);try{this.fd2file(e).datasync(r)}catch(n){r(n)}},I.prototype.fdatasyncSync=function(e){this.fd2file(e).datasyncSync()},I.prototype.write=function(t,r,n,i,o,s){void 0===s&&(s=S);var c,u,l,p=null;if("string"==typeof r){var f="utf8";switch(typeof n){case"function":s=n;break;case"number":p=n,f="string"==typeof i?i:"utf8",s="function"==typeof o?o:s;break;default:return(s="function"==typeof i?i:"function"==typeof o?o:s)(new d(a.EINVAL,"Invalid arguments."))}u=0,l=(c=e.from(r,f)).length}else c=r,u=n,l=i,p="number"==typeof o?o:null,s="function"==typeof o?o:s;var h=_(s,3);try{var m=this.fd2file(t);null==p&&(p=m.getPos()),m.write(c,u,l,p,h)}catch(g){h(g)}},I.prototype.writeSync=function(t,r,n,i,o){var a,s,c,u=0;if("string"==typeof r){c="number"==typeof n?n:null;var l="string"==typeof i?i:"utf8";u=0,s=(a=e.from(r,l)).length}else a=r,u=n,s=i,c="number"==typeof o?o:null;var p=this.fd2file(t);return null==c&&(c=p.getPos()),p.writeSync(a,u,s,c)},I.prototype.read=function(t,r,n,i,o,a){var s,c,u,l,p;if(void 0===a&&(a=S),"number"==typeof r){u=r,s=n;var f=i;a="function"==typeof o?o:a,c=0,l=e.alloc(u),p=_((function(e,t,r){if(e)return a(e);a(e,r.toString(f),t)}),3)}else l=r,c=n,u=i,s=o,p=_(a,3);try{var d=this.fd2file(t);null==s&&(s=d.getPos()),d.read(l,c,u,s,p)}catch(h){p(h)}},I.prototype.readSync=function(t,r,n,i,o){var a,s,c,u,l=!1,p="utf8";"number"==typeof r?(c=r,u=n,p=i,s=0,a=e.alloc(c),l=!0):(a=r,s=n,c=i,u=o);var f=this.fd2file(t);null==u&&(u=f.getPos());var d=f.readSync(a,s,c,u);return l?[a.toString(p),d]:d},I.prototype.fchown=function(e,t,r,n){void 0===n&&(n=S);var i=_(n,1);try{this.fd2file(e).chown(t,r,i)}catch(o){i(o)}},I.prototype.fchownSync=function(e,t,r){this.fd2file(e).chownSync(t,r)},I.prototype.fchmod=function(e,t,r){var n=_(r,1);try{var i="string"==typeof t?parseInt(t,8):t;this.fd2file(e).chmod(i,n)}catch(o){n(o)}},I.prototype.fchmodSync=function(e,t){var r="string"==typeof t?parseInt(t,8):t;this.fd2file(e).chmodSync(r)},I.prototype.futimes=function(e,t,r,n){void 0===n&&(n=S);var i=_(n,1);try{var o=this.fd2file(e);"number"==typeof t&&(t=new Date(1e3*t)),"number"==typeof r&&(r=new Date(1e3*r)),o.utimes(t,r,i)}catch(a){i(a)}},I.prototype.futimesSync=function(e,t,r){this.fd2file(e).utimesSync(T(t),T(r))},I.prototype.rmdir=function(e,t){void 0===t&&(t=S);var r=_(t,1);try{e=k(e),b(this.root).rmdir(e,r)}catch(n){r(n)}},I.prototype.rmdirSync=function(e){return e=k(e),b(this.root).rmdirSync(e)},I.prototype.mkdir=function(e,t,r){void 0===r&&(r=S),"function"==typeof t&&(r=t,t=511);var n=_(r,1);try{e=k(e),b(this.root).mkdir(e,t,n)}catch(i){n(i)}},I.prototype.mkdirSync=function(e,t){b(this.root).mkdirSync(k(e),w(t,511))},I.prototype.readdir=function(e,t){void 0===t&&(t=S);var r=_(t,2);try{e=k(e),b(this.root).readdir(e,r)}catch(n){r(n)}},I.prototype.readdirSync=function(e){return e=k(e),b(this.root).readdirSync(e)},I.prototype.link=function(e,t,r){void 0===r&&(r=S);var n=_(r,1);try{e=k(e),t=k(t),b(this.root).link(e,t,n)}catch(i){n(i)}},I.prototype.linkSync=function(e,t){return e=k(e),t=k(t),b(this.root).linkSync(e,t)},I.prototype.symlink=function(e,t,r,n){void 0===n&&(n=S);var i="string"==typeof r?r:"file",o=_(n="function"==typeof r?r:n,1);try{if("file"!==i&&"dir"!==i)return o(new d(a.EINVAL,"Invalid type: "+i));e=k(e),t=k(t),b(this.root).symlink(e,t,i,o)}catch(s){o(s)}},I.prototype.symlinkSync=function(e,t,r){if(r){if("file"!==r&&"dir"!==r)throw new d(a.EINVAL,"Invalid type: "+r)}else r="file";return e=k(e),t=k(t),b(this.root).symlinkSync(e,t,r)},I.prototype.readlink=function(e,t){void 0===t&&(t=S);var r=_(t,2);try{e=k(e),b(this.root).readlink(e,r)}catch(n){r(n)}},I.prototype.readlinkSync=function(e){return e=k(e),b(this.root).readlinkSync(e)},I.prototype.chown=function(e,t,r,n){void 0===n&&(n=S);var i=_(n,1);try{e=k(e),b(this.root).chown(e,!1,t,r,i)}catch(o){i(o)}},I.prototype.chownSync=function(e,t,r){e=k(e),b(this.root).chownSync(e,!1,t,r)},I.prototype.lchown=function(e,t,r,n){void 0===n&&(n=S);var i=_(n,1);try{e=k(e),b(this.root).chown(e,!0,t,r,i)}catch(o){i(o)}},I.prototype.lchownSync=function(e,t,r){e=k(e),b(this.root).chownSync(e,!0,t,r)},I.prototype.chmod=function(e,t,r){void 0===r&&(r=S);var n=_(r,1);try{var i=w(t,-1);if(i<0)throw new d(a.EINVAL,"Invalid mode.");b(this.root).chmod(k(e),!1,i,n)}catch(o){n(o)}},I.prototype.chmodSync=function(e,t){var r=w(t,-1);if(r<0)throw new d(a.EINVAL,"Invalid mode.");e=k(e),b(this.root).chmodSync(e,!1,r)},I.prototype.lchmod=function(e,t,r){void 0===r&&(r=S);var n=_(r,1);try{var i=w(t,-1);if(i<0)throw new d(a.EINVAL,"Invalid mode.");b(this.root).chmod(k(e),!0,i,n)}catch(o){n(o)}},I.prototype.lchmodSync=function(e,t){var r=w(t,-1);if(r<1)throw new d(a.EINVAL,"Invalid mode.");b(this.root).chmodSync(k(e),!0,r)},I.prototype.utimes=function(e,t,r,n){void 0===n&&(n=S);var i=_(n,1);try{b(this.root).utimes(k(e),T(t),T(r),i)}catch(o){i(o)}},I.prototype.utimesSync=function(e,t,r){b(this.root).utimesSync(k(e),T(t),T(r))},I.prototype.realpath=function(e,t,r){void 0===r&&(r=S);var n="object"==typeof t?t:{},i=_(r="function"==typeof t?t:S,2);try{e=k(e),b(this.root).realpath(e,n,i)}catch(o){i(o)}},I.prototype.realpathSync=function(e,t){return void 0===t&&(t={}),e=k(e),b(this.root).realpathSync(e,t)},I.prototype.watchFile=function(e,t,r){throw new d(a.ENOTSUP)},I.prototype.unwatchFile=function(e,t){throw new d(a.ENOTSUP)},I.prototype.watch=function(e,t,r){throw new d(a.ENOTSUP)},I.prototype.access=function(e,t,r){throw new d(a.ENOTSUP)},I.prototype.accessSync=function(e,t){throw new d(a.ENOTSUP)},I.prototype.createReadStream=function(e,t){throw new d(a.ENOTSUP)},I.prototype.createWriteStream=function(e,t){throw new d(a.ENOTSUP)},I.prototype.wrapCallbacks=function(e){_=e},I.prototype.getFdForFile=function(e){var t=this.nextFd++;return this.fdMap[t]=e,t},I.prototype.fd2file=function(e){var t=this.fdMap[e];if(t)return t;throw new d(a.EBADF,"Invalid file descriptor.")},I.prototype.closeFd=function(e){delete this.fdMap[e]},I.Stats=v;var P=new I,A={},C=I.prototype;function F(e,t,r,n,i){return e<t||r<t?e>r?r+1:e+1:n===i?t:t+1}function D(e,t){if(e===t)return 0;if(e.length>t.length){var r=e;e=t,t=r}for(var n=e.length,i=t.length;n>0&&e.charCodeAt(n-1)===t.charCodeAt(i-1);)n--,i--;for(var o=0;o<n&&e.charCodeAt(o)===t.charCodeAt(o);)o++;if(i-=o,0==(n-=o)||1===i)return i;for(var a,s,c,u,l,p=new Array(n<<1),f=0;f<n;)p[n+f]=e.charCodeAt(o+f),p[f]=++f;for(a=0;a+3<i;)for(var d=t.charCodeAt(o+(s=a)),h=t.charCodeAt(o+(c=a+1)),m=t.charCodeAt(o+(u=a+2)),g=t.charCodeAt(o+(l=a+3)),y=a+=4,v=0;v<n;){var _=p[n+v],b=p[v];s=F(b,s,c,d,_),c=F(s,c,u,h,_),u=F(c,u,l,m,_),y=F(u,l,y,g,_),p[v++]=y,l=u,u=c,c=s,s=b}for(var w=0;a<i;){var T=t.charCodeAt(o+(s=a));w=++a;for(var k=0;k<n;k++){var E=p[k];p[k]=w=E<s||w<s?E>w?w+1:E+1:T===p[n+k]?s:s+1,s=E}}return w}function O(e,t,r){e&&console.warn("["+t+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+t+".Create("+JSON.stringify(r)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}Object.keys(C).forEach((function(e){"function"==typeof P[e]?A[e]=function(){return P[e].apply(P,arguments)}:A[e]=P[e]})),A.changeFSModule=function(e){P=e},A.getFSModule=function(){return P},A.FS=I;var x="undefined"!=typeof navigator&&!(!/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())&&-1===navigator.userAgent.indexOf("Trident")),R="undefined"==typeof window;function M(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function N(e,t,r){r.existsSync(e)||(N(u.dirname(e),t,r),r.mkdirSync(e,t))}function $(e){var t=B(e),r=t.byteOffset,n=t.byteLength;return 0===r&&n===t.buffer.byteLength?t.buffer:t.buffer.slice(r,r+n)}function B(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function L(t){return t instanceof e?t:t instanceof Uint8Array?U(t):e.from(t)}function U(t){return t instanceof e?t:0===t.byteOffset&&t.byteLength===t.buffer.byteLength?z(t.buffer):e.from(t.buffer,t.byteOffset,t.byteLength)}function z(t){return e.from(t)}function j(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.length),t<0||r<0||r>e.length||t>r)throw new TypeError("Invalid slice bounds on buffer of length "+e.length+": ["+t+", "+r+"]");if(0===e.length)return G();var n=B(e),i=e[0],o=(i+1)%255;return e[0]=o,n[0]===o?(n[0]=i,U(n.slice(t,r))):(e[0]=i,U(n.subarray(t,r)))}var H=null;function G(){return H||(H=e.alloc(0))}function V(t,r){e.isBuffer(t)?r():r(new d(a.EINVAL,"option must be a Buffer."))}function W(e,t,r){var n=e.Options,i=e.Name,o=0,s=!1,c=!1;function u(e){s||(e&&(s=!0,r(e)),0==--o&&c&&r())}var l=function(e){if(n.hasOwnProperty(e)){var c=n[e],l=t[e];if(null==l){if(!c.optional){var p=Object.keys(t).filter((function(e){return!(e in n)})).map((function(t){return{str:t,distance:D(e,t)}})).filter((function(e){return e.distance<5})).sort((function(e,t){return e.distance-t.distance}));return s?{}:(s=!0,{v:r(new d(a.EINVAL,"["+i+"] Required option '"+e+"' not provided."+(p.length>0?" You provided unrecognized option '"+p[0].str+"'; perhaps you meant to type '"+e+"'.":"")+"\nOption description: "+c.description))})}}else{if(!(Array.isArray(c.type)?-1!==c.type.indexOf(typeof l):typeof l===c.type))return s?{}:(s=!0,{v:r(new d(a.EINVAL,"["+i+"] Value provided for option "+e+" is not the proper type. Expected "+(Array.isArray(c.type)?"one of {"+c.type.join(", ")+"}":c.type)+", but received "+typeof l+"\nOption description: "+c.description))});c.validator&&(o++,c.validator(l,u))}}};for(var p in n){var f=l(p);if(f)return f.v}c=!0,0!==o||s||r()}var X=Object.freeze({deprecationMessage:O,isIE:x,isWebWorker:R,fail:M,mkdirpSync:N,buffer2ArrayBuffer:$,buffer2Uint8array:B,arrayish2Buffer:L,uint8Array2Buffer:U,arrayBuffer2Buffer:z,copyingSlice:j,emptyBuffer:G,bufferValidator:V,checkOptions:W}),q=function(e){this.fs=e,this.nodefs=e.getNodeFS(),this.FS=e.getFS(),this.PATH=e.getPATH(),this.ERRNO_CODES=e.getERRNO_CODES()};q.prototype.open=function(e){var t=this.fs.realPath(e.node),r=this.FS;try{r.isFile(e.node.mode)&&(e.nfd=this.nodefs.openSync(t,this.fs.flagsToPermissionString(e.flags)))}catch(n){if(!n.code)throw n;throw new r.ErrnoError(this.ERRNO_CODES[n.code])}},q.prototype.close=function(e){var t=this.FS;try{t.isFile(e.node.mode)&&e.nfd&&this.nodefs.closeSync(e.nfd)}catch(r){if(!r.code)throw r;throw new t.ErrnoError(this.ERRNO_CODES[r.code])}},q.prototype.read=function(e,t,r,n,i){try{return this.nodefs.readSync(e.nfd,U(t),r,n,i)}catch(o){throw new this.FS.ErrnoError(this.ERRNO_CODES[o.code])}},q.prototype.write=function(e,t,r,n,i){try{return this.nodefs.writeSync(e.nfd,U(t),r,n,i)}catch(o){throw new this.FS.ErrnoError(this.ERRNO_CODES[o.code])}},q.prototype.llseek=function(e,t,r){var n=t;if(1===r)n+=e.position;else if(2===r&&this.FS.isFile(e.node.mode))try{n+=this.nodefs.fstatSync(e.nfd).size}catch(i){throw new this.FS.ErrnoError(this.ERRNO_CODES[i.code])}if(n<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return e.position=n,n};var Y=function(e){this.fs=e,this.nodefs=e.getNodeFS(),this.FS=e.getFS(),this.PATH=e.getPATH(),this.ERRNO_CODES=e.getERRNO_CODES()};Y.prototype.getattr=function(e){var t,r=this.fs.realPath(e);try{t=this.nodefs.lstatSync(r)}catch(n){if(!n.code)throw n;throw new this.FS.ErrnoError(this.ERRNO_CODES[n.code])}return{dev:t.dev,ino:t.ino,mode:t.mode,nlink:t.nlink,uid:t.uid,gid:t.gid,rdev:t.rdev,size:t.size,atime:t.atime,mtime:t.mtime,ctime:t.ctime,blksize:t.blksize,blocks:t.blocks}},Y.prototype.setattr=function(e,t){var r=this.fs.realPath(e);try{if(void 0!==t.mode&&(this.nodefs.chmodSync(r,t.mode),e.mode=t.mode),void 0!==t.timestamp){var n=new Date(t.timestamp);this.nodefs.utimesSync(r,n,n)}}catch(i){if(!i.code)throw i;if("ENOTSUP"!==i.code)throw new this.FS.ErrnoError(this.ERRNO_CODES[i.code])}if(void 0!==t.size)try{this.nodefs.truncateSync(r,t.size)}catch(i){if(!i.code)throw i;throw new this.FS.ErrnoError(this.ERRNO_CODES[i.code])}},Y.prototype.lookup=function(e,t){var r=this.PATH.join2(this.fs.realPath(e),t),n=this.fs.getMode(r);return this.fs.createNode(e,t,n)},Y.prototype.mknod=function(e,t,r,n){var i=this.fs.createNode(e,t,r,n),o=this.fs.realPath(i);try{this.FS.isDir(i.mode)?this.nodefs.mkdirSync(o,i.mode):this.nodefs.writeFileSync(o,"",{mode:i.mode})}catch(a){if(!a.code)throw a;throw new this.FS.ErrnoError(this.ERRNO_CODES[a.code])}return i},Y.prototype.rename=function(e,t,r){var n=this.fs.realPath(e),i=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.renameSync(n,i),e.name=r,e.parent=t}catch(o){if(!o.code)throw o;throw new this.FS.ErrnoError(this.ERRNO_CODES[o.code])}},Y.prototype.unlink=function(e,t){var r=this.PATH.join2(this.fs.realPath(e),t);try{this.nodefs.unlinkSync(r)}catch(n){if(!n.code)throw n;throw new this.FS.ErrnoError(this.ERRNO_CODES[n.code])}},Y.prototype.rmdir=function(e,t){var r=this.PATH.join2(this.fs.realPath(e),t);try{this.nodefs.rmdirSync(r)}catch(n){if(!n.code)throw n;throw new this.FS.ErrnoError(this.ERRNO_CODES[n.code])}},Y.prototype.readdir=function(e){var t=this.fs.realPath(e);try{var r=this.nodefs.readdirSync(t);return r.push(".",".."),r}catch(n){if(!n.code)throw n;throw new this.FS.ErrnoError(this.ERRNO_CODES[n.code])}},Y.prototype.symlink=function(e,t,r){var n=this.PATH.join2(this.fs.realPath(e),t);try{this.nodefs.symlinkSync(r,n)}catch(i){if(!i.code)throw i;throw new this.FS.ErrnoError(this.ERRNO_CODES[i.code])}},Y.prototype.readlink=function(e){var t=this.fs.realPath(e);try{return this.nodefs.readlinkSync(t)}catch(r){if(!r.code)throw r;throw new this.FS.ErrnoError(this.ERRNO_CODES[r.code])}};var K=function(e,t,r,n){void 0===e&&(e=self.FS),void 0===t&&(t=self.PATH),void 0===r&&(r=self.ERRNO_CODES),void 0===n&&(n=A),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=n,this.FS=e,this.PATH=t,this.ERRNO_CODES=r,this.node_ops=new Y(this),this.stream_ops=new q(this)};K.prototype.mount=function(e){return this.createNode(null,"/",this.getMode(e.opts.root),0)},K.prototype.createNode=function(e,t,r,n){var i=this.FS;if(!i.isDir(r)&&!i.isFile(r)&&!i.isLink(r))throw new i.ErrnoError(this.ERRNO_CODES.EINVAL);var o=i.createNode(e,t,r);return o.node_ops=this.node_ops,o.stream_ops=this.stream_ops,o},K.prototype.getMode=function(e){var t;try{t=this.nodefs.lstatSync(e)}catch(r){if(!r.code)throw r;throw new this.FS.ErrnoError(this.ERRNO_CODES[r.code])}return t.mode},K.prototype.realPath=function(e){for(var t=[];e.parent!==e;)t.push(e.name),e=e.parent;return t.push(e.mount.opts.root),t.reverse(),this.PATH.join.apply(null,t)},K.prototype.flagsToPermissionString=function(e){var t="string"==typeof e?parseInt(e,10):e;return(t&=8191)in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[t]:e},K.prototype.getNodeFS=function(){return this.nodefs},K.prototype.getFS=function(){return this.FS},K.prototype.getPATH=function(){return this.PATH},K.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var Z=function(){};Z.prototype.supportsLinks=function(){return!1},Z.prototype.diskSpace=function(e,t){t(0,0)},Z.prototype.openFile=function(e,t,r){throw new d(a.ENOTSUP)},Z.prototype.createFile=function(e,t,r,n){throw new d(a.ENOTSUP)},Z.prototype.open=function(e,t,r,n){var i=this;this.stat(e,!1,(function(o,s){if(o)switch(t.pathNotExistsAction()){case p.CREATE_FILE:return i.stat(u.dirname(e),!1,(function(o,a){o?n(o):a&&!a.isDirectory()?n(d.ENOTDIR(u.dirname(e))):i.createFile(e,t,r,n)}));case p.THROW_EXCEPTION:return n(d.ENOENT(e));default:return n(new d(a.EINVAL,"Invalid FileFlag object."))}else{if(s&&s.isDirectory())return n(d.EISDIR(e));switch(t.pathExistsAction()){case p.THROW_EXCEPTION:return n(d.EEXIST(e));case p.TRUNCATE_FILE:return i.openFile(e,t,(function(e,t){e?n(e):t?t.truncate(0,(function(){t.sync((function(){n(null,t)}))})):M()}));case p.NOP:return i.openFile(e,t,n);default:return n(new d(a.EINVAL,"Invalid FileFlag object."))}}}))},Z.prototype.rename=function(e,t,r){r(new d(a.ENOTSUP))},Z.prototype.renameSync=function(e,t){throw new d(a.ENOTSUP)},Z.prototype.stat=function(e,t,r){r(new d(a.ENOTSUP))},Z.prototype.statSync=function(e,t){throw new d(a.ENOTSUP)},Z.prototype.openFileSync=function(e,t,r){throw new d(a.ENOTSUP)},Z.prototype.createFileSync=function(e,t,r){throw new d(a.ENOTSUP)},Z.prototype.openSync=function(e,t,r){var n;try{n=this.statSync(e,!1)}catch(i){switch(t.pathNotExistsAction()){case p.CREATE_FILE:if(!this.statSync(u.dirname(e),!1).isDirectory())throw d.ENOTDIR(u.dirname(e));return this.createFileSync(e,t,r);case p.THROW_EXCEPTION:throw d.ENOENT(e);default:throw new d(a.EINVAL,"Invalid FileFlag object.")}}if(n.isDirectory())throw d.EISDIR(e);switch(t.pathExistsAction()){case p.THROW_EXCEPTION:throw d.EEXIST(e);case p.TRUNCATE_FILE:return this.unlinkSync(e),this.createFileSync(e,t,n.mode);case p.NOP:return this.openFileSync(e,t,r);default:throw new d(a.EINVAL,"Invalid FileFlag object.")}},Z.prototype.unlink=function(e,t){t(new d(a.ENOTSUP))},Z.prototype.unlinkSync=function(e){throw new d(a.ENOTSUP)},Z.prototype.rmdir=function(e,t){t(new d(a.ENOTSUP))},Z.prototype.rmdirSync=function(e){throw new d(a.ENOTSUP)},Z.prototype.mkdir=function(e,t,r){r(new d(a.ENOTSUP))},Z.prototype.mkdirSync=function(e,t){throw new d(a.ENOTSUP)},Z.prototype.readdir=function(e,t){t(new d(a.ENOTSUP))},Z.prototype.readdirSync=function(e){throw new d(a.ENOTSUP)},Z.prototype.exists=function(e,t){this.stat(e,null,(function(e){t(!e)}))},Z.prototype.existsSync=function(e){try{return this.statSync(e,!0),!0}catch(t){return!1}},Z.prototype.realpath=function(e,t,r){if(this.supportsLinks())for(var n=e.split(u.sep),i=0;i<n.length;i++){var o=n.slice(0,i+1);n[i]=u.join.apply(null,o)}else this.exists(e,(function(t){t?r(null,e):r(d.ENOENT(e))}))},Z.prototype.realpathSync=function(e,t){if(this.supportsLinks()){for(var r=e.split(u.sep),n=0;n<r.length;n++){var i=r.slice(0,n+1);r[n]=u.join.apply(u,i)}return r.join(u.sep)}if(this.existsSync(e))return e;throw d.ENOENT(e)},Z.prototype.truncate=function(e,t,r){this.open(e,y.getFileFlag("r+"),420,(function(e,n){if(e)return r(e);n.truncate(t,(function(e){n.close((function(t){r(e||t)}))}))}))},Z.prototype.truncateSync=function(e,t){var r=this.openSync(e,y.getFileFlag("r+"),420);try{r.truncateSync(t)}catch(n){throw n}finally{r.closeSync()}},Z.prototype.readFile=function(t,r,n,i){var o=i;this.open(t,n,420,(function(t,n){if(t)return i(t);i=function(e,t){n.close((function(r){return e||(e=r),o(e,t)}))},n.stat((function(t,o){if(t)return i(t);var a=e.alloc(o.size);n.read(a,0,o.size,0,(function(e){if(e)return i(e);if(null===r)return i(e,a);try{i(null,a.toString(r))}catch(t){i(t)}}))}))}))},Z.prototype.readFileSync=function(t,r,n){var i=this.openSync(t,n,420);try{var o=i.statSync(),a=e.alloc(o.size);return i.readSync(a,0,o.size,0),i.closeSync(),null===r?a:a.toString(r)}finally{i.closeSync()}},Z.prototype.writeFile=function(t,r,n,i,o,a){var s=a;this.open(t,i,420,(function(t,i){if(t)return a(t);a=function(e){i.close((function(t){s(e||t)}))};try{"string"==typeof r&&(r=e.from(r,n))}catch(o){return a(o)}i.write(r,0,r.length,0,a)}))},Z.prototype.writeFileSync=function(t,r,n,i,o){var a=this.openSync(t,i,o);try{"string"==typeof r&&(r=e.from(r,n)),a.writeSync(r,0,r.length,0)}finally{a.closeSync()}},Z.prototype.appendFile=function(t,r,n,i,o,a){var s=a;this.open(t,i,o,(function(t,i){if(t)return a(t);a=function(e){i.close((function(t){s(e||t)}))},"string"==typeof r&&(r=e.from(r,n)),i.write(r,0,r.length,null,a)}))},Z.prototype.appendFileSync=function(t,r,n,i,o){var a=this.openSync(t,i,o);try{"string"==typeof r&&(r=e.from(r,n)),a.writeSync(r,0,r.length,null)}finally{a.closeSync()}},Z.prototype.chmod=function(e,t,r,n){n(new d(a.ENOTSUP))},Z.prototype.chmodSync=function(e,t,r){throw new d(a.ENOTSUP)},Z.prototype.chown=function(e,t,r,n,i){i(new d(a.ENOTSUP))},Z.prototype.chownSync=function(e,t,r,n){throw new d(a.ENOTSUP)},Z.prototype.utimes=function(e,t,r,n){n(new d(a.ENOTSUP))},Z.prototype.utimesSync=function(e,t,r){throw new d(a.ENOTSUP)},Z.prototype.link=function(e,t,r){r(new d(a.ENOTSUP))},Z.prototype.linkSync=function(e,t){throw new d(a.ENOTSUP)},Z.prototype.symlink=function(e,t,r,n){n(new d(a.ENOTSUP))},Z.prototype.symlinkSync=function(e,t,r){throw new d(a.ENOTSUP)},Z.prototype.readlink=function(e,t){t(new d(a.ENOTSUP))},Z.prototype.readlinkSync=function(e){throw new d(a.ENOTSUP)};var J=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.supportsSynch=function(){return!0},t.prototype.rename=function(e,t,r){try{this.renameSync(e,t),r()}catch(n){r(n)}},t.prototype.stat=function(e,t,r){try{r(null,this.statSync(e,t))}catch(n){r(n)}},t.prototype.open=function(e,t,r,n){try{n(null,this.openSync(e,t,r))}catch(i){n(i)}},t.prototype.unlink=function(e,t){try{this.unlinkSync(e),t()}catch(r){t(r)}},t.prototype.rmdir=function(e,t){try{this.rmdirSync(e),t()}catch(r){t(r)}},t.prototype.mkdir=function(e,t,r){try{this.mkdirSync(e,t),r()}catch(n){r(n)}},t.prototype.readdir=function(e,t){try{t(null,this.readdirSync(e))}catch(r){t(r)}},t.prototype.chmod=function(e,t,r,n){try{this.chmodSync(e,t,r),n()}catch(i){n(i)}},t.prototype.chown=function(e,t,r,n,i){try{this.chownSync(e,t,r,n),i()}catch(o){i(o)}},t.prototype.utimes=function(e,t,r,n){try{this.utimesSync(e,t,r),n()}catch(i){n(i)}},t.prototype.link=function(e,t,r){try{this.linkSync(e,t),r()}catch(n){r(n)}},t.prototype.symlink=function(e,t,r,n){try{this.symlinkSync(e,t,r),n()}catch(i){n(i)}},t.prototype.readlink=function(e,t){try{t(null,this.readlinkSync(e))}catch(r){t(r)}},t}(Z),Q=function(){};Q.prototype.sync=function(e){e(new d(a.ENOTSUP))},Q.prototype.syncSync=function(){throw new d(a.ENOTSUP)},Q.prototype.datasync=function(e){this.sync(e)},Q.prototype.datasyncSync=function(){return this.syncSync()},Q.prototype.chown=function(e,t,r){r(new d(a.ENOTSUP))},Q.prototype.chownSync=function(e,t){throw new d(a.ENOTSUP)},Q.prototype.chmod=function(e,t){t(new d(a.ENOTSUP))},Q.prototype.chmodSync=function(e){throw new d(a.ENOTSUP)},Q.prototype.utimes=function(e,t,r){r(new d(a.ENOTSUP))},Q.prototype.utimesSync=function(e,t){throw new d(a.ENOTSUP)};var ee=function(t){function r(e,r,n,i,o){if(t.call(this),this._pos=0,this._dirty=!1,this._fs=e,this._path=r,this._flag=n,this._stat=i,this._buffer=o||G(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.getBuffer=function(){return this._buffer},r.prototype.getStats=function(){return this._stat},r.prototype.getFlag=function(){return this._flag},r.prototype.getPath=function(){return this._path},r.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},r.prototype.advancePos=function(e){return this._pos+=e},r.prototype.setPos=function(e){return this._pos=e},r.prototype.sync=function(e){try{this.syncSync(),e()}catch(t){e(t)}},r.prototype.syncSync=function(){throw new d(a.ENOTSUP)},r.prototype.close=function(e){try{this.closeSync(),e()}catch(t){e(t)}},r.prototype.closeSync=function(){throw new d(a.ENOTSUP)},r.prototype.stat=function(e){try{e(null,this._stat.clone())}catch(t){e(t)}},r.prototype.statSync=function(){return this._stat.clone()},r.prototype.truncate=function(e,t){try{this.truncateSync(e),this._flag.isSynchronous()&&!A.getRootFS().supportsSynch()&&this.sync(t),t()}catch(r){return t(r)}},r.prototype.truncateSync=function(t){if(this._dirty=!0,!this._flag.isWriteable())throw new d(a.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,t>this._buffer.length){var r=e.alloc(t-this._buffer.length,0);return this.writeSync(r,0,r.length,this._buffer.length),void(this._flag.isSynchronous()&&A.getRootFS().supportsSynch()&&this.syncSync())}this._stat.size=t;var n=e.alloc(t);this._buffer.copy(n,0,0,t),this._buffer=n,this._flag.isSynchronous()&&A.getRootFS().supportsSynch()&&this.syncSync()},r.prototype.write=function(e,t,r,n,i){try{i(null,this.writeSync(e,t,r,n),e)}catch(o){i(o)}},r.prototype.writeSync=function(t,r,n,i){if(this._dirty=!0,null==i&&(i=this.getPos()),!this._flag.isWriteable())throw new d(a.EPERM,"File not opened with a writeable mode.");var o=i+n;if(o>this._stat.size&&(this._stat.size=o,o>this._buffer.length)){var s=e.alloc(o);this._buffer.copy(s),this._buffer=s}var c=t.copy(this._buffer,i,r,r+n);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),c):(this.setPos(i+c),c)},r.prototype.read=function(e,t,r,n,i){try{i(null,this.readSync(e,t,r,n),e)}catch(o){i(o)}},r.prototype.readSync=function(e,t,r,n){if(!this._flag.isReadable())throw new d(a.EPERM,"File not opened with a readable mode.");null==n&&(n=this.getPos()),n+r>this._stat.size&&(r=this._stat.size-n);var i=this._buffer.copy(e,t,n,n+r);return this._stat.atime=new Date,this._pos=n+r,i},r.prototype.chmod=function(e,t){try{this.chmodSync(e),t()}catch(r){t(r)}},r.prototype.chmodSync=function(e){if(!this._fs.supportsProps())throw new d(a.ENOTSUP);this._dirty=!0,this._stat.chmod(e),this.syncSync()},r.prototype.isDirty=function(){return this._dirty},r.prototype.resetDirty=function(){this._dirty=!1},r}(Q),te=function(e){function t(t,r,n,i,o){e.call(this,t,r,n,i,o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.close=function(e){e()},t.prototype.closeSync=function(){},t}(ee),re=function(e){function t(t,r,n,i,o){e.call(this,t,r,n,i,o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(ee),ne=function(e){function t(r,n,i){if(void 0===i&&(i=!0),e.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=r,this._async=n,!r.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");O(i,t.Name,{sync:"sync file system instance",async:"async file system instance"})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{var n=new t(e.sync,e.async,!1);n.initialize((function(e){e?r(e):r(null,n)}),!1)}catch(i){r(i)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){return t.Name},t.prototype._syncSync=function(e){this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,y.getFileFlag("w"),e.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),e.getStats().mode]})},t.prototype.initialize=function(e,t){var r=this;void 0===t&&(t=!0),t&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var n=this._initializeCallbacks;if(this._isInitialized)e();else if(1===n.push(e)){var i=function(e,t,n){"/"!==e&&r._sync.mkdirSync(e,t),r._async.readdir(e,(function(t,r){var i=0;t?n(t):function t(a){a?n(a):i<r.length?(o(u.join(e,r[i]),t),i++):n()}()}))},o=function(e,t){r._async.stat(e,!1,(function(n,o){n?t(n):o.isDirectory()?i(e,o.mode,t):function(e,t,n){r._async.readFile(e,null,y.getFileFlag("r"),(function(i,o){if(i)n(i);else try{r._sync.writeFileSync(e,o,null,y.getFileFlag("w"),t)}catch(a){i=a}finally{n(i)}}))}(e,o.mode,t)}))};i("/",0,(function(e){r._isInitialized=!e,r._initializeCallbacks=[],n.forEach((function(t){return t(e)}))}))}},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},t.prototype.renameSync=function(e,t){this.checkInitialized(),this._sync.renameSync(e,t),this.enqueueOp({apiMethod:"rename",arguments:[e,t]})},t.prototype.statSync=function(e,t){return this.checkInitialized(),this._sync.statSync(e,t)},t.prototype.openSync=function(e,t,r){return this.checkInitialized(),this._sync.openSync(e,t,r).closeSync(),new re(this,e,t,this._sync.statSync(e,!1),this._sync.readFileSync(e,null,y.getFileFlag("r")))},t.prototype.unlinkSync=function(e){this.checkInitialized(),this._sync.unlinkSync(e),this.enqueueOp({apiMethod:"unlink",arguments:[e]})},t.prototype.rmdirSync=function(e){this.checkInitialized(),this._sync.rmdirSync(e),this.enqueueOp({apiMethod:"rmdir",arguments:[e]})},t.prototype.mkdirSync=function(e,t){this.checkInitialized(),this._sync.mkdirSync(e,t),this.enqueueOp({apiMethod:"mkdir",arguments:[e,t]})},t.prototype.readdirSync=function(e){return this.checkInitialized(),this._sync.readdirSync(e)},t.prototype.existsSync=function(e){return this.checkInitialized(),this._sync.existsSync(e)},t.prototype.chmodSync=function(e,t,r){this.checkInitialized(),this._sync.chmodSync(e,t,r),this.enqueueOp({apiMethod:"chmod",arguments:[e,t,r]})},t.prototype.chownSync=function(e,t,r,n){this.checkInitialized(),this._sync.chownSync(e,t,r,n),this.enqueueOp({apiMethod:"chown",arguments:[e,t,r,n]})},t.prototype.utimesSync=function(e,t,r){this.checkInitialized(),this._sync.utimesSync(e,t,r),this.enqueueOp({apiMethod:"utimes",arguments:[e,t,r]})},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new d(a.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},t.prototype.enqueueOp=function(e){var t=this;if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;var r=function(e){if(e&&console.error("WARNING: File system has desynchronized. Received following error: "+e+"\n$"),t._queue.length>0){var n=t._queue.shift(),i=n.arguments;i.push(r),t._async[n.apiMethod].apply(t._async,i)}else t._queueRunning=!1};r()}},t}(J);function ie(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}ne.Name="AsyncMirror",ne.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};var oe=Math.max;function ae(e){return e}function se(e,t){return function(e,t,r){return t=oe(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=oe(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),ie(e,this,s)}}(e,t,ae)}var ce=function(e){return se((function(t){var r=t.pop();e.call(this,t,r)}))};function ue(e){return se((function(t,r){var n=ce((function(r,n){var i=this;return e(t,(function(e,t){e.apply(i,r.concat(t))}),n)}));return r.length?n.apply(this,r):n}))}var le="object"==typeof n&&n&&n.Object===Object&&n,pe="object"==typeof self&&self&&self.Object===Object&&self,fe=le||pe||Function("return this")(),de=fe.Symbol,he=Object.prototype,me=he.hasOwnProperty,ge=he.toString,ye=de?de.toStringTag:void 0,ve=Object.prototype.toString,_e=de?de.toStringTag:void 0;function be(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_e&&_e in Object(e)?function(e){var t=me.call(e,ye),r=e[ye];try{e[ye]=void 0;var n=!0}catch(o){}var i=ge.call(e);return n&&(t?e[ye]=r:delete e[ye]),i}(e):function(e){return ve.call(e)}(e)}function we(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Te(e){return null!=e&&we(e.length)&&!function(e){if(!function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}(e))return!1;var t=be(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)}var ke={};function Ee(){}function Se(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var Ie="function"==typeof Symbol&&Symbol.iterator;function Pe(e){return null!=e&&"object"==typeof e}function Ae(e){return Pe(e)&&"[object Arguments]"==be(e)}var Ce=Object.prototype,Fe=Ce.hasOwnProperty,De=Ce.propertyIsEnumerable,Oe=Ae(function(){return arguments}())?Ae:function(e){return Pe(e)&&Fe.call(e,"callee")&&!De.call(e,"callee")},xe=Array.isArray,Re="object"==typeof t&&t&&!t.nodeType&&t,Me=Re&&"object"==typeof i&&i&&!i.nodeType&&i,Ne=Me&&Me.exports===Re?fe.Buffer:void 0,$e=(Ne?Ne.isBuffer:void 0)||function(){return!1},Be=/^(?:0|[1-9]\d*)$/;function Le(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||Be.test(e))&&e>-1&&e%1==0&&e<t}var Ue={};Ue["[object Float32Array]"]=Ue["[object Float64Array]"]=Ue["[object Int8Array]"]=Ue["[object Int16Array]"]=Ue["[object Int32Array]"]=Ue["[object Uint8Array]"]=Ue["[object Uint8ClampedArray]"]=Ue["[object Uint16Array]"]=Ue["[object Uint32Array]"]=!0,Ue["[object Arguments]"]=Ue["[object Array]"]=Ue["[object ArrayBuffer]"]=Ue["[object Boolean]"]=Ue["[object DataView]"]=Ue["[object Date]"]=Ue["[object Error]"]=Ue["[object Function]"]=Ue["[object Map]"]=Ue["[object Number]"]=Ue["[object Object]"]=Ue["[object RegExp]"]=Ue["[object Set]"]=Ue["[object String]"]=Ue["[object WeakMap]"]=!1;var ze,je="object"==typeof t&&t&&!t.nodeType&&t,He=je&&"object"==typeof i&&i&&!i.nodeType&&i,Ge=He&&He.exports===je&&le.process,Ve=function(){try{return Ge&&Ge.binding&&Ge.binding("util")}catch(e){}}(),We=Ve&&Ve.isTypedArray,Xe=We?(ze=We,function(e){return ze(e)}):function(e){return Pe(e)&&we(e.length)&&!!Ue[be(e)]},qe=Object.prototype.hasOwnProperty;function Ye(e,t){var r=xe(e),n=!r&&Oe(e),i=!r&&!n&&$e(e),o=!r&&!n&&!i&&Xe(e),a=r||n||i||o,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var u in e)!t&&!qe.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Le(u,c))||s.push(u);return s}var Ke=Object.prototype,Ze=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Je=Object.prototype.hasOwnProperty;function Qe(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||Ke))return Ze(e);var t,r,n=[];for(var i in Object(e))Je.call(e,i)&&"constructor"!=i&&n.push(i);return n}function et(e){var t,r=Te(t=e)?Ye(t):Qe(t),n=-1,i=r.length;return function(){var t=r[++n];return n<i?{value:e[t],key:t}:null}}function tt(e){if(Te(e))return function(e){var t=-1,r=e.length;return function(){return++t<r?{value:e[t],key:t}:null}}(e);var t=function(e){return Ie&&e[Ie]&&e[Ie]()}(e);return t?function(e){var t=-1;return function(){var r=e.next();return r.done?null:(t++,{value:r.value,key:t})}}(t):et(e)}function rt(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function nt(e){return function(t,r,n){if(n=Se(n||Ee),e<=0||!t)return n(null);var i=tt(t),o=!1,a=0;function s(e,t){if(a-=1,e)o=!0,n(e);else{if(t===ke||o&&a<=0)return o=!0,n(null);c()}}function c(){for(;a<e&&!o;){var t=i();if(null===t)return o=!0,void(a<=0&&n(null));a+=1,r(t.value,t.key,rt(s))}}c()}}function it(e,t,r,n){nt(t)(e,r,n)}function ot(e,t){return function(r,n,i){return e(r,t,n,i)}}function at(e,t,r){r=Se(r||Ee);var n=0,i=0,o=e.length;function a(e,t){e?r(e):++i!==o&&t!==ke||r(null)}for(0===o&&r(null);n<o;n++)t(e[n],n,rt(a))}var st,ct=ot(it,1/0),ut=function(e,t,r){(Te(e)?at:ct)(e,t,r)};function lt(e,t,r,n){n=n||Ee;var i=[],o=0;e(t=t||[],(function(e,t,n){var a=o++;r(e,(function(e,t){i[a]=t,n(e)}))}),(function(e){n(e,i)}))}ue((st=lt,function(e,t,r){return st(ut,e,t,r)})),ue(ot(function(e){return function(t,r,n,i){return e(nt(r),t,n,i)}}(lt),1)),se((function(e,t){return se((function(r){return e.apply(null,t.concat(r))}))}));var pt="function"==typeof setImmediate&&setImmediate,ft="object"==typeof o&&"function"==typeof o.nextTick;function dt(e){setTimeout(e,0)}function ht(e){return se((function(t,r){e((function(){t.apply(null,r)}))}))}ht(pt?setImmediate:ft?o.nextTick:dt);var mt,gt=ot(it,1),yt=se((function(e){return se((function(t){var r,n,i,o,a=this,s=t[t.length-1];"function"==typeof s?t.pop():s=Ee,r=e,n=t,i=function(e,t,r){t.apply(a,e.concat(se((function(e,t){r(e,t)}))))},o=Se((o=function(e,t){s.apply(a,[e].concat(t))})||Ee),gt(r,(function(e,t,r){i(n,e,(function(e,t){n=t,r(e)}))}),(function(e){o(e,n)}))}))}));function vt(e){return se((function(t,r){t.apply(null,r.concat(se((function(t,r){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););}(r,(function(t){console[e](t)})))}))))}))}function _t(e,t,r){ut(e,function(e){return function(t,r,n){return e(t,n)}}(t),r)}se((function(e){return yt.apply(null,e.reverse())})),se((function(e){var t=[null].concat(e);return ce((function(e,r){return r.apply(this,t)}))})),vt("dir"),vt("log"),ht(ft?o.nextTick:pt?setImmediate:dt);var bt=function(e){this._cache={},this._client=e};bt.prototype.readdir=function(e,t){var r=this,n=this.getCachedDirInfo(e);this._wrap((function(t){null!==n&&n.contents?r._client.readdir(e,{contentHash:n.stat.contentHash},t):r._client.readdir(e,t)}),(function(i,o,a,s){i?i.status===Dropbox.ApiError.NO_CONTENT&&null!==n?t(null,n.contents.slice(0)):t(i):(r.updateCachedDirInfo(e,a,o.slice(0)),s.forEach((function(t){r.updateCachedInfo(u.join(e,t.name),t)})),t(null,o))}))},bt.prototype.remove=function(e,t){var r=this;this._wrap((function(t){r._client.remove(e,t)}),(function(n,i){n||r.updateCachedInfo(e,i),t(n)}))},bt.prototype.move=function(e,t,r){var n=this;this._wrap((function(r){n._client.move(e,t,r)}),(function(i,o){i||(n.deleteCachedInfo(e),n.updateCachedInfo(t,o)),r(i)}))},bt.prototype.stat=function(e,t){var r=this;this._wrap((function(t){r._client.stat(e,t)}),(function(n,i){n||r.updateCachedInfo(e,i),t(n,i)}))},bt.prototype.readFile=function(e,t){var r=this,n=this.getCachedFileInfo(e);null!==n&&null!==n.contents?this.stat(e,(function(i,o){i?t(i):o.contentHash===n.stat.contentHash?t(i,n.contents.slice(0),n.stat):r.readFile(e,t)})):this._wrap((function(t){r._client.readFile(e,{arrayBuffer:!0},t)}),(function(n,i,o){n||r.updateCachedInfo(e,o,i.slice(0)),t(n,i,o)}))},bt.prototype.writeFile=function(e,t,r){var n=this;this._wrap((function(r){n._client.writeFile(e,t,r)}),(function(i,o){i||n.updateCachedInfo(e,o,t.slice(0)),r(i,o)}))},bt.prototype.mkdir=function(e,t){var r=this;this._wrap((function(t){r._client.mkdir(e,t)}),(function(n,i){n||r.updateCachedInfo(e,i,[]),t(n)}))},bt.prototype._wrap=function(e,t){var r=0,n=function(i){var o=2;if(i&&3>++r)switch(i.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout((function(){e(n)}),1e3*o);break;default:t.apply(null,arguments)}else t.apply(null,arguments)};e(n)},bt.prototype.getCachedInfo=function(e){return this._cache[e.toLowerCase()]},bt.prototype.putCachedInfo=function(e,t){this._cache[e.toLowerCase()]=t},bt.prototype.deleteCachedInfo=function(e){delete this._cache[e.toLowerCase()]},bt.prototype.getCachedDirInfo=function(e){var t,r=this.getCachedInfo(e);return(t=r)&&t.stat.isFolder?r:null},bt.prototype.getCachedFileInfo=function(e){var t,r=this.getCachedInfo(e);return(t=r)&&t.stat.isFile?r:null},bt.prototype.updateCachedDirInfo=function(e,t,r){void 0===r&&(r=null);var n=this.getCachedInfo(e);null===t.contentHash||void 0!==n&&n.stat.contentHash===t.contentHash||this.putCachedInfo(e,{stat:t,contents:r})},bt.prototype.updateCachedFileInfo=function(e,t,r){void 0===r&&(r=null);var n=this.getCachedInfo(e);null===t.versionTag||void 0!==n&&n.stat.versionTag===t.versionTag||this.putCachedInfo(e,{stat:t,contents:r})},bt.prototype.updateCachedInfo=function(e,t,r){var n;void 0===r&&(r=null),t.isFile&&(null==(n=r)||"object"==typeof n&&"number"==typeof n.byteLength)?this.updateCachedFileInfo(e,t,r):t.isFolder&&Array.isArray(r)&&this.updateCachedDirInfo(e,t,r)};var wt=function(e){function t(t,r,n,i,o){e.call(this,t,r,n,i,o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var t=this;if(this.isDirty()){var r=$(this.getBuffer());this._fs._writeFileStrict(this.getPath(),r,(function(r){r||t.resetDirty(),e(r)}))}else e()},t.prototype.close=function(e){this.sync(e)},t}(ee),Tt=function(e){function t(r,n){void 0===n&&(n=!0),e.call(this),this._client=new bt(r),O(n,t.Name,{client:"authenticated dropbox client instance"}),mt||((mt={})[Dropbox.ApiError.NETWORK_ERROR]=a.EIO,mt[Dropbox.ApiError.INVALID_PARAM]=a.EINVAL,mt[Dropbox.ApiError.INVALID_TOKEN]=a.EPERM,mt[Dropbox.ApiError.OAUTH_ERROR]=a.EPERM,mt[Dropbox.ApiError.NOT_FOUND]=a.ENOENT,mt[Dropbox.ApiError.INVALID_METHOD]=a.EINVAL,mt[Dropbox.ApiError.NOT_ACCEPTABLE]=a.EINVAL,mt[Dropbox.ApiError.CONFLICT]=a.EINVAL,mt[Dropbox.ApiError.RATE_LIMITED]=a.EBUSY,mt[Dropbox.ApiError.SERVER_ERROR]=a.EBUSY,mt[Dropbox.ApiError.OVER_QUOTA]=a.ENOSPC)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.client,!1))},t.isAvailable=function(){return"undefined"!=typeof Dropbox},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var t=this;this._client.readdir("/",(function(r,n){r?e(t.convert(r,"/")):_t(n,(function(e,r){var n=u.join("/",e);t._client.remove(n,(function(e){r(e?t.convert(e,n):null)}))}),(function(t){t?e(t):e()}))}))},t.prototype.rename=function(e,t,r){var n=this;this._client.move(e,t,(function(i){i?n._client.stat(t,(function(o,a){if(o||a.isFolder){var s=i.response.error.indexOf(e)>-1?e:t;r(n.convert(i,s))}else n._client.remove(t,(function(i){i?r(n.convert(i,t)):n.rename(e,t,r)}))})):r()}))},t.prototype.stat=function(e,t,r){var n=this;this._client.stat(e,(function(t,i){if(t)r(n.convert(t,e));else{if(!i||!i.isRemoved){var o=new v(n._statType(i),i.size);return r(null,o)}r(d.FileError(a.ENOENT,e))}}))},t.prototype.open=function(e,t,r,n){var i=this;this._client.readFile(e,(function(r,o,a){if(!r){var s;s=null===o?G():z(o);var c=i._makeFile(e,t,a,s);return n(null,c)}if(t.isReadable())n(i.convert(r,e));else switch(r.status){case Dropbox.ApiError.NOT_FOUND:var u=new ArrayBuffer(0);return i._writeFileStrict(e,u,(function(r,o){if(r)n(r);else{var a=i._makeFile(e,t,o,z(u));n(null,a)}}));default:return n(i.convert(r,e))}}))},t.prototype._writeFileStrict=function(e,t,r){var n=this,i=u.dirname(e);this.stat(i,!1,(function(o,s){o?r(d.FileError(a.ENOENT,i)):n._client.writeFile(e,t,(function(t,i){t?r(n.convert(t,e)):r(null,i)}))}))},t.prototype._statType=function(e){return e.isFile?m.FILE:m.DIRECTORY},t.prototype._makeFile=function(e,t,r,n){var i=this._statType(r),o=new v(i,r.size);return new wt(this,e,t,o,n)},t.prototype._remove=function(e,t,r){var n=this;this._client.stat(e,(function(i,o){i?t(n.convert(i,e)):o.isFile&&!r?t(d.FileError(a.ENOTDIR,e)):!o.isFile&&r?t(d.FileError(a.EISDIR,e)):n._client.remove(e,(function(r){t(r?n.convert(r,e):null)}))}))},t.prototype.unlink=function(e,t){this._remove(e,t,!0)},t.prototype.rmdir=function(e,t){this._remove(e,t,!1)},t.prototype.mkdir=function(e,t,r){var n=this,i=u.dirname(e);this._client.stat(i,(function(t,o){t?r(n.convert(t,i)):n._client.mkdir(e,(function(t){r(t?d.FileError(a.EEXIST,e):null)}))}))},t.prototype.readdir=function(e,t){var r=this;this._client.readdir(e,(function(e,n){return e?t(r.convert(e)):t(null,n)}))},t.prototype.convert=function(e,t){void 0===t&&(t=null);var r=mt[e.status];return void 0===r&&(r=a.EIO),t?d.FileError(r,t):new d(r)},t}(Z);function kt(e,t){void 0===t&&(t="");for(var r=e.errno,n=e.node,i=[];n&&(i.unshift(n.name),n!==n.parent);)n=n.parent;return new d(r,l[r],i.length>0?"/"+i.join("/"):t)}Tt.Name="Dropbox",Tt.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(e,t){e.isAuthenticated&&e.isAuthenticated()?t():t(new d(a.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};var Et=function(e){function t(t,r,n,i){e.call(this),this._fs=t,this._FS=r,this._path=n,this._stream=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getPos=function(){},t.prototype.close=function(e){var t=null;try{this.closeSync()}catch(r){t=r}finally{e(t)}},t.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(e){throw kt(e,this._path)}},t.prototype.stat=function(e){try{e(null,this.statSync())}catch(t){e(t)}},t.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(e){throw kt(e,this._path)}},t.prototype.truncate=function(e,t){var r=null;try{this.truncateSync(e)}catch(n){r=n}finally{t(r)}},t.prototype.truncateSync=function(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(t){throw kt(t,this._path)}},t.prototype.write=function(e,t,r,n,i){try{i(null,this.writeSync(e,t,r,n),e)}catch(o){i(o)}},t.prototype.writeSync=function(e,t,r,n){try{var i=B(e),o=null===n?void 0:n;return this._FS.write(this._stream,i,t,r,o)}catch(a){throw kt(a,this._path)}},t.prototype.read=function(e,t,r,n,i){try{i(null,this.readSync(e,t,r,n),e)}catch(o){i(o)}},t.prototype.readSync=function(e,t,r,n){try{var i=B(e),o=null===n?void 0:n;return this._FS.read(this._stream,i,t,r,o)}catch(a){throw kt(a,this._path)}},t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.chown=function(e,t,r){var n=null;try{this.chownSync(e,t)}catch(i){n=i}finally{r(n)}},t.prototype.chownSync=function(e,t){try{this._FS.fchown(this._stream.fd,e,t)}catch(r){throw kt(r,this._path)}},t.prototype.chmod=function(e,t){var r=null;try{this.chmodSync(e)}catch(n){r=n}finally{t(r)}},t.prototype.chmodSync=function(e){try{this._FS.fchmod(this._stream.fd,e)}catch(t){throw kt(t,this._path)}},t.prototype.utimes=function(e,t,r){var n=null;try{this.utimesSync(e,t)}catch(i){n=i}finally{r(n)}},t.prototype.utimesSync=function(e,t){this._fs.utimesSync(this._path,e,t)},t}(Q),St=function(t){function r(e){t.call(this),this._FS=e}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.Create=function(e,t){t(null,new r(e.FS))},r.isAvailable=function(){return!0},r.prototype.getName=function(){return this._FS.DB_NAME()},r.prototype.isReadOnly=function(){return!1},r.prototype.supportsLinks=function(){return!0},r.prototype.supportsProps=function(){return!0},r.prototype.supportsSynch=function(){return!0},r.prototype.renameSync=function(e,t){try{this._FS.rename(e,t)}catch(r){throw r.errno===a.ENOENT?kt(r,this.existsSync(e)?t:e):kt(r)}},r.prototype.statSync=function(e,t){try{var r=t?this._FS.lstat(e):this._FS.stat(e),n=this.modeToFileType(r.mode);return new v(n,r.size,r.mode,r.atime,r.mtime,r.ctime)}catch(i){throw kt(i,e)}},r.prototype.openSync=function(e,t,r){try{var n=this._FS.open(e,t.getFlagString(),r);if(this._FS.isDir(n.node.mode))throw this._FS.close(n),d.EISDIR(e);return new Et(this,this._FS,e,n)}catch(i){throw kt(i,e)}},r.prototype.unlinkSync=function(e){try{this._FS.unlink(e)}catch(t){throw kt(t,e)}},r.prototype.rmdirSync=function(e){try{this._FS.rmdir(e)}catch(t){throw kt(t,e)}},r.prototype.mkdirSync=function(e,t){try{this._FS.mkdir(e,t)}catch(r){throw kt(r,e)}},r.prototype.readdirSync=function(e){try{return this._FS.readdir(e).filter((function(e){return"."!==e&&".."!==e}))}catch(t){throw kt(t,e)}},r.prototype.truncateSync=function(e,t){try{this._FS.truncate(e,t)}catch(r){throw kt(r,e)}},r.prototype.readFileSync=function(e,t,r){try{var n=U(this._FS.readFile(e,{flags:r.getFlagString()}));return t?n.toString(t):n}catch(i){throw kt(i,e)}},r.prototype.writeFileSync=function(t,r,n,i,o){try{n&&(r=e.from(r,n));var a=B(r);this._FS.writeFile(t,a,{flags:i.getFlagString(),encoding:"binary"}),this._FS.chmod(t,o)}catch(s){throw kt(s,t)}},r.prototype.chmodSync=function(e,t,r){try{t?this._FS.lchmod(e,r):this._FS.chmod(e,r)}catch(n){throw kt(n,e)}},r.prototype.chownSync=function(e,t,r,n){try{t?this._FS.lchown(e,r,n):this._FS.chown(e,r,n)}catch(i){throw kt(i,e)}},r.prototype.symlinkSync=function(e,t,r){try{this._FS.symlink(e,t)}catch(n){throw kt(n)}},r.prototype.readlinkSync=function(e){try{return this._FS.readlink(e)}catch(t){throw kt(t,e)}},r.prototype.utimesSync=function(e,t,r){try{this._FS.utime(e,t.getTime(),r.getTime())}catch(n){throw kt(n,e)}},r.prototype.modeToFileType=function(e){if(this._FS.isDir(e))return m.DIRECTORY;if(this._FS.isFile(e))return m.FILE;if(this._FS.isLink(e))return m.SYMLINK;throw d.EPERM("Invalid mode: "+e)},r}(J);St.Name="EmscriptenFileSystem",St.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var It=function(e){function t(t,r){e.call(this),this._folder=t,this._wrapped=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.folder,e.wrapped))},t.isAvailable=function(){return!0},t.prototype.initialize=function(e){var t=this;this._wrapped.exists(this._folder,(function(r){r?e():t._wrapped.isReadOnly()?e(d.ENOENT(t._folder)):t._wrapped.mkdir(t._folder,511,e)}))},t.prototype.getName=function(){return this._wrapped.getName()},t.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},t.prototype.supportsProps=function(){return this._wrapped.supportsProps()},t.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t}(Z);function Pt(e,t){if(null!==t&&"object"==typeof t){var r=t,n=r.path;n&&(n="/"+u.relative(e,n),r.message=r.message.replace(r.path,n),r.path=n)}return t}function At(e,t){return"function"==typeof t?function(r){arguments.length>0&&(arguments[0]=Pt(e,r)),t.apply(null,arguments)}:t}function Ct(e,t,r){return"Sync"!==e.slice(e.length-4)?function(){return arguments.length>0&&(t&&(arguments[0]=u.join(this._folder,arguments[0])),r&&(arguments[1]=u.join(this._folder,arguments[1])),arguments[arguments.length-1]=At(this._folder,arguments[arguments.length-1])),this._wrapped[e].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=u.join(this._folder,arguments[0])),r&&(arguments[1]=u.join(this._folder,arguments[1])),this._wrapped[e].apply(this._wrapped,arguments)}catch(n){throw Pt(this._folder,n)}}}It.Name="FolderAdapter",It.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}},["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach((function(e){It.prototype[e]=Ct(e,!0,!1)})),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach((function(e){It.prototype[e]=Ct(e,!0,!0)}));var Ft="undefined"!=typeof window?window:"undefined"!=typeof self?self:n,Dt=Ft.webkitRequestFileSystem||Ft.requestFileSystem||null;function Ot(e,t,r){switch(e.name){case"PathExistsError":return d.EEXIST(t);case"QuotaExceededError":return d.FileError(a.ENOSPC,t);case"NotFoundError":return d.ENOENT(t);case"SecurityError":return d.FileError(a.EACCES,t);case"InvalidModificationError":return d.FileError(a.EPERM,t);case"TypeMismatchError":return d.FileError(r?a.ENOTDIR:a.EISDIR,t);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return d.FileError(a.EINVAL,t)}}var xt=function(e){function t(t,r,n,i,o,a){e.call(this,t,n,i,o,a),this._entry=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var t=this;if(!this.isDirty())return e();this._entry.createWriter((function(r){var n=t.getBuffer(),i=new Blob([$(n)]),o=i.size;r.onwriteend=function(n){r.onwriteend=null,r.onerror=null,r.truncate(o),t.resetDirty(),e()},r.onerror=function(r){e(Ot(r,t.getPath(),!1))},r.write(i)}))},t.prototype.close=function(e){this.sync(e)},t}(ee),Rt=function(e){function t(r,n,i){void 0===r&&(r=5),void 0===n&&(n=Ft.PERSISTENT),void 0===i&&(i=!0),e.call(this),this.size=1048576*r,this.type=n,O(i,t.Name,{size:r,type:n})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){var n=new t(e.size,e.type,!1);n.allocate((function(e){return e?r(e):r(null,n)}),!1)},t.isAvailable=function(){return!!Dt},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.allocate=function(e,t){var r=this;void 0===e&&(e=function(){}),void 0===t&&(t=!0),t&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var n=function(t){r.fs=t,e()},i=function(t){e(Ot(t,"/",!0))};this.type===Ft.PERSISTENT?function(e,t,r,n){if(void 0!==navigator.webkitPersistentStorage)switch(e){case Ft.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(t,r,n);break;case Ft.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(t,r,n);break;default:n(new TypeError("Invalid storage type: "+e))}else Ft.webkitStorageInfo.requestQuota(e,t,r,n)}(this.type,this.size,(function(e){Dt(r.type,e,n,i)}),i):Dt(this.type,this.size,n,i)},t.prototype.empty=function(e){this._readdir("/",(function(t,r){t?(console.error("Failed to empty FS"),e(t)):_t(r,(function(e,t){var r=function(){t()},n=function(r){t(Ot(r,e.fullPath,!e.isDirectory))};!function(e){return e.isDirectory}(e)?e.remove(r,n):e.removeRecursively(r,n)}),(function(r){t?(console.error("Failed to empty FS"),e(t)):e()}))}))},t.prototype.rename=function(e,t,r){var n=this,i=2,o=0,s=this.fs.root,c=e,l=function(e){--i<=0&&r(Ot(e,c,!1))},p=function(i){return 2==++o?r(new d(a.EINVAL,"Something was identified as both a file and a directory. This should never happen.")):e===t?r():(c=u.dirname(t),void s.getDirectory(c,{},(function(o){c=u.basename(t),i.moveTo(o,c,(function(e){r()}),(function(o){i.isDirectory?(c=t,n.unlink(t,(function(i){i?l(o):n.rename(e,t,r)}))):l(o)}))}),l))};s.getFile(e,{},p,l),s.getDirectory(e,{},p,l)},t.prototype.stat=function(e,t,r){var n=this,i={create:!1},o=function(e){var t=new v(m.DIRECTORY,4096);r(null,t)},a=function(t){r(Ot(t,e,!1))};this.fs.root.getFile(e,i,(function(e){e.file((function(e){var t=new v(m.FILE,e.size);r(null,t)}),a)}),(function(){n.fs.root.getDirectory(e,i,o,a)}))},t.prototype.open=function(e,t,r,n){var i=this,o=function(r){"InvalidModificationError"===r.name&&t.isExclusive()?n(d.EEXIST(e)):n(Ot(r,e,!1))};this.fs.root.getFile(e,{create:t.pathNotExistsAction()===p.CREATE_FILE,exclusive:t.isExclusive()},(function(r){r.file((function(a){var s=new FileReader;s.onloadend=function(o){var c=i._makeFile(e,r,t,a,s.result);n(null,c)},s.onerror=function(e){o(s.error)},s.readAsArrayBuffer(a)}),o)}),o)},t.prototype.unlink=function(e,t){this._remove(e,t,!0)},t.prototype.rmdir=function(e,t){var r=this;this.readdir(e,(function(n,i){n?t(n):i.length>0?t(d.ENOTEMPTY(e)):r._remove(e,t,!1)}))},t.prototype.mkdir=function(e,t,r){this.fs.root.getDirectory(e,{create:!0,exclusive:!0},(function(e){r()}),(function(t){r(Ot(t,e,!0))}))},t.prototype.readdir=function(e,t){this._readdir(e,(function(e,r){if(!r)return t(e);for(var n=[],i=0,o=r;i<o.length;i+=1){var a=o[i];n.push(a.name)}t(null,n)}))},t.prototype._makeFile=function(e,t,r,n,i){void 0===i&&(i=new ArrayBuffer(0));var o=new v(m.FILE,n.size),a=z(i);return new xt(this,t,e,r,o,a)},t.prototype._readdir=function(e,t){var r=function(r){t(Ot(r,e,!0))};this.fs.root.getDirectory(e,{create:!1},(function(e){var n=e.createReader(),i=[],o=function(){n.readEntries((function(e){var r;e.length?(i=i.concat((r=e,Array.prototype.slice.call(r||[],0))),o()):t(null,i)}),r)};o()}),r)},t.prototype._remove=function(e,t,r){var n=function(n){n.remove((function(){t()}),(function(n){t(Ot(n,e,!r))}))},i=function(n){t(Ot(n,e,!r))},o={create:!1};r?this.fs.root.getFile(e,o,n,i):this.fs.root.getDirectory(e,o,n,i)},t}(Z);Rt.Name="HTML5FS",Rt.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var Mt=function(e,t,r,n,i,o){this.id=e,this.size=t,this.mode=r,this.atime=n,this.mtime=i,this.ctime=o};Mt.fromBuffer=function(e){if(void 0===e)throw new Error("NO");return new Mt(e.toString("ascii",30),e.readUInt32LE(0),e.readUInt16LE(4),e.readDoubleLE(6),e.readDoubleLE(14),e.readDoubleLE(22))},Mt.prototype.toStats=function(){return new v((61440&this.mode)===m.DIRECTORY?m.DIRECTORY:m.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},Mt.prototype.getSize=function(){return 30+this.id.length},Mt.prototype.toBuffer=function(t){return void 0===t&&(t=e.alloc(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},Mt.prototype.update=function(e){var t=!1;this.size!==e.size&&(this.size=e.size,t=!0),this.mode!==e.mode&&(this.mode=e.mode,t=!0);var r=e.atime.getTime();this.atime!==r&&(this.atime=r,t=!0);var n=e.mtime.getTime();this.mtime!==n&&(this.mtime=n,t=!0);var i=e.ctime.getTime();return this.ctime!==i&&(this.ctime=i,t=!0),t},Mt.prototype.isFile=function(){return(61440&this.mode)===m.FILE},Mt.prototype.isDirectory=function(){return(61440&this.mode)===m.DIRECTORY};var Nt="/",$t=null;function Bt(){return $t||($t=e.from("{}"))}function Lt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function Ut(e,t){return!e||(t(e),!1)}function zt(e,t,r){return!e||(t.abort((function(){r(e)})),!1)}var jt=function(e){this.store=e,this.originalData={},this.modifiedKeys=[]};jt.prototype.get=function(e){var t=this.store.get(e);return this.stashOldValue(e,t),t},jt.prototype.put=function(e,t,r){return this.markModified(e),this.store.put(e,t,r)},jt.prototype.del=function(e){this.markModified(e),this.store.del(e)},jt.prototype.commit=function(){},jt.prototype.abort=function(){for(var e=this,t=0,r=e.modifiedKeys;t<r.length;t+=1){var n=r[t],i=e.originalData[n];i?e.store.put(n,i,!0):e.store.del(n)}},jt.prototype.stashOldValue=function(e,t){this.originalData.hasOwnProperty(e)||(this.originalData[e]=t)},jt.prototype.markModified=function(e){-1===this.modifiedKeys.indexOf(e)&&(this.modifiedKeys.push(e),this.originalData.hasOwnProperty(e)||(this.originalData[e]=this.store.get(e)))};var Ht=function(e){function t(t,r,n,i,o){e.call(this,t,r,n,i,o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(ee),Gt=function(t){function r(e){t.call(this),this.store=e.store,this.makeRootDirectory()}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.isAvailable=function(){return!0},r.prototype.getName=function(){return this.store.name()},r.prototype.isReadOnly=function(){return!1},r.prototype.supportsSymlinks=function(){return!1},r.prototype.supportsProps=function(){return!1},r.prototype.supportsSynch=function(){return!0},r.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},r.prototype.renameSync=function(t,r){var n=this.store.beginTransaction("readwrite"),i=u.dirname(t),o=u.basename(t),s=u.dirname(r),c=u.basename(r),l=this.findINode(n,i),p=this.getDirListing(n,i,l);if(!p[o])throw d.ENOENT(t);var f,h,m=p[o];if(delete p[o],0===(s+"/").indexOf(t+"/"))throw new d(a.EBUSY,i);if(s===i?(f=l,h=p):(f=this.findINode(n,s),h=this.getDirListing(n,s,f)),h[c]){var g=this.getINode(n,r,h[c]);if(!g.isFile())throw d.EPERM(r);try{n.del(g.id),n.del(h[c])}catch(y){throw n.abort(),y}}h[c]=m;try{n.put(l.id,e.from(JSON.stringify(p)),!0),n.put(f.id,e.from(JSON.stringify(h)),!0)}catch(y){throw n.abort(),y}n.commit()},r.prototype.statSync=function(e,t){return this.findINode(this.store.beginTransaction("readonly"),e).toStats()},r.prototype.createFileSync=function(e,t,r){var n=this.store.beginTransaction("readwrite"),i=G(),o=this.commitNewFile(n,e,m.FILE,r,i);return new Ht(this,e,t,o.toStats(),i)},r.prototype.openFileSync=function(e,t){var r=this.store.beginTransaction("readonly"),n=this.findINode(r,e),i=r.get(n.id);if(void 0===i)throw d.ENOENT(e);return new Ht(this,e,t,n.toStats(),i)},r.prototype.unlinkSync=function(e){this.removeEntry(e,!1)},r.prototype.rmdirSync=function(e){if(this.readdirSync(e).length>0)throw d.ENOTEMPTY(e);this.removeEntry(e,!0)},r.prototype.mkdirSync=function(t,r){var n=this.store.beginTransaction("readwrite"),i=e.from("{}");this.commitNewFile(n,t,m.DIRECTORY,r,i)},r.prototype.readdirSync=function(e){var t=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(t,e,this.findINode(t,e)))},r.prototype._syncSync=function(e,t,r){var n=this.store.beginTransaction("readwrite"),i=this._findINode(n,u.dirname(e),u.basename(e)),o=this.getINode(n,e,i),a=o.update(r);try{n.put(o.id,t,!0),a&&n.put(i,o.toBuffer(),!0)}catch(s){throw n.abort(),s}n.commit()},r.prototype.makeRootDirectory=function(){var e=this.store.beginTransaction("readwrite");if(void 0===e.get(Nt)){var t=(new Date).getTime(),r=new Mt(Lt(),4096,511|m.DIRECTORY,t,t,t);e.put(r.id,Bt(),!1),e.put(Nt,r.toBuffer(),!1),e.commit()}},r.prototype._findINode=function(e,t,r){var n=this,i=function(i){var o=n.getDirListing(e,t,i);if(o[r])return o[r];throw d.ENOENT(u.resolve(t,r))};return"/"===t?""===r?Nt:i(this.getINode(e,t,Nt)):i(this.getINode(e,t+u.sep+r,this._findINode(e,u.dirname(t),u.basename(t))))},r.prototype.findINode=function(e,t){return this.getINode(e,t,this._findINode(e,u.dirname(t),u.basename(t)))},r.prototype.getINode=function(e,t,r){var n=e.get(r);if(void 0===n)throw d.ENOENT(t);return Mt.fromBuffer(n)},r.prototype.getDirListing=function(e,t,r){if(!r.isDirectory())throw d.ENOTDIR(t);var n=e.get(r.id);if(void 0===n)throw d.ENOENT(t);return JSON.parse(n.toString())},r.prototype.addNewNode=function(e,t){for(var r;;)try{return r=Lt(),e.put(r,t,!1),r}catch(n){}throw new d(a.EIO,"Unable to commit data to key-value store.")},r.prototype.commitNewFile=function(t,r,n,i,o){var a,s=u.dirname(r),c=u.basename(r),l=this.findINode(t,s),p=this.getDirListing(t,s,l),f=(new Date).getTime();if("/"===r)throw d.EEXIST(r);if(p[c])throw d.EEXIST(r);try{var h=this.addNewNode(t,o);a=new Mt(h,o.length,i|n,f,f,f);var m=this.addNewNode(t,a.toBuffer());p[c]=m,t.put(l.id,e.from(JSON.stringify(p)),!0)}catch(g){throw t.abort(),g}return t.commit(),a},r.prototype.removeEntry=function(t,r){var n=this.store.beginTransaction("readwrite"),i=u.dirname(t),o=this.findINode(n,i),a=this.getDirListing(n,i,o),s=u.basename(t);if(!a[s])throw d.ENOENT(t);var c=a[s];delete a[s];var l=this.getINode(n,t,c);if(!r&&l.isDirectory())throw d.EISDIR(t);if(r&&!l.isDirectory())throw d.ENOTDIR(t);try{n.del(l.id),n.del(c),n.put(o.id,e.from(JSON.stringify(a)),!0)}catch(p){throw n.abort(),p}n.commit()},r}(J),Vt=function(e){function t(t,r,n,i,o){e.call(this,t,r,n,i,o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var t=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),(function(r){r||t.resetDirty(),e(r)})):e()},t.prototype.close=function(e){this.sync(e)},t}(ee),Wt=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.isAvailable=function(){return!0},r.prototype.init=function(e,t){this.store=e,this.makeRootDirectory(t)},r.prototype.getName=function(){return this.store.name()},r.prototype.isReadOnly=function(){return!1},r.prototype.supportsSymlinks=function(){return!1},r.prototype.supportsProps=function(){return!1},r.prototype.supportsSynch=function(){return!1},r.prototype.empty=function(e){var t=this;this.store.clear((function(r){Ut(r,e)&&t.makeRootDirectory(e)}))},r.prototype.rename=function(t,r,n){var i=this,o=this.store.beginTransaction("readwrite"),s=u.dirname(t),c=u.basename(t),l=u.dirname(r),p=u.basename(r),f={},h={},m=!1;if(0===(l+"/").indexOf(t+"/"))return n(new d(a.EBUSY,s));var g=function(a){i.findINodeAndDirListing(o,a,(function(u,g,y){u?m||(m=!0,o.abort((function(){n(u)}))):(f[a]=g,h[a]=y,function(){if(!m&&h.hasOwnProperty(s)&&h.hasOwnProperty(l)){var a=h[s],u=f[s],g=h[l],y=f[l];if(a[c]){var v=a[c];delete a[c];var _=function(){g[p]=v,o.put(u.id,e.from(JSON.stringify(a)),!0,(function(t){zt(t,o,n)&&(s===l?o.commit(n):o.put(y.id,e.from(JSON.stringify(g)),!0,(function(e){zt(e,o,n)&&o.commit(n)})))}))};g[p]?i.getINode(o,r,g[p],(function(e,t){zt(e,o,n)&&(t.isFile()?o.del(t.id,(function(e){zt(e,o,n)&&o.del(g[p],(function(e){zt(e,o,n)&&_()}))})):o.abort((function(e){n(d.EPERM(r))})))})):_()}else n(d.ENOENT(t))}}())}))};g(s),s!==l&&g(l)},r.prototype.stat=function(e,t,r){var n=this.store.beginTransaction("readonly");this.findINode(n,e,(function(e,t){Ut(e,r)&&r(null,t.toStats())}))},r.prototype.createFile=function(e,t,r,n){var i=this,o=this.store.beginTransaction("readwrite"),a=G();this.commitNewFile(o,e,m.FILE,r,a,(function(r,o){Ut(r,n)&&n(null,new Vt(i,e,t,o.toStats(),a))}))},r.prototype.openFile=function(e,t,r){var n=this,i=this.store.beginTransaction("readonly");this.findINode(i,e,(function(o,a){Ut(o,r)&&i.get(a.id,(function(i,o){Ut(i,r)&&(void 0===o?r(d.ENOENT(e)):r(null,new Vt(n,e,t,a.toStats(),o)))}))}))},r.prototype.unlink=function(e,t){this.removeEntry(e,!1,t)},r.prototype.rmdir=function(e,t){var r=this;this.readdir(e,(function(n,i){n?t(n):i.length>0?t(d.ENOTEMPTY(e)):r.removeEntry(e,!0,t)}))},r.prototype.mkdir=function(t,r,n){var i=this.store.beginTransaction("readwrite"),o=e.from("{}");this.commitNewFile(i,t,m.DIRECTORY,r,o,n)},r.prototype.readdir=function(e,t){var r=this,n=this.store.beginTransaction("readonly");this.findINode(n,e,(function(i,o){Ut(i,t)&&r.getDirListing(n,e,o,(function(e,r){Ut(e,t)&&t(null,Object.keys(r))}))}))},r.prototype._sync=function(e,t,r,n){var i=this,o=this.store.beginTransaction("readwrite");this._findINode(o,u.dirname(e),u.basename(e),(function(a,s){zt(a,o,n)&&i.getINode(o,e,s,(function(e,i){if(zt(e,o,n)){var a=i.update(r);o.put(i.id,t,!0,(function(e){zt(e,o,n)&&(a?o.put(s,i.toBuffer(),!0,(function(e){zt(e,o,n)&&o.commit(n)})):o.commit(n))}))}}))}))},r.prototype.makeRootDirectory=function(e){var t=this.store.beginTransaction("readwrite");t.get(Nt,(function(r,n){if(r||void 0===n){var i=(new Date).getTime(),o=new Mt(Lt(),4096,511|m.DIRECTORY,i,i,i);t.put(o.id,Bt(),!1,(function(r){zt(r,t,e)&&t.put(Nt,o.toBuffer(),!1,(function(r){r?t.abort((function(){e(r)})):t.commit(e)}))}))}else t.commit(e)}))},r.prototype._findINode=function(e,t,r,n){var i=this,o=function(e,i,o){e?n(e):o[r]?n(null,o[r]):n(d.ENOENT(u.resolve(t,r)))};"/"===t?""===r?n(null,Nt):this.getINode(e,t,Nt,(function(r,a){Ut(r,n)&&i.getDirListing(e,t,a,(function(e,t){o(e,0,t)}))})):this.findINodeAndDirListing(e,t,o)},r.prototype.findINode=function(e,t,r){var n=this;this._findINode(e,u.dirname(t),u.basename(t),(function(i,o){Ut(i,r)&&n.getINode(e,t,o,r)}))},r.prototype.getINode=function(e,t,r,n){e.get(r,(function(e,r){Ut(e,n)&&(void 0===r?n(d.ENOENT(t)):n(null,Mt.fromBuffer(r)))}))},r.prototype.getDirListing=function(e,t,r,n){r.isDirectory()?e.get(r.id,(function(e,r){if(Ut(e,n))try{n(null,JSON.parse(r.toString()))}catch(i){n(d.ENOENT(t))}})):n(d.ENOTDIR(t))},r.prototype.findINodeAndDirListing=function(e,t,r){var n=this;this.findINode(e,t,(function(i,o){Ut(i,r)&&n.getDirListing(e,t,o,(function(e,t){Ut(e,r)&&r(null,o,t)}))}))},r.prototype.addNewNode=function(e,t,r){var n,i=0,o=function(){5==++i?r(new d(a.EIO,"Unable to commit data to key-value store.")):(n=Lt(),e.put(n,t,!1,(function(e,t){e||!t?o():r(null,n)})))};o()},r.prototype.commitNewFile=function(t,r,n,i,o,a){var s=this,c=u.dirname(r),l=u.basename(r),p=(new Date).getTime();if("/"===r)return a(d.EEXIST(r));this.findINodeAndDirListing(t,c,(function(c,u,f){zt(c,t,a)&&(f[l]?t.abort((function(){a(d.EEXIST(r))})):s.addNewNode(t,o,(function(r,c){if(zt(r,t,a)){var d=new Mt(c,o.length,i|n,p,p,p);s.addNewNode(t,d.toBuffer(),(function(r,n){zt(r,t,a)&&(f[l]=n,t.put(u.id,e.from(JSON.stringify(f)),!0,(function(e){zt(e,t,a)&&t.commit((function(e){zt(e,t,a)&&a(null,d)}))})))}))}})))}))},r.prototype.removeEntry=function(t,r,n){var i=this,o=this.store.beginTransaction("readwrite"),a=u.dirname(t),s=u.basename(t);this.findINodeAndDirListing(o,a,(function(a,c,u){if(zt(a,o,n))if(u[s]){var l=u[s];delete u[s],i.getINode(o,t,l,(function(i,a){zt(i,o,n)&&(!r&&a.isDirectory()?o.abort((function(){n(d.EISDIR(t))})):r&&!a.isDirectory()?o.abort((function(){n(d.ENOTDIR(t))})):o.del(a.id,(function(t){zt(t,o,n)&&o.del(l,(function(t){zt(t,o,n)&&o.put(c.id,e.from(JSON.stringify(u)),!0,(function(e){zt(e,o,n)&&o.commit(n)}))}))})))}))}else o.abort((function(){n(d.ENOENT(t))}))}))},r}(Z),Xt=function(){this.store={}};Xt.prototype.name=function(){return qt.Name},Xt.prototype.clear=function(){this.store={}},Xt.prototype.beginTransaction=function(e){return new jt(this)},Xt.prototype.get=function(e){return this.store[e]},Xt.prototype.put=function(e,t,r){return!(!r&&this.store.hasOwnProperty(e)||(this.store[e]=t,0))},Xt.prototype.del=function(e){delete this.store[e]};var qt=function(e){function t(){e.call(this,{store:new Xt})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t)},t}(Gt);qt.Name="InMemory",qt.Options={};var Yt=Ft.indexedDB||Ft.mozIndexedDB||Ft.webkitIndexedDB||Ft.msIndexedDB;function Kt(e,t){switch(void 0===t&&(t=e.toString()),e.name){case"NotFoundError":return new d(a.ENOENT,t);case"QuotaExceededError":return new d(a.ENOSPC,t);default:return new d(a.EIO,t)}}function Zt(e,t,r){return void 0===t&&(t=a.EIO),void 0===r&&(r=null),function(n){n.preventDefault(),e(new d(t,null!==r?r:void 0))}}var Jt=function(e,t){this.tx=e,this.store=t};Jt.prototype.get=function(e,t){try{var r=this.store.get(e);r.onerror=Zt(t),r.onsuccess=function(e){var r=e.target.result;t(null,void 0===r?r:z(r))}}catch(n){t(Kt(n))}};var Qt=function(e){function t(t,r){e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.put=function(e,t,r,n){try{var i,o=$(t);(i=r?this.store.put(o,e):this.store.add(o,e)).onerror=Zt(n),i.onsuccess=function(e){n(null,!0)}}catch(a){n(Kt(a))}},t.prototype.del=function(e,t){try{var r=this.store.delete(e);r.onerror=Zt(t),r.onsuccess=function(e){t()}}catch(n){t(Kt(n))}},t.prototype.commit=function(e){setTimeout(e,0)},t.prototype.abort=function(e){var t=null;try{this.tx.abort()}catch(r){t=Kt(r)}finally{e(t)}},t}(Jt),er=function(e,t){var r=this;void 0===t&&(t="browserfs"),this.storeName=t;var n=Yt.open(this.storeName,1);n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(r.storeName)&&t.deleteObjectStore(r.storeName),t.createObjectStore(r.storeName)},n.onsuccess=function(t){r.db=t.target.result,e(null,r)},n.onerror=Zt(e,a.EACCES)};er.prototype.name=function(){return tr.Name+" - "+this.storeName},er.prototype.clear=function(e){try{var t=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).clear();t.onsuccess=function(t){setTimeout(e,0)},t.onerror=Zt(e)}catch(r){e(Kt(r))}},er.prototype.beginTransaction=function(e){void 0===e&&(e="readonly");var t=this.db.transaction(this.storeName,e),r=t.objectStore(this.storeName);if("readwrite"===e)return new Qt(t,r);if("readonly"===e)return new Jt(t,r);throw new d(a.EINVAL,"Invalid transaction type.")};var tr=function(e){function t(r,n,i){var o=this;void 0===i&&(i=!0),e.call(this),this.store=new er((function(e){e?r(e):o.init(o.store,(function(e){r(e,o)}))}),n),O(i,t.Name,{storeName:n})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){new t(r,e.storeName,!1)},t.isAvailable=function(){try{return void 0!==Yt&&null!==Yt.open("__browserfs_test__")}catch(e){return!1}},t}(Wt);tr.Name="IndexedDB",tr.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var rr,nr=!1;try{Ft.localStorage.setItem("__test__",String.fromCharCode(55296)),nr=Ft.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch(ni){nr=!1}rr=nr?"binary_string":"binary_string_ie",e.isEncoding(rr)||(rr="base64");var ir=function(){};ir.prototype.name=function(){return or.Name},ir.prototype.clear=function(){Ft.localStorage.clear()},ir.prototype.beginTransaction=function(e){return new jt(this)},ir.prototype.get=function(t){try{var r=Ft.localStorage.getItem(t);if(null!==r)return e.from(r,rr)}catch(ni){}},ir.prototype.put=function(e,t,r){try{return!(!r&&null!==Ft.localStorage.getItem(e)||(Ft.localStorage.setItem(e,t.toString(rr)),0))}catch(ni){throw new d(a.ENOSPC,"LocalStorage is full.")}},ir.prototype.del=function(e){try{Ft.localStorage.removeItem(e)}catch(ni){throw new d(a.EIO,"Unable to delete key "+e+": "+ni)}};var or=function(e){function t(){e.call(this,{store:new ir})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t)},t.isAvailable=function(){return void 0!==Ft.localStorage},t}(Gt);or.Name="LocalStorage",or.Options={};var ar=function(e){function t(){e.call(this),this.mountList=[],this.mntMap={},this.rootFs=new qt}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){var n=new t;Object.keys(e).forEach((function(t){n.mount(t,e[t])})),r(null,n)},t.isAvailable=function(){return!0},t.prototype.mount=function(e,t){if("/"!==e[0]&&(e="/"+e),e=u.resolve(e),this.mntMap[e])throw new d(a.EINVAL,"Mount point "+e+" is already taken.");N(e,511,this.rootFs),this.mntMap[e]=t,this.mountList.push(e),this.mountList=this.mountList.sort((function(e,t){return t.length-e.length}))},t.prototype.umount=function(e){if("/"!==e[0]&&(e="/"+e),e=u.resolve(e),!this.mntMap[e])throw new d(a.EINVAL,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);"/"!==e&&0===this.rootFs.readdirSync(e).length;)this.rootFs.rmdirSync(e),e=u.dirname(e)},t.prototype._getFs=function(e){for(var t=this.mountList,r=t.length,n=0;n<r;n++){var i=t[n];if(i.length<=e.length&&0===e.indexOf(i))return""===(e=e.substr(i.length>1?i.length:0))&&(e="/"),{fs:this.mntMap[i],path:e}}return{fs:this.rootFs,path:e}},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,t){t(0,0)},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.standardizeError=function(e,t,r){var n=e.message.indexOf(t);return-1!==n&&(e.message=e.message.substr(0,n)+r+e.message.substr(n+t.length),e.path=r),e},t.prototype.rename=function(e,t,r){var n=this,i=this._getFs(e),o=this._getFs(t);return i.fs===o.fs?i.fs.rename(i.path,o.path,(function(a){a&&n.standardizeError(n.standardizeError(a,i.path,e),o.path,t),r(a)})):A.readFile(e,(function(n,i){if(n)return r(n);A.writeFile(t,i,(function(t){if(t)return r(t);A.unlink(e,r)}))}))},t.prototype.renameSync=function(e,t){var r=this._getFs(e),n=this._getFs(t);if(r.fs===n.fs)try{return r.fs.renameSync(r.path,n.path)}catch(ni){throw this.standardizeError(this.standardizeError(ni,r.path,e),n.path,t),ni}var i=A.readFileSync(e);return A.writeFileSync(t,i),A.unlinkSync(e)},t.prototype.readdirSync=function(e){var t=this._getFs(e),r=null;if(t.fs!==this.rootFs)try{r=this.rootFs.readdirSync(e)}catch(ni){}try{var n=t.fs.readdirSync(t.path);return null===r?n:n.concat(r.filter((function(e){return-1===n.indexOf(e)})))}catch(ni){if(null===r)throw this.standardizeError(ni,t.path,e);return r}},t.prototype.readdir=function(e,t){var r=this,n=this._getFs(e);n.fs.readdir(n.path,(function(i,o){if(n.fs!==r.rootFs)try{var a=r.rootFs.readdirSync(e);o=o?o.concat(a.filter((function(e){return-1===o.indexOf(e)}))):a}catch(ni){if(i)return t(r.standardizeError(i,n.path,e))}else if(i)return t(r.standardizeError(i,n.path,e));t(null,o)}))},t.prototype.rmdirSync=function(e){var t=this._getFs(e);if(this._containsMountPt(e))throw d.ENOTEMPTY(e);try{t.fs.rmdirSync(t.path)}catch(ni){throw this.standardizeError(ni,t.path,e)}},t.prototype.rmdir=function(e,t){var r=this,n=this._getFs(e);this._containsMountPt(e)?t(d.ENOTEMPTY(e)):n.fs.rmdir(n.path,(function(i){t(i?r.standardizeError(i,n.path,e):null)}))},t.prototype._containsMountPt=function(e){for(var t=this.mountList,r=t.length,n=0;n<r;n++){var i=t[n];if(i.length>=e.length&&i.slice(0,e.length)===e)return!0}return!1},t}(Z);function sr(e,t,r){return t?function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var n=t[0],i=this._getFs(n);t[0]=i.path;try{return i.fs[e].apply(i.fs,t)}catch(ni){throw this.standardizeError(ni,i.path,n),ni}}:function(){for(var t=this,r=[],n=arguments.length;n--;)r[n]=arguments[n];var i=r[0],o=this._getFs(i);if(r[0]=o.path,"function"==typeof r[r.length-1]){var a=r[r.length-1];r[r.length-1]=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];e.length>0&&e[0]instanceof d&&t.standardizeError(e[0],o.path,i),a.apply(null,e)}}return o.fs[e].apply(o.fs,r)}}ar.Name="MountableFileSystem",ar.Options={};for(var cr,ur=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],lr=0;lr<ur.length;lr++)for(var pr=0,fr=ur[lr];pr<fr.length;pr+=1){var dr=fr[pr];ar.prototype[dr]=sr(dr,!1),ar.prototype[dr+"Sync"]=sr(dr+"Sync",!0)}if("undefined"!=typeof setImmediate)cr=setImmediate;else{var hr=Ft,mr=[],gr="zero-timeout-message";if(function(){if(void 0!==hr.importScripts||!hr.postMessage)return!1;var e=!0,t=hr.onmessage;return hr.onmessage=function(){e=!1},hr.postMessage("","*"),hr.onmessage=t,e}()){cr=function(e){mr.push(e),hr.postMessage(gr,"*")};var yr=function(e){if(e.source===self&&e.data===gr&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,mr.length>0))return mr.shift()()};hr.addEventListener?hr.addEventListener("message",yr,!0):hr.attachEvent("onmessage",yr)}else if(hr.MessageChannel){var vr=new hr.MessageChannel;vr.port1.onmessage=function(e){if(mr.length>0)return mr.shift()()},cr=function(e){mr.push(e),vr.port2.postMessage("")}}else cr=function(e){return setTimeout(e,0)}}var _r=cr,br=function(){this._locked=!1,this._waiters=[]};br.prototype.lock=function(e){this._locked?this._waiters.push(e):(this._locked=!0,e())},br.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var e=this._waiters.shift();e?_r(e):this._locked=!1},br.prototype.tryLock=function(){return!this._locked&&(this._locked=!0,!0)},br.prototype.isLocked=function(){return this._locked};var wr=function(e){this._fs=e,this._mu=new br};wr.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},wr.prototype.getFSUnlocked=function(){return this._fs},wr.prototype.initialize=function(e){this._fs.initialize(e)},wr.prototype.diskSpace=function(e,t){this._fs.diskSpace(e,t)},wr.prototype.isReadOnly=function(){return this._fs.isReadOnly()},wr.prototype.supportsLinks=function(){return this._fs.supportsLinks()},wr.prototype.supportsProps=function(){return this._fs.supportsProps()},wr.prototype.supportsSynch=function(){return this._fs.supportsSynch()},wr.prototype.rename=function(e,t,r){var n=this;this._mu.lock((function(){n._fs.rename(e,t,(function(e){n._mu.unlock(),r(e)}))}))},wr.prototype.renameSync=function(e,t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(e,t)},wr.prototype.stat=function(e,t,r){var n=this;this._mu.lock((function(){n._fs.stat(e,t,(function(e,t){n._mu.unlock(),r(e,t)}))}))},wr.prototype.statSync=function(e,t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(e,t)},wr.prototype.open=function(e,t,r,n){var i=this;this._mu.lock((function(){i._fs.open(e,t,r,(function(e,t){i._mu.unlock(),n(e,t)}))}))},wr.prototype.openSync=function(e,t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(e,t,r)},wr.prototype.unlink=function(e,t){var r=this;this._mu.lock((function(){r._fs.unlink(e,(function(e){r._mu.unlock(),t(e)}))}))},wr.prototype.unlinkSync=function(e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(e)},wr.prototype.rmdir=function(e,t){var r=this;this._mu.lock((function(){r._fs.rmdir(e,(function(e){r._mu.unlock(),t(e)}))}))},wr.prototype.rmdirSync=function(e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(e)},wr.prototype.mkdir=function(e,t,r){var n=this;this._mu.lock((function(){n._fs.mkdir(e,t,(function(e){n._mu.unlock(),r(e)}))}))},wr.prototype.mkdirSync=function(e,t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(e,t)},wr.prototype.readdir=function(e,t){var r=this;this._mu.lock((function(){r._fs.readdir(e,(function(e,n){r._mu.unlock(),t(e,n)}))}))},wr.prototype.readdirSync=function(e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(e)},wr.prototype.exists=function(e,t){var r=this;this._mu.lock((function(){r._fs.exists(e,(function(e){r._mu.unlock(),t(e)}))}))},wr.prototype.existsSync=function(e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(e)},wr.prototype.realpath=function(e,t,r){var n=this;this._mu.lock((function(){n._fs.realpath(e,t,(function(e,t){n._mu.unlock(),r(e,t)}))}))},wr.prototype.realpathSync=function(e,t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(e,t)},wr.prototype.truncate=function(e,t,r){var n=this;this._mu.lock((function(){n._fs.truncate(e,t,(function(e){n._mu.unlock(),r(e)}))}))},wr.prototype.truncateSync=function(e,t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(e,t)},wr.prototype.readFile=function(e,t,r,n){var i=this;this._mu.lock((function(){i._fs.readFile(e,t,r,(function(e,t){i._mu.unlock(),n(e,t)}))}))},wr.prototype.readFileSync=function(e,t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(e,t,r)},wr.prototype.writeFile=function(e,t,r,n,i,o){var a=this;this._mu.lock((function(){a._fs.writeFile(e,t,r,n,i,(function(e){a._mu.unlock(),o(e)}))}))},wr.prototype.writeFileSync=function(e,t,r,n,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(e,t,r,n,i)},wr.prototype.appendFile=function(e,t,r,n,i,o){var a=this;this._mu.lock((function(){a._fs.appendFile(e,t,r,n,i,(function(e){a._mu.unlock(),o(e)}))}))},wr.prototype.appendFileSync=function(e,t,r,n,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(e,t,r,n,i)},wr.prototype.chmod=function(e,t,r,n){var i=this;this._mu.lock((function(){i._fs.chmod(e,t,r,(function(e){i._mu.unlock(),n(e)}))}))},wr.prototype.chmodSync=function(e,t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(e,t,r)},wr.prototype.chown=function(e,t,r,n,i){var o=this;this._mu.lock((function(){o._fs.chown(e,t,r,n,(function(e){o._mu.unlock(),i(e)}))}))},wr.prototype.chownSync=function(e,t,r,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(e,t,r,n)},wr.prototype.utimes=function(e,t,r,n){var i=this;this._mu.lock((function(){i._fs.utimes(e,t,r,(function(e){i._mu.unlock(),n(e)}))}))},wr.prototype.utimesSync=function(e,t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(e,t,r)},wr.prototype.link=function(e,t,r){var n=this;this._mu.lock((function(){n._fs.link(e,t,(function(e){n._mu.unlock(),r(e)}))}))},wr.prototype.linkSync=function(e,t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(e,t)},wr.prototype.symlink=function(e,t,r,n){var i=this;this._mu.lock((function(){i._fs.symlink(e,t,r,(function(e){i._mu.unlock(),n(e)}))}))},wr.prototype.symlinkSync=function(e,t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(e,t,r)},wr.prototype.readlink=function(e,t){var r=this;this._mu.lock((function(){r._fs.readlink(e,(function(e,n){r._mu.unlock(),t(e,n)}))}))},wr.prototype.readlinkSync=function(e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(e)};var Tr="/.deletedFiles.log";function kr(e){return 146|e}function Er(e){return y.getFileFlag(e)}var Sr,Ir,Pr=function(e){function t(t,r,n,i,o){e.call(this,t,r,n,i,o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var t=this;this.isDirty()?this._fs._syncAsync(this,(function(r){t.resetDirty(),e(r)})):e(null)},t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.close=function(e){this.sync(e)},t.prototype.closeSync=function(){this.syncSync()},t}(ee),Ar=function(e){function t(t,r){if(e.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=t,this._readable=r,this._writable.isReadOnly())throw new d(a.EINVAL,"Writable file system must be writable.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},t.prototype._syncAsync=function(e,t){var r=this;this.createParentDirectoriesAsync(e.getPath(),(function(n){if(n)return t(n);r._writable.writeFile(e.getPath(),e.getBuffer(),null,Er("w"),e.getStats().mode,t)}))},t.prototype._syncSync=function(e){this.createParentDirectories(e.getPath()),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,Er("w"),e.getStats().mode)},t.prototype.getName=function(){return Cr.Name},t.prototype.initialize=function(e){var t=this,r=this._initializeCallbacks,n=function(e){t._isInitialized=!e,t._initializeCallbacks=[],r.forEach((function(t){return t(e)}))};if(this._isInitialized)return e();r.push(e),1===r.length&&this._writable.readFile(Tr,"utf8",Er("r"),(function(e,r){if(e){if(e.errno!==a.ENOENT)return n(e)}else t._deleteLog=r;t._reparseDeletionLog(),n()}))},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},t.prototype.getDeletionLog=function(){return this._deleteLog},t.prototype.restoreDeletionLog=function(e){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("")},t.prototype.rename=function(e,t,r){var n=this;if(this.checkInitAsync(r)&&!this.checkPathAsync(e,r)&&!this.checkPathAsync(t,r))return e===Tr||t===Tr?r(d.EPERM("Cannot rename deletion log.")):e===t?r():void this.stat(e,!1,(function(i,o){return i?r(i):n.stat(t,!1,(function(i,s){var c=n;function l(n){var i=n.shift();if(!i)return r();var o=u.resolve(e,i),a=u.resolve(t,i);c.rename(o,a,(function(e){if(e)return r(e);l(n)}))}var p=511;if(o.isDirectory()){if(i)return i.errno!==a.ENOENT?r(i):n._writable.exists(e,(function(i){if(i)return n._writable.rename(e,t,r);n._writable.mkdir(t,p,(function(t){if(t)return r(t);n._readable.readdir(e,(function(e,t){if(e)return r();l(t)}))}))}));if(p=s.mode,!s.isDirectory())return r(d.ENOTDIR(t));n.readdir(t,(function(i,o){if(o&&o.length)return r(d.ENOTEMPTY(t));n._readable.readdir(e,(function(e,t){if(e)return r();l(t)}))}))}if(s&&s.isDirectory())return r(d.EISDIR(t));n.readFile(e,null,Er("r"),(function(i,a){return i?r(i):n.writeFile(t,a,null,Er("w"),o.mode,(function(t){return t?r(t):n.unlink(e,r)}))}))}))}))},t.prototype.renameSync=function(e,t){var r=this;if(this.checkInitialized(),this.checkPath(e),this.checkPath(t),e===Tr||t===Tr)throw d.EPERM("Cannot rename deletion log.");var n=this.statSync(e,!1);if(n.isDirectory()){if(e===t)return;var i=511;if(this.existsSync(t)){var o=this.statSync(t,!1);if(i=o.mode,!o.isDirectory())throw d.ENOTDIR(t);if(this.readdirSync(t).length>0)throw d.ENOTEMPTY(t)}this._writable.existsSync(e)?this._writable.renameSync(e,t):this._writable.existsSync(t)||this._writable.mkdirSync(t,i),this._readable.existsSync(e)&&this._readable.readdirSync(e).forEach((function(n){r.renameSync(u.resolve(e,n),u.resolve(t,n))}))}else{if(this.existsSync(t)&&this.statSync(t,!1).isDirectory())throw d.EISDIR(t);this.writeFileSync(t,this.readFileSync(e,null,Er("r")),null,Er("w"),n.mode)}e!==t&&this.existsSync(e)&&this.unlinkSync(e)},t.prototype.stat=function(e,t,r){var n=this;this.checkInitAsync(r)&&this._writable.stat(e,t,(function(i,o){i&&i.errno===a.ENOENT?(n._deletedFiles[e]&&r(d.ENOENT(e)),n._readable.stat(e,t,(function(e,t){t&&((t=t.clone()).mode=kr(t.mode)),r(e,t)}))):r(i,o)}))},t.prototype.statSync=function(e,t){this.checkInitialized();try{return this._writable.statSync(e,t)}catch(ni){if(this._deletedFiles[e])throw d.ENOENT(e);var r=this._readable.statSync(e,t).clone();return r.mode=kr(r.mode),r}},t.prototype.open=function(e,t,r,n){var i=this;this.checkInitAsync(n)&&!this.checkPathAsync(e,n)&&this.stat(e,!1,(function(o,a){if(a)switch(t.pathExistsAction()){case p.TRUNCATE_FILE:return i.createParentDirectoriesAsync(e,(function(o){if(o)return n(o);i._writable.open(e,t,r,n)}));case p.NOP:return i._writable.exists(e,(function(o){o?i._writable.open(e,t,r,n):((a=a.clone()).mode=r,i._readable.readFile(e,null,Er("r"),(function(r,o){if(r)return n(r);-1===a.size&&(a.size=o.length);var s=new Pr(i,e,t,a,o);n(null,s)})))}));default:return n(d.EEXIST(e))}else switch(t.pathNotExistsAction()){case p.CREATE_FILE:return i.createParentDirectoriesAsync(e,(function(o){return o?n(o):i._writable.open(e,t,r,n)}));default:return n(d.ENOENT(e))}}))},t.prototype.openSync=function(e,t,r){if(this.checkInitialized(),this.checkPath(e),e===Tr)throw d.EPERM("Cannot open deletion log.");if(this.existsSync(e))switch(t.pathExistsAction()){case p.TRUNCATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,t,r);case p.NOP:if(this._writable.existsSync(e))return this._writable.openSync(e,t,r);var n=this._readable.readFileSync(e,null,Er("r")),i=this._readable.statSync(e,!1).clone();return i.mode=r,new Pr(this,e,t,i,n);default:throw d.EEXIST(e)}else switch(t.pathNotExistsAction()){case p.CREATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,t,r);default:throw d.ENOENT(e)}},t.prototype.unlink=function(e,t){var r=this;this.checkInitAsync(t)&&!this.checkPathAsync(e,t)&&this.exists(e,(function(n){if(!n)return t(d.ENOENT(e));r._writable.exists(e,(function(n){if(n)return r._writable.unlink(e,(function(n){if(n)return t(n);r.exists(e,(function(n){n&&r.deletePath(e),t(null)}))}));r.deletePath(e),t(null)}))}))},t.prototype.unlinkSync=function(e){if(this.checkInitialized(),this.checkPath(e),!this.existsSync(e))throw d.ENOENT(e);this._writable.existsSync(e)&&this._writable.unlinkSync(e),this.existsSync(e)&&this.deletePath(e)},t.prototype.rmdir=function(e,t){var r=this;if(this.checkInitAsync(t)){var n=function(){r.readdir(e,(function(n,i){return n?t(n):i.length?t(d.ENOTEMPTY(e)):(r.deletePath(e),void t(null))}))};this.exists(e,(function(i){if(!i)return t(d.ENOENT(e));r._writable.exists(e,(function(i){i?r._writable.rmdir(e,(function(i){if(i)return t(i);r._readable.exists(e,(function(e){e?n():t()}))})):n()}))}))}},t.prototype.rmdirSync=function(e){if(this.checkInitialized(),!this.existsSync(e))throw d.ENOENT(e);if(this._writable.existsSync(e)&&this._writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length>0)throw d.ENOTEMPTY(e);this.deletePath(e)}},t.prototype.mkdir=function(e,t,r){var n=this;this.checkInitAsync(r)&&this.exists(e,(function(i){if(i)return r(d.EEXIST(e));n.createParentDirectoriesAsync(e,(function(i){if(i)return r(i);n._writable.mkdir(e,t,r)}))}))},t.prototype.mkdirSync=function(e,t){if(this.checkInitialized(),this.existsSync(e))throw d.EEXIST(e);this.createParentDirectories(e),this._writable.mkdirSync(e,t)},t.prototype.readdir=function(e,t){var r=this;this.checkInitAsync(t)&&this.stat(e,!1,(function(n,i){return n?t(n):i.isDirectory()?void r._writable.readdir(e,(function(n,i){if(n&&"ENOENT"!==n.code)return t(n);!n&&i||(i=[]),r._readable.readdir(e,(function(n,o){!n&&o||(o=[]);var a={},s=i.concat(o.filter((function(t){return!r._deletedFiles[e+"/"+t]}))).filter((function(e){var t=!a[e];return a[e]=!0,t}));t(null,s)}))})):t(d.ENOTDIR(e))}))},t.prototype.readdirSync=function(e){var t=this;if(this.checkInitialized(),!this.statSync(e,!1).isDirectory())throw d.ENOTDIR(e);var r=[];try{r=r.concat(this._writable.readdirSync(e))}catch(ni){}try{r=r.concat(this._readable.readdirSync(e).filter((function(r){return!t._deletedFiles[e+"/"+r]})))}catch(ni){}var n={};return r.filter((function(e){var t=!n[e];return n[e]=!0,t}))},t.prototype.exists=function(e,t){var r=this;this.checkInitialized(),this._writable.exists(e,(function(n){if(n)return t(!0);r._readable.exists(e,(function(n){t(n&&!0!==r._deletedFiles[e])}))}))},t.prototype.existsSync=function(e){return this.checkInitialized(),this._writable.existsSync(e)||this._readable.existsSync(e)&&!0!==this._deletedFiles[e]},t.prototype.chmod=function(e,t,r,n){var i=this;this.checkInitAsync(n)&&this.operateOnWritableAsync(e,(function(o){if(o)return n(o);i._writable.chmod(e,t,r,n)}))},t.prototype.chmodSync=function(e,t,r){var n=this;this.checkInitialized(),this.operateOnWritable(e,(function(){n._writable.chmodSync(e,t,r)}))},t.prototype.chown=function(e,t,r,n,i){var o=this;this.checkInitAsync(i)&&this.operateOnWritableAsync(e,(function(a){if(a)return i(a);o._writable.chown(e,t,r,n,i)}))},t.prototype.chownSync=function(e,t,r,n){var i=this;this.checkInitialized(),this.operateOnWritable(e,(function(){i._writable.chownSync(e,t,r,n)}))},t.prototype.utimes=function(e,t,r,n){var i=this;this.checkInitAsync(n)&&this.operateOnWritableAsync(e,(function(o){if(o)return n(o);i._writable.utimes(e,t,r,n)}))},t.prototype.utimesSync=function(e,t,r){var n=this;this.checkInitialized(),this.operateOnWritable(e,(function(){n._writable.utimesSync(e,t,r)}))},t.prototype.deletePath=function(e){this._deletedFiles[e]=!0,this.updateLog("d"+e+"\n")},t.prototype.updateLog=function(e){var t=this;this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Tr,this._deleteLog,"utf8",y.getFileFlag("w"),420,(function(e){t._deleteLogUpdatePending=!1,e?t._deleteLogError=e:t._deleteLogUpdateNeeded&&(t._deleteLogUpdateNeeded=!1,t.updateLog(""))})))},t.prototype._reparseDeletionLog=function(){var e=this;this._deletedFiles={},this._deleteLog.split("\n").forEach((function(t){e._deletedFiles[t.slice(1)]="d"===t.slice(0,1)}))},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new d(a.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.");if(null!==this._deleteLogError){var e=this._deleteLogError;throw this._deleteLogError=null,e}},t.prototype.checkInitAsync=function(e){if(!this._isInitialized)return e(new d(a.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;if(null!==this._deleteLogError){var t=this._deleteLogError;return this._deleteLogError=null,e(t),!1}return!0},t.prototype.checkPath=function(e){if(e===Tr)throw d.EPERM(e)},t.prototype.checkPathAsync=function(e,t){return e===Tr&&(t(d.EPERM(e)),!0)},t.prototype.createParentDirectoriesAsync=function(e,t){var r=u.dirname(e),n=[],i=this;function o(){if(!n.length)return t();var e=n.pop();i._readable.stat(e,!1,(function(r,n){if(!n)return t();i._writable.mkdir(e,n.mode,(function(e){if(e)return t(e);o()}))}))}this._writable.stat(r,!1,(function e(t,a){t?(n.push(r),r=u.dirname(r),i._writable.stat(r,!1,e)):o()}))},t.prototype.createParentDirectories=function(e){for(var t=this,r=u.dirname(e),n=[];!this._writable.existsSync(r);)n.push(r),r=u.dirname(r);(n=n.reverse()).forEach((function(e){t._writable.mkdirSync(e,t.statSync(e,!1).mode)}))},t.prototype.operateOnWritable=function(e,t){if(!this.existsSync(e))throw d.ENOENT(e);this._writable.existsSync(e)||this.copyToWritable(e),t()},t.prototype.operateOnWritableAsync=function(e,t){var r=this;this.exists(e,(function(n){if(!n)return t(d.ENOENT(e));r._writable.exists(e,(function(n){if(!n)return r.copyToWritableAsync(e,t);t()}))}))},t.prototype.copyToWritable=function(e){var t=this.statSync(e,!1);t.isDirectory()?this._writable.mkdirSync(e,t.mode):this.writeFileSync(e,this._readable.readFileSync(e,null,Er("r")),null,Er("w"),this.statSync(e,!1).mode)},t.prototype.copyToWritableAsync=function(e,t){var r=this;this.stat(e,!1,(function(n,i){return n?t(n):i.isDirectory()?r._writable.mkdir(e,i.mode,t):void r._readable.readFile(e,null,Er("r"),(function(n,o){if(n)return t(n);r.writeFile(e,o,null,Er("w"),i.mode,t)}))}))},t}(Z),Cr=function(e){function t(r,n,i){void 0===i&&(i=!0),e.call(this,new Ar(r,n)),O(i,t.Name,{readable:"readable file system",writable:"writable file system"})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{var n=new t(e.writable,e.readable,!1);n.initialize((function(e){r(e,n)}),!1)}catch(ni){r(ni)}},t.isAvailable=function(){return Ar.isAvailable()},t.prototype.initialize=function(t,r){void 0===r&&(r=!0),r&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),e.prototype.initialize.call(this,t)},t.prototype.getOverlayedFileSystems=function(){return e.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},t.prototype.unwrap=function(){return e.prototype.getFSUnlocked.call(this)},t}(wr);Cr.Name="OverlayFS",Cr.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}},(Ir=Sr||(Sr={}))[Ir.CB=0]="CB",Ir[Ir.FD=1]="FD",Ir[Ir.API_ERROR=2]="API_ERROR",Ir[Ir.STATS=3]="STATS",Ir[Ir.PROBE=4]="PROBE",Ir[Ir.FILEFLAG=5]="FILEFLAG",Ir[Ir.BUFFER=6]="BUFFER",Ir[Ir.ERROR=7]="ERROR";var Fr=function(){this._callbacks={},this._nextId=0};Fr.prototype.toRemoteArg=function(e){var t=this._nextId++;return this._callbacks[t]=e,{type:Sr.CB,id:t}},Fr.prototype.toLocalArg=function(e){var t=this._callbacks[e];return delete this._callbacks[e],t};var Dr=function(){this._fileDescriptors={},this._nextId=0};function Or(e){return{type:Sr.API_ERROR,errorData:Ur(e.writeToBuffer())}}function xr(e){return d.fromBuffer(zr(e.errorData))}function Rr(e){return{type:Sr.ERROR,name:e.name,message:e.message,stack:e.stack}}function Mr(e){var t=Ft[e.name];"function"!=typeof t&&(t=Error);var r=new t(e.message);return r.stack=e.stack,r}function Nr(e){return{type:Sr.STATS,statsData:Ur(e.toBuffer())}}function $r(e){return v.fromBuffer(zr(e.statsData))}function Br(e){return{type:Sr.FILEFLAG,flagStr:e.getFlagString()}}function Lr(e){return y.getFileFlag(e.flagStr)}function Ur(e){return $(e)}function zr(e){return z(e)}function jr(e){return{type:Sr.BUFFER,data:Ur(e)}}function Hr(e){return zr(e.data)}Dr.prototype.toRemoteArg=function(t,r,n,i){var o,a,s=this._nextId++;this._fileDescriptors[s]=t,t.stat((function(c,u){c?i(c):(a=Ur(u.toBuffer()),n.isReadable()?t.read(e.alloc(u.size),0,u.size,0,(function(e,t,c){e?i(e):(o=Ur(c),i(null,{type:Sr.FD,id:s,data:o,stat:a,path:r,flag:n.getFlagString()}))})):i(null,{type:Sr.FD,id:s,data:new ArrayBuffer(0),stat:a,path:r,flag:n.getFlagString()}))}))},Dr.prototype.applyFdAPIRequest=function(e,t){var r=this,n=e.args[0];this._applyFdChanges(n,(function(i,o){i?t(i):o[e.method]((function(i){"close"===e.method&&delete r._fileDescriptors[n.id],t(i)}))}))},Dr.prototype._applyFdChanges=function(e,t){var r=this._fileDescriptors[e.id],n=zr(e.data),i=v.fromBuffer(zr(e.stat)),o=y.getFileFlag(e.flag);o.isWriteable()?r.write(n,0,n.length,o.isAppendable()?r.getPos():0,(function(e){function a(){r.stat((function(e,n){e?t(e):n.mode!==i.mode?r.chmod(i.mode,(function(e){t(e,r)})):t(e,r)}))}e?t(e):o.isAppendable()?a():r.truncate(n.length,(function(){a()}))})):t(null,r)};var Gr=function(e){function t(t,r,n,i,o,a){e.call(this,t,r,n,i,a),this._remoteFdId=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getRemoteFdId=function(){return this._remoteFdId},t.prototype.toRemoteArg=function(){return{type:Sr.FD,id:this._remoteFdId,data:Ur(this.getBuffer()),stat:Ur(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},t.prototype.sync=function(e){this._syncClose("sync",e)},t.prototype.close=function(e){this._syncClose("close",e)},t.prototype._syncClose=function(e,t){var r=this;this.isDirty()?this._fs.syncClose(e,this,(function(e){e||r.resetDirty(),t(e)})):t()},t}(ee),Vr=function(t){function r(e,n){var i=this;void 0===n&&(n=!0),t.call(this),this._callbackConverter=new Fr,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=e,O(n,r.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",(function(e){var t,r=e.data;if((t=r)&&"object"==typeof t&&t.hasOwnProperty("browserfsMessage")&&t.browserfsMessage){var n,o=r.args,a=new Array(o.length);for(n=0;n<a.length;n++)a[n]=i._argRemote2Local(o[n]);i._callbackConverter.toLocalArg(r.cbId).apply(null,a)}}))}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.Create=function(e,t){var n=new r(e.worker,!1);n.initialize((function(){t(null,n)}))},r.isAvailable=function(){return"undefined"!=typeof importScripts||"undefined"!=typeof Worker},r.attachRemoteListener=function(t){var r=new Dr;function n(t,n,i){switch(typeof t){case"object":t instanceof v?i(null,Nr(t)):t instanceof d?i(null,Or(t)):t instanceof Q?i(null,r.toRemoteArg(t,n[0],n[1],i)):t instanceof y?i(null,Br(t)):t instanceof e?i(null,jr(t)):t instanceof Error?i(null,Rr(t)):i(null,t);break;default:i(null,t)}}function i(e,r){if(!e)return e;switch(typeof e){case"object":if("number"!=typeof e.type)return e;var i=e;switch(i.type){case Sr.CB:var o=e.id;return function(){var e,i,a=arguments,s=new Array(arguments.length),c=arguments.length;function u(e){c>0&&(c=-1,i={browserfsMessage:!0,cbId:o,args:[Or(e)]},t.postMessage(i))}for(e=0;e<arguments.length;e++)!function(e,a){n(a,r,(function(r,n){s[e]=n,r?u(r):0==--c&&(i={browserfsMessage:!0,cbId:o,args:s},t.postMessage(i))}))}(e,a[e]);0===arguments.length&&(i={browserfsMessage:!0,cbId:o,args:s},t.postMessage(i))};case Sr.API_ERROR:return xr(i);case Sr.STATS:return $r(i);case Sr.FILEFLAG:return Lr(i);case Sr.BUFFER:return Hr(i);case Sr.ERROR:return Mr(i);default:return e}default:return e}}t.addEventListener("message",(function(e){var n,o,a=e.data;if((o=a)&&"object"==typeof o&&o.hasOwnProperty("browserfsMessage")&&o.browserfsMessage){var s=a.args,c=new Array(s.length);switch(a.method){case"close":case"sync":n=s[1],r.applyFdAPIRequest(a,(function(e){var r={browserfsMessage:!0,cbId:n.id,args:e?[Or(e)]:[]};t.postMessage(r)}));break;case"probe":!function(){var e=A.getRootFS(),r=s[1],n={type:Sr.PROBE,isReadOnly:e.isReadOnly(),supportsLinks:e.supportsLinks(),supportsProps:e.supportsProps()},i={browserfsMessage:!0,cbId:r.id,args:[n]};t.postMessage(i)}();break;default:for(var u=0;u<s.length;u++)c[u]=i(s[u],c);var l=A.getRootFS();l[a.method].apply(l,c)}}}))},r.prototype.getName=function(){return r.Name},r.prototype.initialize=function(e){var t=this;if(this._isInitialized)e();else{var r={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(G()),this._callbackConverter.toRemoteArg((function(r){t._isInitialized=!0,t._isReadOnly=r.isReadOnly,t._supportLinks=r.supportsLinks,t._supportProps=r.supportsProps,e()}))]};this._worker.postMessage(r)}},r.prototype.isReadOnly=function(){return this._isReadOnly},r.prototype.supportsSynch=function(){return!1},r.prototype.supportsLinks=function(){return this._supportLinks},r.prototype.supportsProps=function(){return this._supportProps},r.prototype.rename=function(e,t,r){this._rpc("rename",arguments)},r.prototype.stat=function(e,t,r){this._rpc("stat",arguments)},r.prototype.open=function(e,t,r,n){this._rpc("open",arguments)},r.prototype.unlink=function(e,t){this._rpc("unlink",arguments)},r.prototype.rmdir=function(e,t){this._rpc("rmdir",arguments)},r.prototype.mkdir=function(e,t,r){this._rpc("mkdir",arguments)},r.prototype.readdir=function(e,t){this._rpc("readdir",arguments)},r.prototype.exists=function(e,t){this._rpc("exists",arguments)},r.prototype.realpath=function(e,t,r){this._rpc("realpath",arguments)},r.prototype.truncate=function(e,t,r){this._rpc("truncate",arguments)},r.prototype.readFile=function(e,t,r,n){this._rpc("readFile",arguments)},r.prototype.writeFile=function(e,t,r,n,i,o){this._rpc("writeFile",arguments)},r.prototype.appendFile=function(e,t,r,n,i,o){this._rpc("appendFile",arguments)},r.prototype.chmod=function(e,t,r,n){this._rpc("chmod",arguments)},r.prototype.chown=function(e,t,r,n,i){this._rpc("chown",arguments)},r.prototype.utimes=function(e,t,r,n){this._rpc("utimes",arguments)},r.prototype.link=function(e,t,r){this._rpc("link",arguments)},r.prototype.symlink=function(e,t,r,n){this._rpc("symlink",arguments)},r.prototype.readlink=function(e,t){this._rpc("readlink",arguments)},r.prototype.syncClose=function(e,t,r){this._worker.postMessage({browserfsMessage:!0,method:e,args:[t.toRemoteArg(),this._callbackConverter.toRemoteArg(r)]})},r.prototype._argRemote2Local=function(e){if(!e)return e;switch(typeof e){case"object":if("number"!=typeof e.type)return e;var t=e;switch(t.type){case Sr.API_ERROR:return xr(t);case Sr.FD:var r=t;return new Gr(this,r.path,y.getFileFlag(r.flag),v.fromBuffer(zr(r.stat)),r.id,zr(r.data));case Sr.STATS:return $r(t);case Sr.FILEFLAG:return Lr(t);case Sr.BUFFER:return Hr(t);case Sr.ERROR:return Mr(t);default:return e}default:return e}},r.prototype._rpc=function(e,t){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=this._argLocal2Remote(t[n]);var i={browserfsMessage:!0,method:e,args:r};this._worker.postMessage(i)},r.prototype._argLocal2Remote=function(t){if(!t)return t;switch(typeof t){case"object":return t instanceof v?Nr(t):t instanceof d?Or(t):t instanceof Gr?t.toRemoteArg():t instanceof y?Br(t):t instanceof e?jr(t):t instanceof Error?Rr(t):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(t);default:return t}},r}(Z);function Wr(e,t,r){var n=new XMLHttpRequest;n.open("HEAD",t,e),n.onreadystatechange=function(e){if(4===n.readyState){if(200!==n.status)return r(new d(n.status,"XHR HEAD error."));try{return r(null,parseInt(n.getResponseHeader("Content-Length")||"-1",10))}catch(t){return r(new d(a.EIO,"XHR HEAD error: Could not read content-length."))}}},n.send()}Vr.Name="WorkerFS",Vr.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(e,t){e.postMessage?t():t(new d(a.EINVAL,"option must be a Web Worker instance."))}}};var Xr=function(t,r,n){var i=new XMLHttpRequest;i.open("GET",t,!0);var o=!0;switch(r){case"buffer":i.responseType="arraybuffer";break;case"json":try{i.responseType="json",o="json"===i.responseType}catch(ni){o=!1}break;default:return n(new d(a.EINVAL,"Invalid download type: "+r))}i.onreadystatechange=function(t){if(4===i.readyState){if(200!==i.status)return n(new d(i.status,"XHR error."));switch(r){case"buffer":return n(null,i.response?e.from(i.response):G());case"json":return n(null,o?i.response:JSON.parse(i.responseText))}}},i.send()},qr=x&&"undefined"!=typeof Blob?function(t,r){var n,i,o=new XMLHttpRequest;switch(o.open("GET",t,!1),r){case"buffer":o.responseType="arraybuffer";break;case"json":break;default:throw new d(a.EINVAL,"Invalid download type: "+r)}if(o.onreadystatechange=function(t){if(4===o.readyState)if(200===o.status)switch(r){case"buffer":n=e.from(o.response);break;case"json":n=JSON.parse(o.response)}else i=new d(o.status,"XHR error.")},o.send(),i)throw i;return n}:function(t,r){var n=new XMLHttpRequest;n.open("GET",t,!1);var i=null,o=null;if(n.overrideMimeType("text/plain; charset=x-user-defined"),n.onreadystatechange=function(t){if(4===n.readyState){if(200!==n.status)return void(o=new d(n.status,"XHR error."));switch(r){case"buffer":var a=n.responseText;i=e.alloc(a.length);for(var s=0;s<a.length;s++)i[s]=a.charCodeAt(s);return;case"json":return void(i=JSON.parse(n.responseText))}}},n.send(),o)throw o;return i},Yr=function(){this._index={},this.addPath("/",new Zr)};Yr.fromListing=function(e){var t=new Yr,r=new Zr;t._index["/"]=r;for(var n=[["",e,r]];n.length>0;){var i=void 0,o=n.pop(),a=o[0],s=o[1],c=o[2];for(var u in s)if(s.hasOwnProperty(u)){var l=s[u],p=a+"/"+u;l?(t._index[p]=i=new Zr,n.push([p,l,i])):i=new Kr(new v(m.FILE,-1,365)),c&&(c._ls[u]=i)}}return t},Yr.prototype.fileIterator=function(e){var t=this;for(var r in t._index)if(t._index.hasOwnProperty(r))for(var n=t._index[r],i=0,o=n.getListing();i<o.length;i+=1){var a=o[i],s=n.getItem(a);Jr(s)&&e(s.getData())}},Yr.prototype.addPath=function(e,t){if(!t)throw new Error("Inode must be specified");if("/"!==e[0])throw new Error("Path must be absolute, got: "+e);if(this._index.hasOwnProperty(e))return this._index[e]===t;var r=this._split_path(e),n=r[0],i=r[1],o=this._index[n];return!(void 0===o&&"/"!==e&&(o=new Zr,!this.addPath(n,o))||"/"!==e&&!o.addItem(i,t)||(Qr(t)&&(this._index[e]=t),0))},Yr.prototype.addPathFast=function(e,t){var r=e.lastIndexOf("/"),n=0===r?"/":e.substring(0,r),i=e.substring(r+1),o=this._index[n];return void 0===o&&(o=new Zr,this.addPathFast(n,o)),!!o.addItem(i,t)&&(t.isDir()&&(this._index[e]=t),!0)},Yr.prototype.removePath=function(e){var t=this._split_path(e),r=t[0],n=t[1],i=this._index[r];if(void 0===i)return null;var o=i.remItem(n);if(null===o)return null;if(Qr(o)){for(var a=0,s=o.getListing();a<s.length;a+=1){var c=s[a];this.removePath(e+"/"+c)}"/"!==e&&delete this._index[e]}return o},Yr.prototype.ls=function(e){var t=this._index[e];return void 0===t?null:t.getListing()},Yr.prototype.getInode=function(e){var t=this._split_path(e),r=t[0],n=t[1],i=this._index[r];return void 0===i?null:r===e?i:i.getItem(n)},Yr.prototype._split_path=function(e){var t=u.dirname(e);return[t,e.substr(t.length+("/"===t?0:1))]};var Kr=function(e){this.data=e};Kr.prototype.isFile=function(){return!0},Kr.prototype.isDir=function(){return!1},Kr.prototype.getData=function(){return this.data},Kr.prototype.setData=function(e){this.data=e};var Zr=function(e){void 0===e&&(e=null),this.data=e,this._ls={}};function Jr(e){return!!e&&e.isFile()}function Qr(e){return!!e&&e.isDir()}Zr.prototype.isFile=function(){return!1},Zr.prototype.isDir=function(){return!0},Zr.prototype.getData=function(){return this.data},Zr.prototype.getStats=function(){return new v(m.DIRECTORY,4096,365)},Zr.prototype.getListing=function(){return Object.keys(this._ls)},Zr.prototype.getItem=function(e){var t=this._ls[e];return t||null},Zr.prototype.addItem=function(e,t){return!(e in this._ls)&&(this._ls[e]=t,!0)},Zr.prototype.remItem=function(e){var t=this._ls[e];return void 0===t?null:(delete this._ls[e],t)};var en=function(e){function t(r,n,i){void 0===n&&(n=""),void 0===i&&(i=!0),e.call(this),r||(r="index.json"),n.length>0&&"/"!==n.charAt(n.length-1)&&(n+="/"),this.prefixUrl=n;var o=null;if("string"==typeof r){if(!(o=this._requestFileSync(r,"json")))throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else o=r;O(i,t.Name,{index:"string"==typeof r?r:"file index as an object",baseUrl:n}),this._index=Yr.fromListing(o)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){void 0===e.index&&(e.index="index.json"),"string"==typeof e.index?t.FromURL(e.index,r,e.baseUrl,!1):r(null,new t(e.index,e.baseUrl,!1))},t.isAvailable=function(){return"undefined"!=typeof XMLHttpRequest&&null!==XMLHttpRequest},t.FromURL=function(e,r,n,i){void 0===n&&(n=e.slice(0,e.lastIndexOf("/")+1)),void 0===i&&(i=!0),i&&console.warn("[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: \""+e+'", baseUrl: "'+n+"\" }, cb)' instead."),Xr(e,"json",(function(e,i){e?r(e):r(null,new t(i,n,!1))}))},t.prototype.empty=function(){this._index.fileIterator((function(e){e.fileData=null}))},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,t){t(0,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.preloadFile=function(e,t){var r=this._index.getInode(e);if(!Jr(r))throw d.EISDIR(e);if(null===r)throw d.ENOENT(e);var n=r.getData();n.size=t.length,n.fileData=t},t.prototype.stat=function(e,t,r){var n,i=this._index.getInode(e);if(null===i)return r(d.ENOENT(e));Jr(i)?(n=i.getData()).size<0?this._requestFileSizeAsync(e,(function(e,t){if(e)return r(e);n.size=t,r(null,n.clone())})):r(null,n.clone()):Qr(i)?(n=i.getStats(),r(null,n)):r(d.FileError(a.EINVAL,e))},t.prototype.statSync=function(e,t){var r,n=this._index.getInode(e);if(null===n)throw d.ENOENT(e);if(Jr(n))(r=n.getData()).size<0&&(r.size=this._requestFileSizeSync(e));else{if(!Qr(n))throw d.FileError(a.EINVAL,e);r=n.getStats()}return r},t.prototype.open=function(e,t,r,n){if(t.isWriteable())return n(new d(a.EPERM,e));var i=this,o=this._index.getInode(e);if(null===o)return n(d.ENOENT(e));if(!Jr(o))return n(d.EISDIR(e));var s=o.getData();switch(t.pathExistsAction()){case p.THROW_EXCEPTION:case p.TRUNCATE_FILE:return n(d.EEXIST(e));case p.NOP:if(s.fileData)return n(null,new te(i,e,t,s.clone(),s.fileData));this._requestFileAsync(e,"buffer",(function(r,o){return r?n(r):(s.size=o.length,s.fileData=o,n(null,new te(i,e,t,s.clone(),o)))}));break;default:return n(new d(a.EINVAL,"Invalid FileMode object."))}},t.prototype.openSync=function(e,t,r){if(t.isWriteable())throw new d(a.EPERM,e);var n=this._index.getInode(e);if(null===n)throw d.ENOENT(e);if(!Jr(n))throw d.EISDIR(e);var i=n.getData();switch(t.pathExistsAction()){case p.THROW_EXCEPTION:case p.TRUNCATE_FILE:throw d.EEXIST(e);case p.NOP:if(i.fileData)return new te(this,e,t,i.clone(),i.fileData);var o=this._requestFileSync(e,"buffer");return i.size=o.length,i.fileData=o,new te(this,e,t,i.clone(),o);default:throw new d(a.EINVAL,"Invalid FileMode object.")}},t.prototype.readdir=function(e,t){try{t(null,this.readdirSync(e))}catch(ni){t(ni)}},t.prototype.readdirSync=function(e){var t=this._index.getInode(e);if(null===t)throw d.ENOENT(e);if(Qr(t))return t.getListing();throw d.ENOTDIR(e)},t.prototype.readFile=function(e,t,r,n){var i=n;this.open(e,r,420,(function(e,r){if(e)return n(e);n=function(e,t){r.close((function(r){return e||(e=r),i(e,t)}))};var o=r.getBuffer();null===t?n(e,j(o)):function(e,t,r){try{r(null,e.toString(t))}catch(ni){r(ni)}}(o,t,n)}))},t.prototype.readFileSync=function(e,t,r){var n=this.openSync(e,r,420);try{var i=n.getBuffer();return null===t?j(i):i.toString(t)}finally{n.closeSync()}},t.prototype.getXhrPath=function(e){return"/"===e.charAt(0)&&(e=e.slice(1)),this.prefixUrl+e},t.prototype._requestFileAsync=function(e,t,r){Xr(this.getXhrPath(e),t,r)},t.prototype._requestFileSync=function(e,t){return qr(this.getXhrPath(e),t)},t.prototype._requestFileSizeAsync=function(e,t){!function(e,t){Wr(!0,e,t)}(this.getXhrPath(e),t)},t.prototype._requestFileSizeSync=function(e){return t=this.getXhrPath(e),r=-1,Wr(!1,t,(function(e,t){if(e)throw e;r=t})),r;var t,r},t}(Z);en.Name="XmlHttpRequest",en.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var tn=function(){};tn.str2byte=function(e,t){for(var r=e.length>t.length?t.length:e.length,n=0;n<r;n++){var i=e.charCodeAt(n);if(i>127){var o=tn.extendedChars.indexOf(e.charAt(n));o>-1&&(i=o+128)}t[i]=n}return r},tn.byte2str=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++){var n=e[r];t[r]=n>127?tn.extendedChars[n-128]:String.fromCharCode(n)}return t.join("")},tn.byteLength=function(e){return e.length},tn.extendedChars=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","_","_","","","","","","","","","+","+","","","+","+","-","-","+","-","+","","","+","+","-","-","","-","+","","","","","","","i","","","","+","+","_","_","","","_","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","_"," "];var rn,nn,on,an,sn=r(31).inflateRaw,cn={};function un(e,t){return new Date(1980+(t>>9),(t>>5&15)-1,31&t,e>>11,e>>5&63,31&e)}function ln(e,t,r,n){return 0===n?"":t?e.toString("utf8",r,r+n):tn.byte2str(e.slice(r,r+n))}(nn=rn||(rn={}))[nn.MSDOS=0]="MSDOS",nn[nn.AMIGA=1]="AMIGA",nn[nn.OPENVMS=2]="OPENVMS",nn[nn.UNIX=3]="UNIX",nn[nn.VM_CMS=4]="VM_CMS",nn[nn.ATARI_ST=5]="ATARI_ST",nn[nn.OS2_HPFS=6]="OS2_HPFS",nn[nn.MAC=7]="MAC",nn[nn.Z_SYSTEM=8]="Z_SYSTEM",nn[nn.CP_M=9]="CP_M",nn[nn.NTFS=10]="NTFS",nn[nn.MVS=11]="MVS",nn[nn.VSE=12]="VSE",nn[nn.ACORN_RISC=13]="ACORN_RISC",nn[nn.VFAT=14]="VFAT",nn[nn.ALT_MVS=15]="ALT_MVS",nn[nn.BEOS=16]="BEOS",nn[nn.TANDEM=17]="TANDEM",nn[nn.OS_400=18]="OS_400",nn[nn.OSX=19]="OSX",(an=on||(on={}))[an.STORED=0]="STORED",an[an.SHRUNK=1]="SHRUNK",an[an.REDUCED_1=2]="REDUCED_1",an[an.REDUCED_2=3]="REDUCED_2",an[an.REDUCED_3=4]="REDUCED_3",an[an.REDUCED_4=5]="REDUCED_4",an[an.IMPLODE=6]="IMPLODE",an[an.DEFLATE=8]="DEFLATE",an[an.DEFLATE64=9]="DEFLATE64",an[an.TERSE_OLD=10]="TERSE_OLD",an[an.BZIP2=12]="BZIP2",an[an.LZMA=14]="LZMA",an[an.TERSE_NEW=18]="TERSE_NEW",an[an.LZ77=19]="LZ77",an[an.WAVPACK=97]="WAVPACK",an[an.PPMD=98]="PPMD";var pn=function(e){if(this.data=e,67324752!==e.readUInt32LE(0))throw new d(a.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};pn.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},pn.prototype.flags=function(){return this.data.readUInt16LE(6)},pn.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},pn.prototype.lastModFileTime=function(){return un(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},pn.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},pn.prototype.crc32=function(){return this.data.readUInt32LE(14)},pn.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},pn.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},pn.prototype.fileName=function(){return ln(this.data,this.useUTF8(),30,this.fileNameLength())},pn.prototype.extraField=function(){var e=30+this.fileNameLength();return this.data.slice(e,e+this.extraFieldLength())},pn.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},pn.prototype.useUTF8=function(){return 2048==(2048&this.flags())};var fn=function(e,t,r){this.header=e,this.record=t,this.data=r};fn.prototype.decompress=function(){var e=this.header.compressionMethod(),t=cn[e];if(t)return t(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var r=on[e];throw r||(r="Unknown: "+e),new d(a.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+r)},fn.prototype.getHeader=function(){return this.header},fn.prototype.getRecord=function(){return this.record},fn.prototype.getRawData=function(){return this.data};var dn=function(e,t){if(this.zipData=e,this.data=t,33639248!==this.data.readUInt32LE(0))throw new d(a.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};dn.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},dn.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},dn.prototype.flag=function(){return this.data.readUInt16LE(8)},dn.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},dn.prototype.lastModFileTime=function(){return un(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},dn.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},dn.prototype.crc32=function(){return this.data.readUInt32LE(16)},dn.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},dn.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},dn.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},dn.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},dn.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},dn.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},dn.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},dn.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},dn.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},dn.prototype.produceFilename=function(){return ln(this.data,this.useUTF8(),46,this.fileNameLength()).replace(/\\/g,"/")},dn.prototype.fileName=function(){return this._filename},dn.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},dn.prototype.extraField=function(){var e=44+this.fileNameLength();return this.data.slice(e,e+this.extraFieldLength())},dn.prototype.fileComment=function(){var e=46+this.fileNameLength()+this.extraFieldLength();return ln(this.data,this.useUTF8(),e,this.fileCommentLength())},dn.prototype.rawFileComment=function(){var e=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(e,e+this.fileCommentLength())},dn.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},dn.prototype.isDirectory=function(){var e=this.fileName();return!!(16&this.externalAttributes())||"/"===e.charAt(e.length-1)},dn.prototype.isFile=function(){return!this.isDirectory()},dn.prototype.useUTF8=function(){return 2048==(2048&this.flag())},dn.prototype.isEncrypted=function(){return 1==(1&this.flag())},dn.prototype.getFileData=function(){var e=this.headerRelativeOffset(),t=new pn(this.zipData.slice(e));return new fn(t,this,this.zipData.slice(e+t.totalSize()))},dn.prototype.getData=function(){return this.getFileData().decompress()},dn.prototype.getRawData=function(){return this.getFileData().getRawData()},dn.prototype.getStats=function(){return new v(m.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var hn=function(e){if(this.data=e,101010256!==this.data.readUInt32LE(0))throw new d(a.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};hn.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},hn.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},hn.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},hn.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},hn.prototype.cdSize=function(){return this.data.readUInt32LE(12)},hn.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},hn.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},hn.prototype.cdZipComment=function(){return ln(this.data,!0,22,this.cdZipCommentLength())},hn.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var mn=function(e,t,r,n){this.index=e,this.directoryEntries=t,this.eocd=r,this.data=n},gn=function(e){function t(r,n,i){void 0===n&&(n=""),void 0===i&&(i=!0),e.call(this),this.name=n,this._index=new Yr,this._directoryEntries=[],this._eocd=null,O(i,t.Name,{zipData:"zip data as a Buffer",name:n}),r instanceof mn?(this._index=r.index,this._directoryEntries=r.directoryEntries,this._eocd=r.eocd,this.data=r.data):(this.data=r,this.populateIndex())}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{t.computeIndex(e.zipData,(function(n){var i=new t(n,e.name,!1);r(null,i)}),!1)}catch(ni){r(ni)}},t.isAvailable=function(){return!0},t.RegisterDecompressionMethod=function(e,t){cn[e]=t},t.computeIndex=function(e,r,n){void 0===n&&(n=!0),n&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var i=new Yr,o=t.getEOCD(e);if(o.diskNumber()!==o.cdDiskNumber())throw new d(a.EINVAL,"ZipFS does not support spanned zip files.");var s=o.cdOffset();if(4294967295===s)throw new d(a.EINVAL,"ZipFS does not support Zip64.");var c=s+o.cdSize();t.computeIndexResponsive(e,i,s,c,r,[],o)},t.getEOCD=function(e){for(var t=Math.min(65557,e.length-1),r=22;r<t;r++)if(101010256===e.readUInt32LE(e.length-r))return new hn(e.slice(e.length-r));throw new d(a.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},t.addToIndex=function(e,t){var r=e.fileName();if("/"===r.charAt(0))throw new Error("WHY IS THIS ABSOLUTE");"/"===r.charAt(r.length-1)&&(r=r.substr(0,r.length-1)),e.isDirectory()?t.addPathFast("/"+r,new Zr(e)):t.addPathFast("/"+r,new Kr(e))},t.computeIndexResponsive=function(e,r,n,i,o,a,s){if(n<i){for(var c=0;c++<200&&n<i;){var u=new dn(e,e.slice(n));t.addToIndex(u,r),n+=u.totalSize(),a.push(u)}_r((function(){t.computeIndexResponsive(e,r,n,i,o,a,s)}))}else o(new mn(r,a,s,e))},t.prototype.getName=function(){return t.Name+(""!==this.name?" "+this.name:"")},t.prototype.getCentralDirectoryEntry=function(e){var t=this._index.getInode(e);if(null===t)throw d.ENOENT(e);if(Jr(t))return t.getData();if(Qr(t))return t.getData();throw d.EPERM("Invalid inode: "+t)},t.prototype.getCentralDirectoryEntryAt=function(e){var t=this._directoryEntries[e];if(!t)throw new RangeError("Invalid directory index: "+e+".");return t},t.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},t.prototype.getEndOfCentralDirectory=function(){return this._eocd},t.prototype.diskSpace=function(e,t){t(this.data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,t){var r,n=this._index.getInode(e);if(null===n)throw d.ENOENT(e);if(Jr(n))r=n.getData().getStats();else{if(!Qr(n))throw new d(a.EINVAL,"Invalid inode.");r=n.getStats()}return r},t.prototype.openSync=function(e,t,r){if(t.isWriteable())throw new d(a.EPERM,e);var n=this._index.getInode(e);if(!n)throw d.ENOENT(e);if(!Jr(n))throw d.EISDIR(e);var i=n.getData(),o=i.getStats();switch(t.pathExistsAction()){case p.THROW_EXCEPTION:case p.TRUNCATE_FILE:throw d.EEXIST(e);case p.NOP:return new te(this,e,t,o,i.getData());default:throw new d(a.EINVAL,"Invalid FileMode object.")}},t.prototype.readdirSync=function(e){var t=this._index.getInode(e);if(t){if(Qr(t))return t.getListing();throw d.ENOTDIR(e)}throw d.ENOENT(e)},t.prototype.readFileSync=function(e,t,r){var n=this.openSync(e,r,420);try{var i=n.getBuffer();return null===t?j(i):i.toString(t)}finally{n.closeSync()}},t.prototype.populateIndex=function(){var e=this,r=this._eocd=t.getEOCD(this.data);if(r.diskNumber()!==r.cdDiskNumber())throw new d(a.EINVAL,"ZipFS does not support spanned zip files.");var n=r.cdOffset();if(4294967295===n)throw new d(a.EINVAL,"ZipFS does not support Zip64.");for(var i=n+r.cdSize();n<i;){var o=new dn(e.data,e.data.slice(n));n+=o.totalSize(),t.addToIndex(o,e._index),e._directoryEntries.push(o)}},t}(J);function yn(e,t,r){return e.toString("ascii",t,t+r).trim()}function vn(e,t,r){if(1===r)return String.fromCharCode(e[t]);for(var n=Math.floor(r/2),i=new Array(n),o=0;o<n;o++){var a=t+(o<<1);i[o]=String.fromCharCode(e[a+1]|e[a]<<8)}return i.join("")}function _n(e,t){var r=parseInt(yn(e,t,4),10),n=parseInt(yn(e,t+4,2),10),i=parseInt(yn(e,t+6,2),10),o=parseInt(yn(e,t+8,2),10),a=parseInt(yn(e,t+10,2),10),s=parseInt(yn(e,t+12,2),10),c=parseInt(yn(e,t+14,2),10);return new Date(r,n,i,o,a,s,100*c)}function bn(e,t){var r=e[t],n=e[t+1],i=e[t+2],o=e[t+3],a=e[t+4],s=e[t+5];return new Date(r,n-1,i,o,a,s)}function wn(e,t){var r=e.slice(t),n=new Fn(r);switch(n.signatureWord()){case 17221:return new Dn(r);case 20548:return new On(r);case 21328:return new xn(r);case 21332:return new Rn(r);case 17746:return new Mn(r);case 17747:return new Nn(r);case 20568:return new Bn(r);case 20558:return new Ln(r);case 21324:return new Un(r);case 20045:return new jn(r);case 17228:return new Hn(r);case 20556:return new Gn(r);case 21061:return new Vn(r);case 21574:return new Wn(r);case 21318:return new Xn(r);case 21074:return new $n(r);default:return n}}function Tn(e,t,r,n){r-=4;for(var i=new Array;t<r;){var o=wn(e,t),a=o.length();if(0===a)return i;if(t+=a,o instanceof Rn)break;o instanceof Dn?i=i.concat(o.getEntries(n)):i.push(o)}return i}gn.Name="ZipFS",gn.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:V},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},gn.CompressionMethod=on,gn.RegisterDecompressionMethod(on.DEFLATE,(function(e,t,r){return L(sn(e.slice(0,t),{chunkSize:r}))})),gn.RegisterDecompressionMethod(on.STORED,(function(e,t,r){return j(e,0,r)}));var kn=function(e){this._data=e};kn.prototype.type=function(){return this._data[0]},kn.prototype.standardIdentifier=function(){return yn(this._data,1,5)},kn.prototype.version=function(){return this._data[6]},kn.prototype.data=function(){return this._data.slice(7,2048)};var En=function(e){function t(t){e.call(this,t),this._root=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.systemIdentifier=function(){return this._getString32(8)},t.prototype.volumeIdentifier=function(){return this._getString32(40)},t.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},t.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},t.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},t.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},t.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},t.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},t.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},t.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},t.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},t.prototype.rootDirectoryEntry=function(e){return null===this._root&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root},t.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},t.prototype.publisherIdentifier=function(){return this._getString(318,128)},t.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},t.prototype.applicationIdentifier=function(){return this._getString(574,128)},t.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},t.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},t.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},t.prototype.volumeCreationDate=function(){return _n(this._data,813)},t.prototype.volumeModificationDate=function(){return _n(this._data,830)},t.prototype.volumeExpirationDate=function(){return _n(this._data,847)},t.prototype.volumeEffectiveDate=function(){return _n(this._data,864)},t.prototype.fileStructureVersion=function(){return this._data[881]},t.prototype.applicationUsed=function(){return this._data.slice(883,1395)},t.prototype.reserved=function(){return this._data.slice(1395,2048)},t.prototype._getString32=function(e){return this._getString(e,32)},t}(kn),Sn=function(e){function t(t){if(e.call(this,t),1!==this.type())throw new d(a.EIO,"Invalid primary volume descriptor.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"ISO9660"},t.prototype._constructRootDirectoryRecord=function(e){return new An(e,-1)},t.prototype._getString=function(e,t){return this._getString(e,t)},t}(En),In=function(e){function t(t){if(e.call(this,t),2!==this.type())throw new d(a.EIO,"Invalid supplementary volume descriptor.");var r=this.escapeSequence(),n=r[2];if(37!==r[0]||47!==r[1]||64!==n&&67!==n&&69!==n)throw new d(a.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+r.toString())}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"Joliet"},t.prototype.escapeSequence=function(){return this._data.slice(88,120)},t.prototype._constructRootDirectoryRecord=function(e){return new Cn(e,-1)},t.prototype._getString=function(e,t){return vn(this._data,e,t)},t}(En),Pn=function(e,t){this._suEntries=null,this._fileOrDir=null,this._data=e,this._rockRidgeOffset=t};Pn.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},Pn.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},Pn.prototype.rootCheckForRockRidge=function(e){var t=this.getDirectory(e);this._rockRidgeOffset=t.getDotEntry(e)._getRockRidgeOffset(e),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},Pn.prototype.length=function(){return this._data[0]},Pn.prototype.extendedAttributeRecordLength=function(){return this._data[1]},Pn.prototype.lba=function(){return 2048*this._data.readUInt32LE(2)},Pn.prototype.dataLength=function(){return this._data.readUInt32LE(10)},Pn.prototype.recordingDate=function(){return bn(this._data,18)},Pn.prototype.fileFlags=function(){return this._data[25]},Pn.prototype.fileUnitSize=function(){return this._data[26]},Pn.prototype.interleaveGapSize=function(){return this._data[27]},Pn.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},Pn.prototype.identifier=function(){return this._getString(33,this._data[32])},Pn.prototype.fileName=function(e){if(this.hasRockRidge()){var t=this._rockRidgeFilename(e);if(null!==t)return t}var r=this.identifier();if(this.isDirectory(e))return r;var n=r.indexOf(";");return-1===n?r:"."===r[n-1]?r.slice(0,n-1):r.slice(0,n)},Pn.prototype.isDirectory=function(e){var t=!!(2&this.fileFlags());return!t&&this.hasRockRidge()&&(t=this.getSUEntries(e).filter((function(e){return e instanceof Hn})).length>0),t},Pn.prototype.isSymlink=function(e){return this.hasRockRidge()&&this.getSUEntries(e).filter((function(e){return e instanceof Un})).length>0},Pn.prototype.getSymlinkPath=function(e){for(var t="",r=this.getSUEntries(e),n=this._getGetString(),i=0,o=r;i<o.length;i+=1){var a=o[i];if(a instanceof Un){for(var s=0,c=a.componentRecords();s<c.length;s+=1){var u=c[s],l=u.flags();2&l?t+="./":4&l?t+="../":8&l?t+="/":(t+=u.content(n),1&l||(t+="/"))}if(!a.continueFlag())break}}return t.length>1&&"/"===t[t.length-1]?t.slice(0,t.length-1):t},Pn.prototype.getFile=function(e){if(this.isDirectory(e))throw new Error("Tried to get a File from a directory.");return null===this._fileOrDir&&(this._fileOrDir=e.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},Pn.prototype.getDirectory=function(e){if(!this.isDirectory(e))throw new Error("Tried to get a Directory from a file.");return null===this._fileOrDir&&(this._fileOrDir=this._constructDirectory(e)),this._fileOrDir},Pn.prototype.getSUEntries=function(e){return this._suEntries||this._constructSUEntries(e),this._suEntries},Pn.prototype._rockRidgeFilename=function(e){var t=this.getSUEntries(e).filter((function(e){return e instanceof jn}));if(0===t.length||6&t[0].flags())return null;for(var r="",n=this._getGetString(),i=0,o=t;i<o.length;i+=1){var a=o[i];if(r+=a.name(n),!(1&a.flags()))break}return r},Pn.prototype._constructSUEntries=function(e){var t=33+this._data[32];t%2==1&&t++,t+=this._rockRidgeOffset,this._suEntries=Tn(this._data,t,this.length(),e)},Pn.prototype._getRockRidgeOffset=function(e){this._rockRidgeOffset=0;var t=this.getSUEntries(e);if(t.length>0){var r=t[0];if(r instanceof xn&&r.checkBytesPass())for(var n=1;n<t.length;n++){var i=t[n];if(i instanceof $n||i instanceof Mn&&"IEEE_P1282"===i.extensionIdentifier())return r.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var An=function(e){function t(t,r){e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,t){return yn(this._data,e,t)},t.prototype._constructDirectory=function(e){return new Yn(this,e)},t.prototype._getGetString=function(){return yn},t}(Pn),Cn=function(e){function t(t,r){e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,t){return vn(this._data,e,t)},t.prototype._constructDirectory=function(e){return new Kn(this,e)},t.prototype._getGetString=function(){return vn},t}(Pn),Fn=function(e){this._data=e};Fn.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Fn.prototype.signatureWordString=function(){return yn(this._data,0,2)},Fn.prototype.length=function(){return this._data[2]},Fn.prototype.suVersion=function(){return this._data[3]};var Dn=function(e){function t(t){e.call(this,t),this._entries=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},t.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},t.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},t.prototype.getEntries=function(e){if(!this._entries){var t=2048*this.continuationLba()+this.continuationLbaOffset();this._entries=Tn(e,t,this.continuationLength(),e)}return this._entries},t}(Fn),On=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Fn),xn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.checkBytesPass=function(){return 190===this._data[4]&&239===this._data[5]},t.prototype.bytesSkipped=function(){return this._data[6]},t}(Fn),Rn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Fn),Mn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.identifierLength=function(){return this._data[4]},t.prototype.descriptorLength=function(){return this._data[5]},t.prototype.sourceLength=function(){return this._data[6]},t.prototype.extensionVersion=function(){return this._data[7]},t.prototype.extensionIdentifier=function(){return yn(this._data,8,this.identifierLength())},t.prototype.extensionDescriptor=function(){return yn(this._data,8+this.identifierLength(),this.descriptorLength())},t.prototype.extensionSource=function(){return yn(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},t}(Fn),Nn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.extensionSequence=function(){return this._data[4]},t}(Fn),$n=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Fn),Bn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.mode=function(){return this._data.readUInt32LE(4)},t.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},t.prototype.uid=function(){return this._data.readUInt32LE(20)},t.prototype.gid=function(){return this._data.readUInt32LE(28)},t.prototype.inode=function(){return this._data.readUInt32LE(36)},t}(Fn),Ln=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},t.prototype.devTLow=function(){return this._data.readUInt32LE(12)},t}(Fn),Un=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.continueFlag=function(){return 1&this.flags()},t.prototype.componentRecords=function(){for(var e=new Array,t=5;t<this.length();){var r=new zn(this._data.slice(t));e.push(r),t+=r.length()}return e},t}(Fn),zn=function(e){this._data=e};zn.prototype.flags=function(){return this._data[0]},zn.prototype.length=function(){return 2+this.componentLength()},zn.prototype.componentLength=function(){return this._data[1]},zn.prototype.content=function(e){return e(this._data,2,this.componentLength())};var jn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.name=function(e){return e(this._data,5,this.length()-5)},t}(Fn),Hn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Fn),Gn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Fn),Vn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Fn),Wn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.creation=function(){return 1&this.flags()?this._longFormDates()?_n(this._data,5):bn(this._data,5):null},t.prototype.modify=function(){if(2&this.flags()){var e=1&this.flags()?1:0;return this._longFormDates?_n(this._data,5+17*e):bn(this._data,5+7*e)}return null},t.prototype.access=function(){if(4&this.flags()){var e=1&this.flags()?1:0;return e+=2&this.flags()?1:0,this._longFormDates?_n(this._data,5+17*e):bn(this._data,5+7*e)}return null},t.prototype.backup=function(){if(16&this.flags()){var e=1&this.flags()?1:0;return e+=2&this.flags()?1:0,e+=4&this.flags()?1:0,this._longFormDates?_n(this._data,5+17*e):bn(this._data,5+7*e)}return null},t.prototype.expiration=function(){if(32&this.flags()){var e=1&this.flags()?1:0;return e+=2&this.flags()?1:0,e+=4&this.flags()?1:0,e+=16&this.flags()?1:0,this._longFormDates?_n(this._data,5+17*e):bn(this._data,5+7*e)}return null},t.prototype.effective=function(){if(64&this.flags()){var e=1&this.flags()?1:0;return e+=2&this.flags()?1:0,e+=4&this.flags()?1:0,e+=16&this.flags()?1:0,e+=32&this.flags()?1:0,this._longFormDates?_n(this._data,5+17*e):bn(this._data,5+7*e)}return null},t.prototype._longFormDates=function(){return!!this.flags()},t}(Fn),Xn=function(e){function t(t){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},t.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},t.prototype.tableDepth=function(){return this._data[20]},t}(Fn),qn=function(e,t){var r=this;this._fileList=[],this._fileMap={},this._record=e;var n=e.lba(),i=n+e.dataLength();for(2&e.fileFlags()||(n=2048*e.getSUEntries(t).filter((function(e){return e instanceof Hn}))[0].childDirectoryLba(),i=1/0);n<i;)if(0!==t[n]){var o=r._constructDirectoryRecord(t.slice(n)),a=o.fileName(t);"\0"!==a&&""!==a?o.hasRockRidge()&&0!==o.getSUEntries(t).filter((function(e){return e instanceof Vn})).length||(r._fileMap[a]=o,r._fileList.push(a)):i===1/0&&(i=n+o.dataLength()),n+=o.length()}else n++};qn.prototype.getRecord=function(e){return this._fileMap[e]},qn.prototype.getFileList=function(){return this._fileList},qn.prototype.getDotEntry=function(e){return this._constructDirectoryRecord(e.slice(this._record.lba()))};var Yn=function(e){function t(t,r){e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new An(e,this._record.getRockRidgeOffset())},t}(qn),Kn=function(e){function t(t,r){e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Cn(e,this._record.getRockRidgeOffset())},t}(qn),Zn=function(e){function t(r,n,i){var o=this;void 0===n&&(n=""),void 0===i&&(i=!0),e.call(this),this._data=r,O(i,t.Name,{data:"ISO data as a Buffer",name:n});for(var s=!1,c=32768,u=new Array;!s;){var l=r.slice(c);switch(new kn(l).type()){case 1:u.push(new Sn(l));break;case 2:u.push(new In(l));break;case 255:s=!0}c+=2048}if(0===u.length)throw new d(a.EIO,"Unable to find a suitable volume descriptor.");u.forEach((function(e){o._pvd&&2===o._pvd.type()||(o._pvd=e)})),this._root=this._pvd.rootDirectoryEntry(r),this._name=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.Create=function(e,r){var n;try{n=new t(e.data,e.name,!1)}catch(i){i=i}finally{r(void 0,n)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){var e="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e},t.prototype.diskSpace=function(e,t){t(this._data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,t){var r=this._getDirectoryRecord(e);if(null===r)throw d.ENOENT(e);return this._getStats(e,r)},t.prototype.openSync=function(e,t,r){if(t.isWriteable())throw new d(a.EPERM,e);var n=this._getDirectoryRecord(e);if(!n)throw d.ENOENT(e);if(n.isSymlink(this._data))return this.openSync(u.resolve(e,n.getSymlinkPath(this._data)),t,r);if(n.isDirectory(this._data))throw d.EISDIR(e);var i=n.getFile(this._data),o=this._getStats(e,n);switch(t.pathExistsAction()){case p.THROW_EXCEPTION:case p.TRUNCATE_FILE:throw d.EEXIST(e);case p.NOP:return new te(this,e,t,o,i);default:throw new d(a.EINVAL,"Invalid FileMode object.")}},t.prototype.readdirSync=function(e){var t=this._getDirectoryRecord(e);if(t){if(t.isDirectory(this._data))return t.getDirectory(this._data).getFileList().slice(0);throw d.ENOTDIR(e)}throw d.ENOENT(e)},t.prototype.readFileSync=function(e,t,r){var n=this.openSync(e,r,420);try{var i=n.getBuffer();return null===t?j(i):i.toString(t)}finally{n.closeSync()}},t.prototype._getDirectoryRecord=function(e){if("/"===e)return this._root;for(var t=e.split("/").slice(1),r=this._root,n=0,i=t;n<i.length;n+=1){var o=i[n];if(!r.isDirectory(this._data))return null;if(!(r=r.getDirectory(this._data).getRecord(o)))return null}return r},t.prototype._getStats=function(e,t){if(t.isSymlink(this._data)){var r=u.resolve(e,t.getSymlinkPath(this._data)),n=this._getDirectoryRecord(r);return n?this._getStats(r,n):null}var i=t.dataLength(),o=365,a=t.recordingDate(),s=a,c=a,l=a;if(t.hasRockRidge())for(var p=0,f=t.getSUEntries(this._data);p<f.length;p+=1){var d=f[p];if(d instanceof Bn)o=d.mode();else if(d instanceof Wn){var h=d.flags();4&h&&(s=d.access()),2&h&&(c=d.modify()),1&h&&(l=d.creation())}}return o&=365,new v(t.isDirectory(this._data)?m.DIRECTORY:m.FILE,i,o,s,c,l)},t}(J);Zn.Name="IsoFS",Zn.Options={data:{type:"object",description:"The ISO file in a buffer",validator:V}},[ne,Tt,St,It,Rt,qt,tr,Zn,or,ar,Cr,Vr,en,gn].forEach((function(e){var t=e.Create;e.Create=function(r,n){var i="function"==typeof r,o=i?r:n,a=i?{}:r;W(e,a,(function(r){r?o(r):t.call(e,a,o)}))}}));var Jn,Qn={AsyncMirror:ne,Dropbox:Tt,Emscripten:St,FolderAdapter:It,HTML5FS:Rt,InMemory:qt,IndexedDB:tr,IsoFS:Zn,LocalStorage:or,MountableFileSystem:ar,OverlayFS:Cr,WorkerFS:Vr,XmlHttpRequest:en,ZipFS:gn};function ei(e){switch(e){case"fs":return A;case"path":return u;case"buffer":return c;case"process":return o;case"bfs_utils":return X;default:return Qn[e]}}function ti(e){return A.initialize(e)}function ri(e,t){var r=e.fs;if(!r)return t(new d(a.EPERM,'Missing "fs" property on configuration object.'));var n=e.options,i=0,o=!1;function s(){if(!o){o=!0;var e=Qn[r];e?e.Create(n,t):t(new d(a.EPERM,"File system "+r+" is not available in BrowserFS."))}}if(null!==n&&"object"==typeof n){var c=!1;Object.keys(n).filter((function(e){return"fs"!==e})).forEach((function(e){var r=n[e];null!==r&&"object"==typeof r&&r.fs&&(i++,ri(r,(function(r,a){if(i--,r){if(o)return;o=!0,t(r)}else n[e]=a,0===i&&c&&s()})))})),c=!0}0===i&&s()}o.initializeTTYs&&o.initializeTTYs(),"b"!=="ab".substr(-1)&&(String.prototype.substr=(Jn=String.prototype.substr,function(e,t){return e<0&&(e=this.length+e),Jn.call(this,e,t)})),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e<0&&(e=this.length+e)<0&&(e=0),t<0&&(t=this.length+t)<0&&(t=0),t<e&&(t=e),new Uint8Array(this.buffer,this.byteOffset+e,t-e)})),t.install=function(t){t.Buffer=e,t.process=o;var r=t.require?t.require:null;t.require=function(e){var t=ei(e);return t||r.apply(null,Array.prototype.slice.call(arguments,0))}},t.registerFileSystem=function(e,t){Qn[e]=t},t.BFSRequire=ei,t.initialize=ti,t.configure=function(e,t){ri(e,(function(e,r){r?(ti(r),t()):t(e)}))},t.getFileSystem=ri,t.EmscriptenFS=K,t.FileSystem=Qn,t.Errors=h,t.setImmediate=_r}).call(t,r(1),function(){return this}(),r(5)(e),r(6))},function(e,t,r){e.exports=r(2).Buffer},function(e,t,r){(function(e){
/*!
          * The buffer module from node.js, for the browser.
          *
          * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
          * @license  MIT
          */
var n=r(3),i=r(4);t.Buffer=e,t.SlowBuffer=function(t){return+t!=t&&(t=0),e.alloc(+t)},t.INSPECT_MAX_BYTES=50;var o=2147483647;function a(t){if(t>o)throw new RangeError("Invalid typed array length");var r=new Uint8Array(t);return r.__proto__=e.prototype,r}function e(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(e)}return s(e,t,r)}function s(t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return L(t)?function(t,r,n){if(r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");var i;return(i=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n)).__proto__=e.prototype,i}(t,r,n):"string"==typeof t?function(t,r){if("string"==typeof r&&""!==r||(r="utf8"),!e.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(t,r),i=a(n),o=i.write(t,r);return o!==n&&(i=i.slice(0,o)),i}(t,r):function(t){if(e.isBuffer(t)){var r=0|p(t.length),n=a(r);return 0===n.length||t.copy(n,0,0,r),n}if(t){if(U(t)||"length"in t)return"number"!=typeof t.length||z(t.length)?a(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e){return c(e),a(e<0?0:0|p(e))}function l(e){for(var t=e.length<0?0:0|p(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function f(t,r){if(e.isBuffer(t))return t.length;if(U(t)||L(t))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(t).length;default:if(i)return N(t).length;r=(""+r).toLowerCase(),i=!0}}function d(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return P(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function h(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(t,r,n,i,o){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),z(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=e.from(r,i)),e.isBuffer(r))return 0===r.length?-1:g(t,r,n,i,o);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,r,n):Uint8Array.prototype.lastIndexOf.call(t,r,n):g(t,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var o,a=1,s=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+c>s&&(r=s-c),o=r;o>=0;o--){for(var p=!0,f=0;f<c;f++)if(u(e,o+f)!==u(t,f)){p=!1;break}if(p)return o}return-1}function y(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(z(s))return a;e[r+a]=s}return a}function v(e,t,r,n){return B(N(t,e.length-r),e,r,n)}function _(e,t,r,n){return B(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return _(e,t,r,n)}function w(e,t,r,n){return B($(t),e,r,n)}function T(e,t,r,n){return B(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,c,u=e[i],l=null,p=u>239?4:u>223?3:u>191?2:1;if(i+p<=r)switch(p){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,p=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=p}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=S));return r}(n)}t.kMaxLength=o,e.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),e.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(e,t,r){return s(e,t,r)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},e.allocUnsafe=function(e){return u(e)},e.allocUnsafeSlow=function(e){return u(e)},e.isBuffer=function(e){return null!=e&&!0===e._isBuffer},e.compare=function(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var n=t.length,i=r.length,o=0,a=Math.min(n,i);o<a;++o)if(t[o]!==r[o]){n=t[o],i=r[o];break}return n<i?-1:i<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var i=e.allocUnsafe(r),o=0;for(n=0;n<t.length;++n){var a=t[n];if(!e.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},e.byteLength=f,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},e.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):d.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,r,n,i,o){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(this===t)return 0;for(var a=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(r>>>=0),c=Math.min(a,s),u=this.slice(i,o),l=t.slice(r,n),p=0;p<c;++p)if(u[p]!==l[p]){a=u[p],s=l[p];break}return a<s?-1:s<a?1:0},e.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},e.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},e.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},e.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return _(this,e,t,r);case"latin1":case"binary":return b(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function I(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function P(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function A(e,t,r){var n,i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var o="",a=t;a<r;++a)o+=(n=e[a])<16?"0"+n.toString(16):n.toString(16);return o}function C(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function F(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function D(t,r,n,i,o,a){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<a)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function O(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function x(e,t,r,n,o){return t=+t,r>>>=0,o||O(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function R(e,t,r,n,o){return t=+t,r>>>=0,o||O(e,0,r,8),i.write(e,t,r,n,52,8),r+8}e.prototype.slice=function(t,r){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t);var i=this.subarray(t,r);return i.__proto__=e.prototype,i},e.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},e.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},e.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),i.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),i.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),i.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),i.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||D(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||D(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},e.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,1,255,0),this[t]=255&e,t+1},e.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},e.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},e.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},e.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},e.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeFloatLE=function(e,t,r){return x(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return x(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return R(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return R(this,e,t,!1,r)},e.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},e.prototype.fill=function(t,r,n,i){if("string"==typeof t){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!e.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var a;if(r>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=r;a<n;++a)this[a]=t;else{var s=e.isBuffer(t)?t:new e(t,i),c=s.length;for(a=0;a<n-r;++a)this[a+r]=s[a%c]}return this};var M=/[^+/0-9A-Za-z-_]/g;function N(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function $(e){return n.toByteArray(function(e){if((e=e.trim().replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function L(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function U(e){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(e)}function z(e){return e!=e}}).call(t,r(1))},function(e,t){t.byteLength=function(e){return 3*e.length/4-c(e)},t.toByteArray=function(e){var t,r,o,a,s,u,l=e.length;s=c(e),u=new i(3*l/4-s),o=s>0?l-4:l;var p=0;for(t=0,r=0;t<o;t+=4,r+=3)a=n[e.charCodeAt(t)]<<18|n[e.charCodeAt(t+1)]<<12|n[e.charCodeAt(t+2)]<<6|n[e.charCodeAt(t+3)],u[p++]=a>>16&255,u[p++]=a>>8&255,u[p++]=255&a;return 2===s?(a=n[e.charCodeAt(t)]<<2|n[e.charCodeAt(t+1)]>>4,u[p++]=255&a):1===s&&(a=n[e.charCodeAt(t)]<<10|n[e.charCodeAt(t+1)]<<4|n[e.charCodeAt(t+2)]>>2,u[p++]=a>>8&255,u[p++]=255&a),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o="",a=[],s=16383,c=0,l=n-i;c<l;c+=s)a.push(u(e,c,c+s>l?l:c+s));return 1===i?(t=e[n-1],o+=r[t>>2],o+=r[t<<4&63],o+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],o+=r[t>>10],o+=r[t>>4&63],o+=r[t<<2&63],o+="="),a.push(o),a.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function u(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16)+(e[s+1]<<8)+e[s+2],a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,c=(1<<s)-1,u=c>>1,l=-7,p=r?i-1:0,f=r?-1:1,d=e[t+p];for(p+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+p],p+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+p],p+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=u}return(d?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,p=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+p>=1?f/c:f*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=l?(s=0,a=l):a+p>=1?(s=(t*c-1)*Math.pow(2,i),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+d]=255&a,d+=h,a/=256,u-=8);e[r+d-h]|=128*m}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,r){var n=new(r(7)),i={};function o(e){i[e]||("function"==typeof n[e]?i[e]=function(){return n[e].apply(n,arguments)}:i[e]=n[e])}for(var a in n)o(a);i.initializeTTYs=function(){null===n.stdin&&(n.initializeTTYs(),i.stdin=n.stdin,i.stdout=n.stdout,i.stderr=n.stderr)},n.nextTick((function(){i.initializeTTYs()})),e.exports=i},function(e,t,r){(function(t){var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=r(8),o=null,a=function(){function e(e,t){this.fun=e,this.array=t}return e.prototype.run=function(){this.fun.apply(null,this.array)},e}(),s=function(){function e(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return e.prototype.push=function(e){var t=this;1!==this._queue.push(e)||this._draining||setTimeout((function(){return t._drainQueue()}),0)},e.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},e.prototype._drainQueue=function(){var e=this;if(!this._draining){var t=setTimeout((function(){return e._cleanUpNextTick()}));this._draining=!0;for(var r=this._queue.length;r;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<r;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,r=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(t)}},e}(),c=function(e){function i(){e.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new s,this.execPath=t,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=1e3*Math.random()|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return n(i,e),i.prototype.chdir=function(e){null===o&&(o=r(9)),this._cwd=o.resolve(e)},i.prototype.cwd=function(){return this._cwd},i.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},i.prototype.nextTick=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._queue.push(new a(e,t))},i.prototype.abort=function(){this.emit("abort")},i.prototype.exit=function(e){this.exitCode=e,this.emit("exit",[e])},i.prototype.getgid=function(){return this._gid},i.prototype.setgid=function(e){this._gid="number"==typeof e?e:1},i.prototype.getuid=function(){return this._uid},i.prototype.setuid=function(e){this._uid="number"==typeof e?e:1},i.prototype.kill=function(e,t){this.emit("kill",[e,t])},i.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},i.prototype.umask=function(e){void 0===e&&(e=this._mask);var t=this._mask;return this._mask=e,this.emit("umask",[e]),t},i.prototype.hrtime=function(){var e,t=(e="undefined"!=typeof performance?performance.now():Date.now?Date.now():(new Date).getTime())/1e3|0;return[t,e=1e6*(e-=1e3*t)|0]},i.prototype.initializeTTYs=function(){if(null===this.stdout){var e=r(10);this.stdout=new e,this.stderr=new e,this.stdin=new e}},i.prototype.disconnect=function(){},i}(i.EventEmitter);e.exports=c}).call(t,"/")},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,a,s,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(i(r))for(s=Array.prototype.slice.call(arguments,1),a=(u=r.slice()).length,c=0;c<a;c++)u[c].apply(this,s);return!0},r.prototype.addListener=function(e,t){var a;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(a=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},r.prototype.removeListener=function(e,t){var r,o,a,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(r=this._events[e]).length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(s=a;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){o=s;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){(function(t){var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,n=function(){function e(){}return e.normalize=function(t){""===t&&(t=".");for(var r=t.charAt(0)===e.sep,n=(t=e._removeDuplicateSeps(t)).split(e.sep),i=[],o=0;o<n.length;o++){var a=n[o];"."!==a&&(".."===a&&(r||!r&&i.length>0&&".."!==i[0])?i.pop():i.push(a))}if(!r&&i.length<2)switch(i.length){case 1:""===i[0]&&i.unshift(".");break;default:i.push(".")}return t=i.join(e.sep),r&&t.charAt(0)!==e.sep&&(t=e.sep+t),t},e.join=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];for(var n=[],i=0;i<t.length;i++){var o=t[i];if("string"!=typeof o)throw new TypeError("Invalid argument type to path.join: "+typeof o);""!==o&&n.push(o)}return e.normalize(n.join(e.sep))},e.resolve=function(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];for(var i=[],o=0;o<r.length;o++){var a=r[o];if("string"!=typeof a)throw new TypeError("Invalid argument type to path.join: "+typeof a);""!==a&&(a.charAt(0)===e.sep&&(i=[]),i.push(a))}var s=e.normalize(i.join(e.sep));if(s.length>1&&s.charAt(s.length-1)===e.sep)return s.substr(0,s.length-1);if(s.charAt(0)!==e.sep){"."!==s.charAt(0)||1!==s.length&&s.charAt(1)!==e.sep||(s=1===s.length?"":s.substr(2));var c=t.cwd();s=""!==s?this.normalize(c+("/"!==c?e.sep:"")+s):c}return s},e.relative=function(t,r){var n;t=e.resolve(t),r=e.resolve(r);var i=t.split(e.sep),o=r.split(e.sep);o.shift(),i.shift();var a=0,s=[];for(n=0;n<i.length;n++)if(i[n]!==o[n]){a=i.length-n;break}s=o.slice(n),1===i.length&&""===i[0]&&(a=0),a>i.length&&(a=i.length);var c="";for(n=0;n<a;n++)c+="../";return(c+=s.join(e.sep)).length>1&&c.charAt(c.length-1)===e.sep&&(c=c.substr(0,c.length-1)),c},e.dirname=function(t){var r=(t=e._removeDuplicateSeps(t)).charAt(0)===e.sep,n=t.split(e.sep);return""===n.pop()&&n.length>0&&n.pop(),n.length>1||1===n.length&&!r?n.join(e.sep):r?e.sep:"."},e.basename=function(t,r){if(void 0===r&&(r=""),""===t)return t;var n=(t=e.normalize(t)).split(e.sep),i=n[n.length-1];return""===i&&n.length>1?n[n.length-2]:r.length>0&&i.substr(i.length-r.length)===r?i.substr(0,i.length-r.length):i},e.extname=function(t){var r=(t=e.normalize(t)).split(e.sep);if(""===(t=r.pop())&&r.length>0&&(t=r.pop()),".."===t)return"";var n=t.lastIndexOf(".");return-1===n||0===n?"":t.substr(n)},e.isAbsolute=function(t){return t.length>0&&t.charAt(0)===e.sep},e._makeLong=function(e){return e},e.parse=function(e){var t,n,i=(t=e,(n=r.exec(t)).shift(),n);return{root:i[0],dir:i[0]+i[1].slice(0,-1),base:i[2],ext:i[3],name:i[2].slice(0,i[2].length-i[3].length)}},e.format=function(t){if(null===t||"object"!=typeof t)throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);if("string"!=typeof(t.root||""))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);return(t.dir?t.dir+e.sep:"")+(t.base||"")},e._removeDuplicateSeps=function(e){return e=e.replace(this._replaceRegex,this.sep)},e.sep="/",e._replaceRegex=new RegExp("//+","g"),e.delimiter=":",e.posix=e,e.win32=e,e}();e.exports=n}).call(t,r(6))},function(e,t,r){(function(t){var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=function(e){function r(){e.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return n(r,e),r.prototype.setRawMode=function(e){this.isRaw!==e&&(this.isRaw=e,this.emit("modeChange"))},r.prototype.changeColumns=function(e){e!==this.columns&&(this.columns=e,this.emit("resize"))},r.prototype.changeRows=function(e){e!==this.rows&&(this.rows=e,this.emit("resize"))},r.isatty=function(e){return e&&e instanceof r},r.prototype._write=function(e,r,n){var i;try{var o;o="string"==typeof e?new t(e,r):e,this._bufferedWrites.push(o),this._waitingForWrites&&this._read(1024)}catch(a){i=a}finally{n(i)}},r.prototype._read=function(e){if(0===this._bufferedWrites.length)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),this._waitingForWrites););},r}(r(11).Duplex);e.exports=i}).call(t,r(1))},function(e,t,r){e.exports=i;var n=r(8).EventEmitter;function i(){n.call(this)}r(12)(i,n),i.Readable=r(13),i.Writable=r(27),i.Duplex=r(28),i.Transform=r(29),i.PassThrough=r(30),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",c));var a=!1;function s(){a||(a=!0,e.end())}function c(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(l(),0===n.listenerCount(this,"error"))throw e}function l(){r.removeListener("data",i),e.removeListener("drain",o),r.removeListener("end",s),r.removeListener("close",c),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("error",u),e.on("error",u),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){(function(n){var i=function(){try{return r(11)}catch(e){}}();(t=e.exports=r(14)).Stream=i||t,t.Readable=t,t.Writable=r(22),t.Duplex=r(21),t.Transform=r(25),t.PassThrough=r(26),!n.browser&&"disable"==={}.READABLE_STREAM&&i&&(e.exports=i)}).call(t,r(6))},function(e,t,r){(function(t){e.exports=g;var n,i=r(15),o=r(16);g.ReadableState=m,r(8).EventEmitter;var a,s=function(e,t){return e.listeners(t).length};!function(){try{a=r(11)}catch(e){}finally{a||(a=r(8).EventEmitter)}}();var c=r(2).Buffer,u=r(17),l=r(18);l.inherits=r(12);var p=r(19),f=void 0;f=p&&p.debuglog?p.debuglog("stream"):function(){};var d,h=r(20);function m(e,t){n=n||r(21),e=e||{},this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=r(24).StringDecoder),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function g(e){if(n=n||r(21),!(this instanceof g))return new g(e);this._readableState=new m(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),a.call(this)}function y(e,t,r,n,o){var a=function(e,t){var r=null;return c.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}(t,r);if(a)e.emit("error",a);else if(null===r)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,b(e)}}(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!o){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&o){var u=new Error("stream.unshift() after end event");e.emit("error",u)}else{var l;!t.decoder||o||n||(r=t.decoder.write(r),l=!t.objectMode&&0===r.length),o||(t.reading=!1),l||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,o?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&b(e))),function(e,t){t.readingMore||(t.readingMore=!0,i(T,e,t))}(e,t)}else o||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}l.inherits(g,a),g.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),y(this,r,e,t,!1)},g.prototype.unshift=function(e){return y(this,this._readableState,e,"",!0)},g.prototype.isPaused=function(){return!1===this._readableState.flowing},g.prototype.setEncoding=function(e){return d||(d=r(24).StringDecoder),this._readableState.decoder=new d(e),this._readableState.encoding=e,this};var v=8388608;function _(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=v?e=v:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function b(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i(w,e):w(e))}function w(e){f("emit readable"),e.emit("readable"),S(e)}function T(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function k(e){f("readable nexttick read 0"),e.read(0)}function E(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),S(e),t.flowing&&!t.reading&&e.read(0)}function S(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0==(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=u.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0==(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}(e,t),n}(e,t.buffer,t.decoder),r);var r}function P(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i(A,t,e))}function A(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function C(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}g.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?P(this):b(this),null;if(0===(e=_(e,t))&&t.ended)return 0===t.length&&P(this),null;var n,i=t.needReadable;return f("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",i=!0),t.ended||t.reading?f("reading or ended",i=!1):i&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=_(r,t))),null===(n=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&P(this)),null!==n&&this.emit("data",n),n},g.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},g.prototype.pipe=function(e,r){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,r);var c=r&&!1===r.end||e===t.stdout||e===t.stderr?h:l;function u(e){f("onunpipe"),e===n&&h()}function l(){f("onend"),e.end()}a.endEmitted?i(c):n.once("end",c),e.on("unpipe",u);var p=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,S(e))}}(n);e.on("drain",p);var d=!1;function h(){f("cleanup"),e.removeListener("close",v),e.removeListener("finish",_),e.removeListener("drain",p),e.removeListener("error",y),e.removeListener("unpipe",u),n.removeListener("end",l),n.removeListener("end",h),n.removeListener("data",g),d=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||p()}var m=!1;function g(t){f("ondata"),m=!1,!1!==e.write(t)||m||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==C(a.pipes,e))&&!d&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,m=!0),n.pause())}function y(t){f("onerror",t),b(),e.removeListener("error",y),0===s(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",_),b()}function _(){f("onfinish"),e.removeListener("close",v),b()}function b(){f("unpipe"),n.unpipe(e)}return n.on("data",g),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",y),e.once("close",v),e.once("finish",_),e.emit("pipe",n),a.flowing||(f("pipe resume"),n.resume()),e},g.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=C(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},g.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&b(this):i(k,this))}return r},g.prototype.addListener=g.prototype.on,g.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i(E,e,t))}(this,e)),this},g.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},g.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",(function(){if(f("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(i){f("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return function(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}(["error","close","destroy","pause","resume"],(function(t){e.on(t,n.emit.bind(n,t))})),n._read=function(t){f("wrapped _read",t),r&&(r=!1,e.resume())},n},g._fromList=I}).call(t,r(6))},function(e,t,r){(function(t){!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports=function(e,r,n,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,r)}));case 3:return t.nextTick((function(){e.call(null,r,n)}));case 4:return t.nextTick((function(){e.call(null,r,n,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick((function(){e.apply(null,o)}))}}:e.exports=t.nextTick}).call(t,r(6))},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){(function(e){var n=r(2),i=n.Buffer,o=n.SlowBuffer,a=n.kMaxLength||2147483647;t.alloc=function(e,t,r){if("function"==typeof i.alloc)return i.alloc(e,t,r);if("number"==typeof r)throw new TypeError("encoding must not be number");if("number"!=typeof e)throw new TypeError("size must be a number");if(e>a)throw new RangeError("size is too large");var n=r,o=t;void 0===o&&(n=void 0,o=0);var s=new i(e);if("string"==typeof o)for(var c=new i(o,n),u=c.length,l=-1;++l<e;)s[l]=c[l%u];else s.fill(o);return s},t.allocUnsafe=function(e){if("function"==typeof i.allocUnsafe)return i.allocUnsafe(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(e>a)throw new RangeError("size is too large");return new i(e)},t.from=function(t,r,n){if("function"==typeof i.from&&(!e.Uint8Array||Uint8Array.from!==i.from))return i.from(t,r,n);if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("string"==typeof t)return new i(t,r);if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){var o=r;if(1===arguments.length)return new i(t);void 0===o&&(o=0);var a=n;if(void 0===a&&(a=t.byteLength-o),o>=t.byteLength)throw new RangeError("'offset' is out of bounds");if(a>t.byteLength-o)throw new RangeError("'length' is out of bounds");return new i(t.slice(o,o+a))}if(i.isBuffer(t)){var s=new i(t.length);return t.copy(s,0,0,t.length),s}if(t){if(Array.isArray(t)||"undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return new i(t);if("Buffer"===t.type&&Array.isArray(t.data))return new i(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},t.allocUnsafeSlow=function(e){if("function"==typeof i.allocUnsafeSlow)return i.allocUnsafeSlow(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(e>=a)throw new RangeError("size is too large");return new o(e)}}).call(t,function(){return this}())},function(e,t,r){(function(e){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(t,r(1))},function(e,t){},function(e,t,r){r(2).Buffer;var n=r(17);function i(){this.head=null,this.tail=null,this.length=0}e.exports=i,i.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},i.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},i.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},i.prototype.clear=function(){this.head=this.tail=null,this.length=0},i.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},i.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t=n.allocUnsafe(e>>>0),r=this.head,i=0;r;)r.data.copy(t,i),i+=r.data.length,r=r.next;return t}},function(e,t,r){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=p;var i=r(15),o=r(18);o.inherits=r(12);var a=r(14),s=r(22);o.inherits(p,a);for(var c=n(s.prototype),u=0;u<c.length;u++){var l=c[u];p.prototype[l]||(p.prototype[l]=s.prototype[l])}function p(e){if(!(this instanceof p))return new p(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||i(d,this)}function d(e){e.end()}},function(e,t,r){(function(t){e.exports=m;var n,i=r(15),o=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?setImmediate:i;m.WritableState=h;var a=r(18);a.inherits=r(12);var s,c={deprecate:r(23)};!function(){try{s=r(11)}catch(e){}finally{s||(s=r(8).EventEmitter)}}();var u,l=r(2).Buffer,p=r(17);function f(){}function d(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function h(e,t){n=n||r(21),e=e||{},this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var a=e.highWaterMark,s=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:s,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var c=!1===e.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,a=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,o){--t.pendingcb,r?i(o,n):o(n),e._writableState.errorEmitted=!0,e.emit("error",n)}(e,r,n,t,a);else{var s=_(r);s||r.corked||r.bufferProcessing||!r.bufferedRequest||v(e,r),n?o(y,e,r,s,a):y(e,r,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new T(this)}function m(e){if(n=n||r(21),!(u.call(m,this)||this instanceof n))return new m(e);this._writableState=new h(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),s.call(this)}function g(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function y(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),w(e,t)}function v(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0;r;)i[a]=r,r=r.next,a+=1;g(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new T(t)}else{for(;r;){var s=r.chunk,c=r.encoding,u=r.callback;if(g(e,t,!1,t.objectMode?1:s.length,s,c,u),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function w(e,t){var r=_(t);return r&&(0===t.pendingcb?(b(e,t),t.finished=!0,e.emit("finish")):b(e,t)),r}function T(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}a.inherits(m,s),h.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(h.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||e&&e._writableState instanceof h}})):u=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var n=this._writableState,o=!1,a=l.isBuffer(e);return"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=f),n.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),i(t,r)}(this,r):(a||function(e,t,r,n){var o=!0,a=!1;return null===r?a=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),i(n,a),o=!1),o}(this,n,e,r))&&(n.pendingcb++,o=function(e,t,r,n,i,o){r||(n=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=p.from(t,r)),t}(t,n,i),l.isBuffer(n)&&(i="buffer"));var a=t.objectMode?1:n.length;t.length+=a;var s=t.length<t.highWaterMark;if(s||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest=new d(n,i,o),c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else g(e,t,!1,a,n,i,o);return s}(this,n,a,e,t,r)),o},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||v(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,w(e,t),r&&(t.finished?i(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r)}}).call(t,r(6))},function(e,t){(function(t){function r(e){try{if(!t.localStorage)return!1}catch(n){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(t,function(){return this}())},function(e,t,r){var n=r(2).Buffer,i=n.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},o=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!i(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=s;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=c;break;default:return void(this.write=a)}this.charBuffer=new n(6),this.charReceived=0,this.charLength=0};function a(e){return e.toString(this.encoding)}function s(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function c(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}o.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((n=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&n<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n,i=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),i=(t+=e.toString(this.encoding,0,i)).length-1,(n=t.charCodeAt(i))>=55296&&n<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},o.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},o.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t}},function(e,t,r){e.exports=a;var n=r(21),i=r(18);function o(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function a(e){if(!(this instanceof a))return new a(e);n.call(this,e),this._transformState=new o(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e,r){s(t,e,r)})):s(t)}))}function s(e,t,r){if(t)return e.emit("error",t);null!=r&&e.push(r);var n=e._writableState,i=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=r(12),i.inherits(a,n),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,r){e.exports=o;var n=r(25),i=r(18);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i.inherits=r(12),i.inherits(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){e.exports=r(22)},function(e,t,r){e.exports=r(21)},function(e,t,r){e.exports=r(25)},function(e,t,r){e.exports=r(26)},function(e,t,r){var n=r(32),i=r(33),o=r(38),a=r(39),s=r(40),c=r(41),u=r(42),l=Object.prototype.toString;function p(e){if(!(this instanceof p))return new p(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(s[r]);this.header=new u,n.inflateGetHeader(this.strm,this.header)}function f(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}p.prototype.push=function(e,t){var r,s,c,u,p,f,d=this.strm,h=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?d.input=o.binstring2buf(e):"[object ArrayBuffer]"===l.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(h),d.next_out=0,d.avail_out=h),(r=n.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(f="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===l.call(m)?new Uint8Array(m):m,r=n.inflateSetDictionary(this.strm,f)),r===a.Z_BUF_ERROR&&!0===g&&(r=a.Z_OK,g=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==a.Z_STREAM_END&&(0!==d.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(c=o.utf8border(d.output,d.next_out),u=d.next_out-c,p=o.buf2string(d.output,c),d.next_out=u,d.avail_out=h-u,u&&i.arraySet(d.output,d.output,c,u,0),this.onData(p)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(g=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=p,t.inflate=f,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.ungzip=f},function(e,t,r){var n=r(33),i=r(34),o=r(35),a=r(36),s=r(37),c=-2,u=12,l=30;function p(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):c}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):c}function m(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?c:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,h(e))):c}function g(e,t){var r,n;return e?(n=new f,e.state=n,n.window=null,0!==(r=m(e,t))&&(e.state=null),r):c}var y,v,_=!0;function b(e){if(_){var t;for(y=new n.Buf32(512),v=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,y,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,v,0,e.work,{bits:5}),_=!1}e.lencode=y,e.lenbits=9,e.distcode=v,e.distbits=5}function w(e,t,r,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),n.arraySet(a.window,t,r-i,o,a.wnext),(i-=o)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=h,t.inflateReset2=m,t.inflateResetKeep=d,t.inflateInit=function(e){return g(e,15)},t.inflateInit2=g,t.inflate=function(e,t){var r,f,d,h,m,g,y,v,_,T,k,E,S,I,P,A,C,F,D,O,x,R,M,N,$=0,B=new n.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;(r=e.state).mode===u&&(r.mode=13),m=e.next_out,d=e.output,y=e.avail_out,h=e.next_in,f=e.input,g=e.avail_in,v=r.hold,_=r.bits,T=g,k=y,R=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;_<16;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(2&r.wrap&&35615===v){r.check=0,B[0]=255&v,B[1]=v>>>8&255,r.check=o(r.check,B,2,0),v=0,_=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&v)<<8)+(v>>8))%31){e.msg="incorrect header check",r.mode=l;break}if(8!=(15&v)){e.msg="unknown compression method",r.mode=l;break}if(_-=4,x=8+(15&(v>>>=4)),0===r.wbits)r.wbits=x;else if(x>r.wbits){e.msg="invalid window size",r.mode=l;break}r.dmax=1<<x,e.adler=r.check=1,r.mode=512&v?10:u,v=0,_=0;break;case 2:for(;_<16;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(r.flags=v,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=l;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=l;break}r.head&&(r.head.text=v>>8&1),512&r.flags&&(B[0]=255&v,B[1]=v>>>8&255,r.check=o(r.check,B,2,0)),v=0,_=0,r.mode=3;case 3:for(;_<32;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}r.head&&(r.head.time=v),512&r.flags&&(B[0]=255&v,B[1]=v>>>8&255,B[2]=v>>>16&255,B[3]=v>>>24&255,r.check=o(r.check,B,4,0)),v=0,_=0,r.mode=4;case 4:for(;_<16;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}r.head&&(r.head.xflags=255&v,r.head.os=v>>8),512&r.flags&&(B[0]=255&v,B[1]=v>>>8&255,r.check=o(r.check,B,2,0)),v=0,_=0,r.mode=5;case 5:if(1024&r.flags){for(;_<16;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}r.length=v,r.head&&(r.head.extra_len=v),512&r.flags&&(B[0]=255&v,B[1]=v>>>8&255,r.check=o(r.check,B,2,0)),v=0,_=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((E=r.length)>g&&(E=g),E&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,f,h,E,x)),512&r.flags&&(r.check=o(r.check,f,E,h)),g-=E,h+=E,r.length-=E),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===g)break e;E=0;do{x=f[h+E++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&E<g);if(512&r.flags&&(r.check=o(r.check,f,E,h)),g-=E,h+=E,x)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===g)break e;E=0;do{x=f[h+E++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&E<g);if(512&r.flags&&(r.check=o(r.check,f,E,h)),g-=E,h+=E,x)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;_<16;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(v!==(65535&r.check)){e.msg="header crc mismatch",r.mode=l;break}v=0,_=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=u;break;case 10:for(;_<32;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}e.adler=r.check=p(v),v=0,_=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=m,e.avail_out=y,e.next_in=h,e.avail_in=g,r.hold=v,r.bits=_,2;e.adler=r.check=1,r.mode=u;case u:if(5===t||6===t)break e;case 13:if(r.last){v>>>=7&_,_-=7&_,r.mode=27;break}for(;_<3;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}switch(r.last=1&v,_-=1,3&(v>>>=1)){case 0:r.mode=14;break;case 1:if(b(r),r.mode=20,6===t){v>>>=2,_-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=l}v>>>=2,_-=2;break;case 14:for(v>>>=7&_,_-=7&_;_<32;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if((65535&v)!=(v>>>16^65535)){e.msg="invalid stored block lengths",r.mode=l;break}if(r.length=65535&v,v=0,_=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(E=r.length){if(E>g&&(E=g),E>y&&(E=y),0===E)break e;n.arraySet(d,f,h,E,m),g-=E,h+=E,y-=E,m+=E,r.length-=E;break}r.mode=u;break;case 17:for(;_<14;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(r.nlen=257+(31&v),v>>>=5,_-=5,r.ndist=1+(31&v),v>>>=5,_-=5,r.ncode=4+(15&v),v>>>=4,_-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=l;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;_<3;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}r.lens[L[r.have++]]=7&v,v>>>=3,_-=3}for(;r.have<19;)r.lens[L[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},R=s(0,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,R){e.msg="invalid code lengths set",r.mode=l;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;A=($=r.lencode[v&(1<<r.lenbits)-1])>>>16&255,C=65535&$,!((P=$>>>24)<=_);){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(C<16)v>>>=P,_-=P,r.lens[r.have++]=C;else{if(16===C){for(N=P+2;_<N;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(v>>>=P,_-=P,0===r.have){e.msg="invalid bit length repeat",r.mode=l;break}x=r.lens[r.have-1],E=3+(3&v),v>>>=2,_-=2}else if(17===C){for(N=P+3;_<N;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}_-=P,x=0,E=3+(7&(v>>>=P)),v>>>=3,_-=3}else{for(N=P+7;_<N;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}_-=P,x=0,E=11+(127&(v>>>=P)),v>>>=7,_-=7}if(r.have+E>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=l;break}for(;E--;)r.lens[r.have++]=x}}if(r.mode===l)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=l;break}if(r.lenbits=9,M={bits:r.lenbits},R=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,R){e.msg="invalid literal/lengths set",r.mode=l;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},R=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,R){e.msg="invalid distances set",r.mode=l;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(g>=6&&y>=258){e.next_out=m,e.avail_out=y,e.next_in=h,e.avail_in=g,r.hold=v,r.bits=_,a(e,k),m=e.next_out,d=e.output,y=e.avail_out,h=e.next_in,f=e.input,g=e.avail_in,v=r.hold,_=r.bits,r.mode===u&&(r.back=-1);break}for(r.back=0;A=($=r.lencode[v&(1<<r.lenbits)-1])>>>16&255,C=65535&$,!((P=$>>>24)<=_);){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(A&&0==(240&A)){for(F=P,D=A,O=C;A=($=r.lencode[O+((v&(1<<F+D)-1)>>F)])>>>16&255,C=65535&$,!(F+(P=$>>>24)<=_);){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}v>>>=F,_-=F,r.back+=F}if(v>>>=P,_-=P,r.back+=P,r.length=C,0===A){r.mode=26;break}if(32&A){r.back=-1,r.mode=u;break}if(64&A){e.msg="invalid literal/length code",r.mode=l;break}r.extra=15&A,r.mode=22;case 22:if(r.extra){for(N=r.extra;_<N;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}r.length+=v&(1<<r.extra)-1,v>>>=r.extra,_-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;A=($=r.distcode[v&(1<<r.distbits)-1])>>>16&255,C=65535&$,!((P=$>>>24)<=_);){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(0==(240&A)){for(F=P,D=A,O=C;A=($=r.distcode[O+((v&(1<<F+D)-1)>>F)])>>>16&255,C=65535&$,!(F+(P=$>>>24)<=_);){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}v>>>=F,_-=F,r.back+=F}if(v>>>=P,_-=P,r.back+=P,64&A){e.msg="invalid distance code",r.mode=l;break}r.offset=C,r.extra=15&A,r.mode=24;case 24:if(r.extra){for(N=r.extra;_<N;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}r.offset+=v&(1<<r.extra)-1,v>>>=r.extra,_-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=l;break}r.mode=25;case 25:if(0===y)break e;if(E=k-y,r.offset>E){if((E=r.offset-E)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=l;break}E>r.wnext?(E-=r.wnext,S=r.wsize-E):S=r.wnext-E,E>r.length&&(E=r.length),I=r.window}else I=d,S=m-r.offset,E=r.length;E>y&&(E=y),y-=E,r.length-=E;do{d[m++]=I[S++]}while(--E);0===r.length&&(r.mode=21);break;case 26:if(0===y)break e;d[m++]=r.length,y--,r.mode=21;break;case 27:if(r.wrap){for(;_<32;){if(0===g)break e;g--,v|=f[h++]<<_,_+=8}if(k-=y,e.total_out+=k,r.total+=k,k&&(e.adler=r.check=r.flags?o(r.check,d,k,m-k):i(r.check,d,k,m-k)),k=y,(r.flags?v:p(v))!==r.check){e.msg="incorrect data check",r.mode=l;break}v=0,_=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;_<32;){if(0===g)break e;g--,v+=f[h++]<<_,_+=8}if(v!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=l;break}v=0,_=0}r.mode=29;case 29:R=1;break e;case l:R=-3;break e;case 31:return-4;case 32:default:return c}return e.next_out=m,e.avail_out=y,e.next_in=h,e.avail_in=g,r.hold=v,r.bits=_,(r.wsize||k!==e.avail_out&&r.mode<l&&(r.mode<27||4!==t))&&w(e,e.output,e.next_out,k-e.avail_out),T-=e.avail_in,k-=e.avail_out,e.total_in+=T,e.total_out+=k,r.total+=k,r.wrap&&k&&(e.adler=r.check=r.flags?o(r.check,d,k,e.next_out-k):i(r.check,d,k,e.next_out-k)),e.data_type=r.bits+(r.last?64:0)+(r.mode===u?128:0)+(20===r.mode||15===r.mode?256:0),(0===T&&0===k||4===t)&&0===R&&(R=-5),R},t.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?c:(r.head=t,t.done=!1,0):c},t.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?c:11===r.mode&&i(1,t,n,0)!==r.check?-3:w(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):c},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(r)},function(e,t){e.exports=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},function(e,t){var r=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t,n,i){var o=r,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},function(e,t){e.exports=function(e,t){var r,n,i,o,a,s,c,u,l,p,f,d,h,m,g,y,v,_,b,w,T,k,E,S,I;r=e.state,n=e.next_in,S=e.input,i=n+(e.avail_in-5),o=e.next_out,I=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),c=r.dmax,u=r.wsize,l=r.whave,p=r.wnext,f=r.window,d=r.hold,h=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{h<15&&(d+=S[n++]<<h,h+=8,d+=S[n++]<<h,h+=8),_=m[d&y];t:for(;;){if(d>>>=b=_>>>24,h-=b,0==(b=_>>>16&255))I[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=m[(65535&_)+(d&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&_,(b&=15)&&(h<b&&(d+=S[n++]<<h,h+=8),w+=d&(1<<b)-1,d>>>=b,h-=b),h<15&&(d+=S[n++]<<h,h+=8,d+=S[n++]<<h,h+=8),_=g[d&v];r:for(;;){if(d>>>=b=_>>>24,h-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=g[(65535&_)+(d&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(T=65535&_,h<(b&=15)&&(d+=S[n++]<<h,(h+=8)<b&&(d+=S[n++]<<h,h+=8)),(T+=d&(1<<b)-1)>c){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=b,h-=b,T>(b=o-a)){if((b=T-b)>l&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(k=0,E=f,0===p){if(k+=u-b,b<w){w-=b;do{I[o++]=f[k++]}while(--b);k=o-T,E=I}}else if(p<b){if(k+=u+p-b,(b-=p)<w){w-=b;do{I[o++]=f[k++]}while(--b);if(k=0,p<w){w-=b=p;do{I[o++]=f[k++]}while(--b);k=o-T,E=I}}}else if(k+=p-b,b<w){w-=b;do{I[o++]=f[k++]}while(--b);k=o-T,E=I}for(;w>2;)I[o++]=E[k++],I[o++]=E[k++],I[o++]=E[k++],w-=3;w&&(I[o++]=E[k++],w>1&&(I[o++]=E[k++]))}else{k=o-T;do{I[o++]=I[k++],I[o++]=I[k++],I[o++]=I[k++],w-=3}while(w>2);w&&(I[o++]=I[k++],w>1&&(I[o++]=I[k++]))}break}}break}}while(n<i&&o<s);n-=w=h>>3,d&=(1<<(h-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=d,r.bits=h}},function(e,t,r){var n=r(33),i=15,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,u,l,p,f,d){var h,m,g,y,v,_,b,w,T,k=d.bits,E=0,S=0,I=0,P=0,A=0,C=0,F=0,D=0,O=0,x=0,R=null,M=0,N=new n.Buf16(16),$=new n.Buf16(16),B=null,L=0;for(E=0;E<=i;E++)N[E]=0;for(S=0;S<u;S++)N[t[r+S]]++;for(A=k,P=i;P>=1&&0===N[P];P--);if(A>P&&(A=P),0===P)return l[p++]=20971520,l[p++]=20971520,d.bits=1,0;for(I=1;I<P&&0===N[I];I++);for(A<I&&(A=I),D=1,E=1;E<=i;E++)if(D<<=1,(D-=N[E])<0)return-1;if(D>0&&(0===e||1!==P))return-1;for($[1]=0,E=1;E<i;E++)$[E+1]=$[E]+N[E];for(S=0;S<u;S++)0!==t[r+S]&&(f[$[t[r+S]]++]=S);if(0===e?(R=B=f,_=19):1===e?(R=o,M-=257,B=a,L-=257,_=256):(R=s,B=c,_=-1),x=0,S=0,E=I,v=p,C=A,F=0,g=-1,y=(O=1<<A)-1,1===e&&O>852||2===e&&O>592)return 1;for(;;){b=E-F,f[S]<_?(w=0,T=f[S]):f[S]>_?(w=B[L+f[S]],T=R[M+f[S]]):(w=96,T=0),h=1<<E-F,I=m=1<<C;do{l[v+(x>>F)+(m-=h)]=b<<24|w<<16|T|0}while(0!==m);for(h=1<<E-1;x&h;)h>>=1;if(0!==h?(x&=h-1,x+=h):x=0,S++,0==--N[E]){if(E===P)break;E=t[r+f[S]]}if(E>A&&(x&y)!==g){for(0===F&&(F=A),v+=I,D=1<<(C=E-F);C+F<P&&!((D-=N[C+F])<=0);)C++,D<<=1;if(O+=1<<C,1===e&&O>852||2===e&&O>592)return 1;l[g=x&y]=A<<24|C<<16|v-p|0}}return 0!==x&&(l[v+x]=E-F<<24|64<<16|0),d.bits=A,0}},function(e,t,r){var n=r(33),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(u){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function c(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,t.string2buf=function(e){var t,r,i,o,a,s=e.length,c=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(c),a=0,o=0;a<c;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},t.buf2binstring=function(e){return c(e,e.length)},t.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,n,i,o,s=t||e.length,u=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)u[n++]=i;else if((o=a[i])>4)u[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<s;)i=i<<6|63&e[r++],o--;o>1?u[n++]=65533:i<65536?u[n++]=i:(i-=65536,u[n++]=55296|i>>10&1023,u[n++]=56320|1023&i)}return c(u,n)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},function(e,t){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}])},browserfs.exports=factory();var posix={resolve:function(){for(var e,t="",r=!1,n=arguments.length-1;n>=-1&&!r;n--){var i;n>=0?i=arguments[n]:(void 0===e&&(e=process.cwd()),i=e),assertPath(i),0!==i.length&&(t=i+"/"+t,r=47===i.charCodeAt(0))}return t=normalizeStringPosix(t,!r),r?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(assertPath(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=normalizeStringPosix(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return assertPath(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];assertPath(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":posix.normalize(e)},relative:function(e,t){if(assertPath(e),assertPath(t),e===t)return"";if((e=posix.resolve(e))===(t=posix.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var n=e.length,i=n-r,o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var a=t.length-o,s=i<a?i:a,c=-1,u=0;u<=s;++u){if(u===s){if(a>s){if(47===t.charCodeAt(o+u))return t.slice(o+u+1);if(0===u)return t.slice(o+u)}else i>s&&(47===e.charCodeAt(r+u)?c=u:0===u&&(c=0));break}var l=e.charCodeAt(r+u);if(l!==t.charCodeAt(o+u))break;47===l&&(c=u)}var p="";for(u=r+c+1;u<=n;++u)u!==n&&47!==e.charCodeAt(u)||(0===p.length?p+="..":p+="/..");return p.length>0?p+t.slice(o+c):(o+=c,47===t.charCodeAt(o)&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(assertPath(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,i=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!i){n=o;break}}else i=!1;return-1===n?r?"/":".":r&&1===n?"//":e.slice(0,n)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');assertPath(e);var r,n=0,i=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,s=-1;for(r=e.length-1;r>=0;--r){var c=e.charCodeAt(r);if(47===c){if(!o){n=r+1;break}}else-1===s&&(o=!1,s=r+1),a>=0&&(c===t.charCodeAt(a)?-1==--a&&(i=r):(a=-1,i=s))}return n===i?i=s:-1===i&&(i=e.length),e.slice(n,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){n=r+1;break}}else-1===i&&(o=!1,i=r+1);return-1===i?"":e.slice(n,i)},extname:function(e){assertPath(e);for(var t=-1,r=0,n=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===n&&(i=!1,n=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){r=a+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return _format("/",e)},parse:function(e){assertPath(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,n=e.charCodeAt(0),i=47===n;i?(t.root="/",r=1):r=0;for(var o=-1,a=0,s=-1,c=!0,u=e.length-1,l=0;u>=r;--u)if(47!==(n=e.charCodeAt(u)))-1===s&&(c=!1,s=u+1),46===n?-1===o?o=u:1!==l&&(l=1):-1!==o&&(l=-1);else if(!c){a=u+1;break}return-1===o||-1===s||0===l||1===l&&o===s-1&&o===a+1?-1!==s&&(t.base=t.name=0===a&&i?e.slice(1,s):e.slice(a,s)):(0===a&&i?(t.name=e.slice(1,o),t.base=e.slice(1,s)):(t.name=e.slice(a,o),t.base=e.slice(a,s)),t.ext=e.slice(o,s)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};posix.posix=posix;var pathBrowserify=posix,eventemitter2={exports:{}},module;
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */
module=eventemitter2,function(e){var t=Object.hasOwnProperty,r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n="object"==typeof process&&"function"==typeof process.nextTick,i="function"==typeof Symbol,o="object"==typeof Reflect,a="function"==typeof setImmediate?setImmediate:setTimeout,s=i?o&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function c(){this._events={},this._conf&&u.call(this,this._conf)}function u(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners!==e&&(this._maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this._newListener=t.newListener),t.removeListener&&(this._removeListener=t.removeListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),t.ignoreErrors&&(this.ignoreErrors=t.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function l(e,t){var r="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(r+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var n=new Error(r);n.name="MaxListenersExceededWarning",n.emitter=this,n.count=e,process.emitWarning(n)}else console.error(r),console.trace&&console.trace()}var p=function(e,t,r){var n=arguments.length;switch(n){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,r];default:for(var i=new Array(n);n--;)i[n]=arguments[n];return i}};function f(t,r){for(var n={},i=t.length,o=r?value.length:0,a=0;a<i;a++)n[t[a]]=a<o?r[a]:e;return n}function d(e,t,r){var n,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(r.on||r.off)&&(n=r.on,i=r.off),t.addEventListener?(n=t.addEventListener,i=t.removeEventListener):t.addListener?(n=t.addListener,i=t.removeListener):t.on&&(n=t.on,i=t.off),!n&&!i)throw Error("target does not implement any known event API");if("function"!=typeof n)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=n,this._off=i;var o=e._observers;o?o.push(this):e._observers=[this]}function h(r,n,i,o){var a=Object.assign({},n);if(!r)return a;if("object"!=typeof r)throw TypeError("options must be an object");var s,c,u,l=Object.keys(r),p=l.length;function f(e){throw Error('Invalid "'+s+'" option value'+(e?". Reason: "+e:""))}for(var d=0;d<p;d++){if(s=l[d],!o&&!t.call(n,s))throw Error('Unknown "'+s+'" option');(c=r[s])!==e&&(u=i[s],a[s]=u?u(c,f):c)}return a}function m(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function g(e){var t="value must be type of "+e.join("|"),r=e.length,n=e[0],i=e[1];return 1===r?function(e,r){if(typeof e===n)return e;r(t)}:2===r?function(e,r){var o=typeof e;if(o===n||o===i)return e;r(t)}:function(n,i){for(var o=typeof n,a=r;a-- >0;)if(o===e[a])return n;i(t)}}Object.assign(d.prototype,{subscribe:function(e,t,r){var n=this,i=this._target,o=this._emitter,a=this._listeners,s=function(){var n=p.apply(null,arguments),a={data:n,name:t,original:e};if(r){var s=r.call(i,a);!1!==s&&o.emit.apply(o,[a.name].concat(n))}else o.emit.apply(o,[t].concat(n))};if(a[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!n._onNewListener?(this._onNewListener=function(r){r===t&&null===a[e]&&(a[e]=s,n._on.call(i,e,s))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(r){r===t&&!o.hasListeners(r)&&a[e]&&(a[e]=null,n._off.call(i,e,s))},a[e]=null,o.on("removeListener",this._onRemoveListener)):(a[e]=s,n._on.call(i,e,s))},unsubscribe:function(e){var t,r,n,i=this,o=this._listeners,a=this._emitter,c=this._off,u=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function l(){i._onNewListener&&(a.off("newListener",i._onNewListener),a.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=b.call(a,i);a._observers.splice(e,1)}if(e){if(!(t=o[e]))return;c.call(u,e,t),delete o[e],--this._listenersCount||l()}else{for(n=(r=s(o)).length;n-- >0;)e=r[n],c.call(u,e,o[e]);this._listeners={},this._listenersCount=0,l()}}});var y=g(["function"]),v=g(["object","function"]);function _(e,t,r){var n,i,o,a=0,s=new e((function(c,u,l){function p(){i&&(i=null),a&&(clearTimeout(a),a=0)}r=h(r,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),n=!r.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof l;var f=function(e){p(),c(e)},d=function(e){p(),u(e)};n?t(f,d,l):(i=[function(e){d(e||Error("canceled"))}],t(f,d,(function(e){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),o=!0),r.timeout>0&&(a=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",a=0,s.cancel(e),u(e)}),r.timeout))}));return n||(s.cancel=function(e){if(i){for(var t=i.length,r=1;r<t;r++)i[r](e);i[0](e),i=null}}),s}function b(e){var t=this._observers;if(!t)return-1;for(var r=t.length,n=0;n<r;n++)if(t[n]._target===e)return n;return-1}function w(e,t,r,n,i){if(!r)return null;if(0===n){var o=typeof t;if("string"===o){var a,c,u=0,l=0,p=this.delimiter,f=p.length;if(-1!==(c=t.indexOf(p))){a=new Array(5);do{a[u++]=t.slice(l,c),l=c+f}while(-1!==(c=t.indexOf(p,l)));a[u++]=t.slice(l),t=a,i=u}else t=[t],i=1}else"object"===o?i=t.length:(t=[t],i=1)}var d,h,m,g,y,v,_,b=null,T=t[n],k=t[n+1];if(n===i&&r._listeners)return"function"==typeof r._listeners?(e&&e.push(r._listeners),[r]):(e&&e.push.apply(e,r._listeners),[r]);if("*"===T){for(c=(v=s(r)).length;c-- >0;)"_listeners"!==(d=v[c])&&(_=w(e,t,r[d],n+1,i))&&(b?b.push.apply(b,_):b=_);return b}if("**"===T){for((y=n+1===i||n+2===i&&"*"===k)&&r._listeners&&(b=w(e,t,r,i,i)),c=(v=s(r)).length;c-- >0;)"_listeners"!==(d=v[c])&&("*"===d||"**"===d?(r[d]._listeners&&!y&&(_=w(e,t,r[d],i,i))&&(b?b.push.apply(b,_):b=_),_=w(e,t,r[d],n,i)):_=w(e,t,r[d],d===k?n+2:n,i),_&&(b?b.push.apply(b,_):b=_));return b}if(r[T]&&(b=w(e,t,r[T],n+1,i)),(h=r["*"])&&w(e,t,h,n+1,i),m=r["**"])if(n<i)for(m._listeners&&w(e,t,m,i,i),c=(v=s(m)).length;c-- >0;)"_listeners"!==(d=v[c])&&(d===k?w(e,t,m[d],n+2,i):d===T?w(e,t,m[d],n+1,i):((g={})[d]=m[d],w(e,t,{"**":g},n+1,i)));else m._listeners?w(e,t,m,i,i):m["*"]&&m["*"]._listeners&&w(e,t,m["*"],i,i);return b}function T(e,t,r){var n,i,o=0,a=0,s=this.delimiter,c=s.length;if("string"==typeof e)if(-1!==(n=e.indexOf(s))){i=new Array(5);do{i[o++]=e.slice(a,n),a=n+c}while(-1!==(n=e.indexOf(s,a)));i[o++]=e.slice(a)}else i=[e],o=1;else i=e,o=e.length;if(o>1)for(n=0;n+1<o;n++)if("**"===i[n]&&"**"===i[n+1])return;var u,p=this.listenerTree;for(n=0;n<o;n++)if(p=p[u=i[n]]||(p[u]={}),n===o-1)return p._listeners?("function"==typeof p._listeners&&(p._listeners=[p._listeners]),r?p._listeners.unshift(t):p._listeners.push(t),!p._listeners.warned&&this._maxListeners>0&&p._listeners.length>this._maxListeners&&(p._listeners.warned=!0,l.call(this,p._listeners.length,u))):p._listeners=t,!0;return!0}function k(e,t,r,n){for(var i,o,a,c,u=s(e),l=u.length,p=e._listeners;l-- >0;)i=e[o=u[l]],a="_listeners"===o?r:r?r.concat(o):[o],c=n||"symbol"==typeof o,p&&t.push(c?a:a.join(this.delimiter)),"object"==typeof i&&k.call(this,i,t,a,c);return t}function E(e){for(var t,r,n,i=s(e),o=i.length;o-- >0;)(t=e[r=i[o]])&&(n=!0,"_listeners"===r||E(t)||delete e[r]);return n}function S(e,t,r){this.emitter=e,this.event=t,this.listener=r}function I(t,r,i){if(!0===i)s=!0;else if(!1===i)o=!0;else{if(!i||"object"!=typeof i)throw TypeError("options should be an object or true");var o=i.async,s=i.promisify,c=i.nextTick,u=i.objectify}if(o||c||s){var l=r,p=r._origin||r;if(c&&!n)throw Error("process.nextTick is not supported");s===e&&(s="AsyncFunction"===r.constructor.name),(r=function(){var e=arguments,t=this,r=this.event;return s?c?Promise.resolve():new Promise((function(e){a(e)})).then((function(){return t.event=r,l.apply(t,e)})):(c?process.nextTick:a)((function(){t.event=r,l.apply(t,e)}))})._async=!0,r._origin=p}return[r,u?new S(this,t,r):this]}function P(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,u.call(this,e)}S.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},P.EventEmitter2=P,P.prototype.listenTo=function(t,n,i){if("object"!=typeof t)throw TypeError("target musts be an object");var o=this;function a(e){if("object"!=typeof e)throw TypeError("events must be an object");var r,n=i.reducers,a=b.call(o,t);r=-1===a?new d(o,t,i):o._observers[a];for(var c,u=s(e),l=u.length,p="function"==typeof n,f=0;f<l;f++)c=u[f],r.subscribe(c,e[c]||c,p?n:n&&n[c])}return i=h(i,{on:e,off:e,reducers:e},{on:y,off:y,reducers:v}),r(n)?a(f(n)):a("string"==typeof n?f(n.split(/\s+/)):n),this},P.prototype.stopListeningTo=function(e,t){var r=this._observers;if(!r)return!1;var n,i=r.length,o=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)n=r[i],e&&n._target!==e||(n.unsubscribe(t),o=!0);return o},P.prototype.delimiter=".",P.prototype.setMaxListeners=function(t){t!==e&&(this._maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},P.prototype.getMaxListeners=function(){return this._maxListeners},P.prototype.event="",P.prototype.once=function(e,t,r){return this._once(e,t,!1,r)},P.prototype.prependOnceListener=function(e,t,r){return this._once(e,t,!0,r)},P.prototype._once=function(e,t,r,n){return this._many(e,1,t,r,n)},P.prototype.many=function(e,t,r,n){return this._many(e,t,r,!1,n)},P.prototype.prependMany=function(e,t,r,n){return this._many(e,t,r,!0,n)},P.prototype._many=function(e,t,r,n,i){var o=this;if("function"!=typeof r)throw new Error("many only accepts instances of Function");function a(){return 0==--t&&o.off(e,a),r.apply(this,arguments)}return a._origin=r,this._on(e,a,n,i)},P.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||c.call(this);var e,t,r,n,o,a,s=arguments[0],u=this.wildcard;if("newListener"===s&&!this._newListener&&!this._events.newListener)return!1;if(u&&(e=s,"newListener"!==s&&"removeListener"!==s&&"object"==typeof s)){if(r=s.length,i)for(n=0;n<r;n++)if("symbol"==typeof s[n]){a=!0;break}a||(s=s.join(this.delimiter))}var l,p=arguments.length;if(this._all&&this._all.length)for(n=0,r=(l=this._all.slice()).length;n<r;n++)switch(this.event=s,p){case 1:l[n].call(this,s);break;case 2:l[n].call(this,s,arguments[1]);break;case 3:l[n].call(this,s,arguments[1],arguments[2]);break;default:l[n].apply(this,arguments)}if(u)l=[],w.call(this,l,e,this.listenerTree,0,r);else{if("function"==typeof(l=this._events[s])){switch(this.event=s,p){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(p-1),o=1;o<p;o++)t[o-1]=arguments[o];l.apply(this,t)}return!0}l&&(l=l.slice())}if(l&&l.length){if(p>3)for(t=new Array(p-1),o=1;o<p;o++)t[o-1]=arguments[o];for(n=0,r=l.length;n<r;n++)switch(this.event=s,p){case 1:l[n].call(this);break;case 2:l[n].call(this,arguments[1]);break;case 3:l[n].call(this,arguments[1],arguments[2]);break;default:l[n].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===s)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},P.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||c.call(this);var e,t,r,n,o,a,s=arguments[0],u=this.wildcard;if("newListener"===s&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(u&&(e=s,"newListener"!==s&&"removeListener"!==s&&"object"==typeof s)){if(n=s.length,i)for(o=0;o<n;o++)if("symbol"==typeof s[o]){t=!0;break}t||(s=s.join(this.delimiter))}var l,p=[],f=arguments.length;if(this._all)for(o=0,n=this._all.length;o<n;o++)switch(this.event=s,f){case 1:p.push(this._all[o].call(this,s));break;case 2:p.push(this._all[o].call(this,s,arguments[1]));break;case 3:p.push(this._all[o].call(this,s,arguments[1],arguments[2]));break;default:p.push(this._all[o].apply(this,arguments))}if(u?(l=[],w.call(this,l,e,this.listenerTree,0)):l=this._events[s],"function"==typeof l)switch(this.event=s,f){case 1:p.push(l.call(this));break;case 2:p.push(l.call(this,arguments[1]));break;case 3:p.push(l.call(this,arguments[1],arguments[2]));break;default:for(r=new Array(f-1),a=1;a<f;a++)r[a-1]=arguments[a];p.push(l.apply(this,r))}else if(l&&l.length){if(l=l.slice(),f>3)for(r=new Array(f-1),a=1;a<f;a++)r[a-1]=arguments[a];for(o=0,n=l.length;o<n;o++)switch(this.event=s,f){case 1:p.push(l[o].call(this));break;case 2:p.push(l[o].call(this,arguments[1]));break;case 3:p.push(l[o].call(this,arguments[1],arguments[2]));break;default:p.push(l[o].apply(this,r))}}else if(!this.ignoreErrors&&!this._all&&"error"===s)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(p)},P.prototype.on=function(e,t,r){return this._on(e,t,!1,r)},P.prototype.prependListener=function(e,t,r){return this._on(e,t,!0,r)},P.prototype.onAny=function(e){return this._onAny(e,!1)},P.prototype.prependAny=function(e){return this._onAny(e,!0)},P.prototype.addListener=P.prototype.on,P.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},P.prototype._on=function(t,r,n,i){if("function"==typeof t)return this._onAny(t,r),this;if("function"!=typeof r)throw new Error("on only accepts instances of Function");this._events||c.call(this);var o,a=this;return i!==e&&(r=(o=I.call(this,t,r,i))[0],a=o[1]),this._newListener&&this.emit("newListener",t,r),this.wildcard?(T.call(this,t,r,n),a):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),n?this._events[t].unshift(r):this._events[t].push(r),!this._events[t].warned&&this._maxListeners>0&&this._events[t].length>this._maxListeners&&(this._events[t].warned=!0,l.call(this,this._events[t].length,t))):this._events[t]=r,a)},P.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var o="string"==typeof e?e.split(this.delimiter):e.slice();if(!(i=w.call(this,null,o,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var a=0;a<i.length;a++){var s=i[a];if(n=s._listeners,r(n)){for(var c=-1,u=0,l=n.length;u<l;u++)if(n[u]===t||n[u].listener&&n[u].listener===t||n[u]._origin&&n[u]._origin===t){c=u;break}if(c<0)continue;return this.wildcard?s._listeners.splice(c,1):this._events[e].splice(c,1),0===n.length&&(this.wildcard?delete s._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete s._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&E(this.listenerTree),this},P.prototype.offAny=function(e){var t,r=0,n=0;if(e&&this._all&&this._all.length>0){for(r=0,n=(t=this._all).length;r<n;r++)if(e===t[r])return t.splice(r,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(r=0,n=t.length;r<n;r++)this.emit("removeListenerAny",t[r]);this._all=[]}return this},P.prototype.removeListener=P.prototype.off,P.prototype.removeAllListeners=function(t){if(t===e)return!this._events||c.call(this),this;if(this.wildcard){var r,n=w.call(this,null,t,this.listenerTree,0);if(!n)return this;for(r=0;r<n.length;r++)n[r]._listeners=null;this.listenerTree&&E(this.listenerTree)}else this._events&&(this._events[t]=null);return this},P.prototype.listeners=function(t){var r,n,i,o,a,c=this._events;if(t===e){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!c)return[];for(o=(r=s(c)).length,i=[];o-- >0;)"function"==typeof(n=c[r[o]])?i.push(n):i.push.apply(i,n);return i}if(this.wildcard){if(!(a=this.listenerTree))return[];var u=[],l="string"==typeof t?t.split(this.delimiter):t.slice();return w.call(this,u,l,a,0),u}return c&&(n=c[t])?"function"==typeof n?[n]:n:[]},P.prototype.eventNames=function(e){var t=this._events;return this.wildcard?k.call(this,this.listenerTree,[],null,e):t?s(t):[]},P.prototype.listenerCount=function(e){return this.listeners(e).length},P.prototype.hasListeners=function(t){if(this.wildcard){var r=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return w.call(this,r,n,this.listenerTree,0),r.length>0}var i=this._events,o=this._all;return!!(o&&o.length||i&&(t===e?s(i).length:i[t]))},P.prototype.listenersAny=function(){return this._all?this._all:[]},P.prototype.waitFor=function(t,r){var n=this,i=typeof r;return"number"===i?r={timeout:r}:"function"===i&&(r={filter:r}),_((r=h(r,{timeout:0,filter:e,handleError:!1,Promise:Promise,overload:!1},{filter:y,Promise:m})).Promise,(function(e,i,o){function a(){var o=r.filter;if(!o||o.apply(n,arguments))if(n.off(t,a),r.handleError){var s=arguments[0];s?i(s):e(p.apply(null,arguments).slice(1))}else e(p.apply(null,arguments))}o((function(){n.off(t,a)})),n._on(t,a,!1)}),{timeout:r.timeout,overload:r.overload})};var A=P.prototype;Object.defineProperties(P,{defaultMaxListeners:{get:function(){return A._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");A._maxListeners=e},enumerable:!0},once:{value:function(e,t,r){return _((r=h(r,{Promise:Promise,timeout:0,overload:!1},{Promise:m})).Promise,(function(r,n,i){var o;if("function"==typeof e.addEventListener)return o=function(){r(p.apply(null,arguments))},i((function(){e.removeEventListener(t,o)})),void e.addEventListener(t,o,{once:!0});var a,s=function(){a&&e.removeListener("error",a),r(p.apply(null,arguments))};"error"!==t&&(a=function(r){e.removeListener(t,s),n(r)},e.once("error",a)),i((function(){a&&e.removeListener("error",a),e.removeListener(t,s)})),e.once(t,s)}),{timeout:r.timeout,overload:r.overload})},writable:!0,configurable:!0}}),Object.defineProperties(A,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),module.exports=P}();var core$2={},core$1={},ReadStreamTokenizer$1={},AbstractTokenizer$1={},lib$1={},EndOfFileStream={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.EndOfStreamError=e.defaultMessages=void 0,e.defaultMessages="End-Of-Stream";class t extends Error{constructor(){super(e.defaultMessages)}}e.EndOfStreamError=t}(EndOfFileStream),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StreamReader=e.EndOfStreamError=void 0;const t=EndOfFileStream;var r=EndOfFileStream;Object.defineProperty(e,"EndOfStreamError",{enumerable:!0,get:function(){return r.EndOfStreamError}});class n{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}e.StreamReader=class{constructor(e){if(this.s=e,this.request=null,this.endOfStream=!1,this.peekQueue=[],!e.read||!e.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new t.EndOfStreamError))),this.s.once("error",(e=>this.reject(e))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(e,t,r){const n=await this.read(e,t,r);return this.peekQueue.push(e.subarray(t,t+n)),n}async read(e,r,n){if(0===n)return 0;if(0===this.peekQueue.length&&this.endOfStream)throw new t.EndOfStreamError;let i=n,o=0;for(;this.peekQueue.length>0&&i>0;){const t=this.peekQueue.pop();if(!t)throw new Error("peekData should be defined");const n=Math.min(t.length,i);e.set(t.subarray(0,n),r+o),o+=n,i-=n,n<t.length&&this.peekQueue.push(t.subarray(n))}for(;i>0&&!this.endOfStream;){const t=Math.min(i,1048576),n=await this._read(e,r+o,t);if(o+=n,n<t)break;i-=n}return o}async _read(e,t,r){if(this.request)throw new Error("Concurrent read operation?");const i=this.s.read(r);return i?(e.set(i,t),i.length):(this.request={buffer:e,offset:t,length:r,deferred:new n},this.s.once("readable",(()=>{this.tryRead()})),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const e=this.s.read(this.request.length);e?(this.request.buffer.set(e,this.request.offset),this.request.deferred.resolve(e.length),this.request=null):this.s.once("readable",(()=>{this.tryRead()}))}reject(e){this.endOfStream=!0,this.request&&(this.request.deferred.reject(e),this.request=null)}}}(lib$1),Object.defineProperty(AbstractTokenizer$1,"__esModule",{value:!0}),AbstractTokenizer$1.AbstractTokenizer=void 0;const peek_readable_1$2=lib$1;class AbstractTokenizer{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const r=Buffer.alloc(e.len);if(await this.readBuffer(r,{position:t})<e.len)throw new peek_readable_1$2.EndOfStreamError;return e.get(r,0)}async peekToken(e,t=this.position){const r=Buffer.alloc(e.len);if(await this.peekBuffer(r,{position:t})<e.len)throw new peek_readable_1$2.EndOfStreamError;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new peek_readable_1$2.EndOfStreamError;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new peek_readable_1$2.EndOfStreamError;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}AbstractTokenizer$1.AbstractTokenizer=AbstractTokenizer,Object.defineProperty(ReadStreamTokenizer$1,"__esModule",{value:!0}),ReadStreamTokenizer$1.ReadStreamTokenizer=void 0;const AbstractTokenizer_1$1=AbstractTokenizer$1,peek_readable_1$1=lib$1,maxBufferSize=256e3;class ReadStreamTokenizer extends AbstractTokenizer_1$1.AbstractTokenizer{constructor(e,t){super(t),this.streamReader=new peek_readable_1$1.StreamReader(e)}async getFileInfo(){return this.fileInfo}async readBuffer(e,t){const r=this.normalizeOptions(e,t),n=r.position-this.position;if(n>0)return await this.ignore(n),this.readBuffer(e,t);if(n<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===r.length)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!t||!t.mayBeLess)&&i<r.length)throw new peek_readable_1$1.EndOfStreamError;return i}async peekBuffer(e,t){const r=this.normalizeOptions(e,t);let n=0;if(r.position){const t=r.position-this.position;if(t>0){const i=new Uint8Array(r.length+t);return n=await this.peekBuffer(i,{mayBeLess:r.mayBeLess}),e.set(i.subarray(t),r.offset),n-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{n=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(t&&t.mayBeLess&&i instanceof peek_readable_1$1.EndOfStreamError)return 0;throw i}if(!r.mayBeLess&&n<r.length)throw new peek_readable_1$1.EndOfStreamError}return n}async ignore(e){const t=Math.min(maxBufferSize,e),r=new Uint8Array(t);let n=0;for(;n<e;){const i=e-n,o=await this.readBuffer(r,{length:Math.min(t,i)});if(o<0)return o;n+=o}return n}}ReadStreamTokenizer$1.ReadStreamTokenizer=ReadStreamTokenizer;var BufferTokenizer$1={};Object.defineProperty(BufferTokenizer$1,"__esModule",{value:!0}),BufferTokenizer$1.BufferTokenizer=void 0;const peek_readable_1=lib$1,AbstractTokenizer_1=AbstractTokenizer$1;class BufferTokenizer extends AbstractTokenizer_1.AbstractTokenizer{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const r=await this.peekBuffer(e,t);return this.position+=r,r}async peekBuffer(e,t){const r=this.normalizeOptions(e,t),n=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&n<r.length)throw new peek_readable_1.EndOfStreamError;return e.set(this.uint8Array.subarray(r.position,r.position+n),r.offset),n}async close(){}}BufferTokenizer$1.BufferTokenizer=BufferTokenizer,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.fromBuffer=e.fromStream=e.EndOfStreamError=void 0;const t=ReadStreamTokenizer$1,r=BufferTokenizer$1;var n=lib$1;Object.defineProperty(e,"EndOfStreamError",{enumerable:!0,get:function(){return n.EndOfStreamError}}),e.fromStream=function(e,r){return r=r||{},new t.ReadStreamTokenizer(e,r)},e.fromBuffer=function(e,t){return new r.BufferTokenizer(e,t)}}(core$1);var ParserFactory$1={},lib={},ieee754={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,n,i){var o,a,s=8*i-n-1,c=(1<<s)-1,u=c>>1,l=-7,p=r?i-1:0,f=r?-1:1,d=e[t+p];for(p+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+p],p+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+p],p+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=u}return(d?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,p=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+p>=1?f/c:f*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=l?(s=0,a=l):a+p>=1?(s=(t*c-1)*Math.pow(2,i),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+d]=255&a,d+=h,a/=256,u-=8);e[r+d-h]|=128*m}};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AnsiStringType=e.StringType=e.BufferType=e.Uint8ArrayType=e.IgnoreType=e.Float80_LE=e.Float80_BE=e.Float64_LE=e.Float64_BE=e.Float32_LE=e.Float32_BE=e.Float16_LE=e.Float16_BE=e.INT64_BE=e.UINT64_BE=e.INT64_LE=e.UINT64_LE=e.INT32_LE=e.INT32_BE=e.INT24_BE=e.INT24_LE=e.INT16_LE=e.INT16_BE=e.INT8=e.UINT32_BE=e.UINT32_LE=e.UINT24_BE=e.UINT24_LE=e.UINT16_BE=e.UINT16_LE=e.UINT8=void 0;const t=ieee754;function r(e){return new DataView(e.buffer,e.byteOffset)}e.UINT8={len:1,get:(e,t)=>r(e).getUint8(t),put:(e,t,n)=>(r(e).setUint8(t,n),t+1)},e.UINT16_LE={len:2,get:(e,t)=>r(e).getUint16(t,!0),put:(e,t,n)=>(r(e).setUint16(t,n,!0),t+2)},e.UINT16_BE={len:2,get:(e,t)=>r(e).getUint16(t),put:(e,t,n)=>(r(e).setUint16(t,n),t+2)},e.UINT24_LE={len:3,get(e,t){const n=r(e);return n.getUint8(t)+(n.getUint16(t+1,!0)<<8)},put(e,t,n){const i=r(e);return i.setUint8(t,255&n),i.setUint16(t+1,n>>8,!0),t+3}},e.UINT24_BE={len:3,get(e,t){const n=r(e);return(n.getUint16(t)<<8)+n.getUint8(t+2)},put(e,t,n){const i=r(e);return i.setUint16(t,n>>8),i.setUint8(t+2,255&n),t+3}},e.UINT32_LE={len:4,get:(e,t)=>r(e).getUint32(t,!0),put:(e,t,n)=>(r(e).setUint32(t,n,!0),t+4)},e.UINT32_BE={len:4,get:(e,t)=>r(e).getUint32(t),put:(e,t,n)=>(r(e).setUint32(t,n),t+4)},e.INT8={len:1,get:(e,t)=>r(e).getInt8(t),put:(e,t,n)=>(r(e).setInt8(t,n),t+2)},e.INT16_BE={len:2,get:(e,t)=>r(e).getInt16(t),put:(e,t,n)=>(r(e).setInt16(t,n),t+2)},e.INT16_LE={len:2,get:(e,t)=>r(e).getInt16(t,!0),put:(e,t,n)=>(r(e).setInt16(t,n,!0),t+2)},e.INT24_LE={len:3,get(t,r){const n=e.UINT24_LE.get(t,r);return n>8388607?n-16777216:n},put(e,t,n){const i=r(e);return i.setUint8(t,255&n),i.setUint16(t+1,n>>8,!0),t+3}},e.INT24_BE={len:3,get(t,r){const n=e.UINT24_BE.get(t,r);return n>8388607?n-16777216:n},put(e,t,n){const i=r(e);return i.setUint16(t,n>>8),i.setUint8(t+2,255&n),t+3}},e.INT32_BE={len:4,get:(e,t)=>r(e).getInt32(t),put:(e,t,n)=>(r(e).setInt32(t,n),t+4)},e.INT32_LE={len:4,get:(e,t)=>r(e).getInt32(t,!0),put:(e,t,n)=>(r(e).setInt32(t,n,!0),t+4)},e.UINT64_LE={len:8,get:(e,t)=>r(e).getBigUint64(t,!0),put:(e,t,n)=>(r(e).setBigUint64(t,n,!0),t+8)},e.INT64_LE={len:8,get:(e,t)=>r(e).getBigInt64(t,!0),put:(e,t,n)=>(r(e).setBigInt64(t,n,!0),t+8)},e.UINT64_BE={len:8,get:(e,t)=>r(e).getBigUint64(t),put:(e,t,n)=>(r(e).setBigUint64(t,n),t+8)},e.INT64_BE={len:8,get:(e,t)=>r(e).getBigInt64(t),put:(e,t,n)=>(r(e).setBigInt64(t,n),t+8)},e.Float16_BE={len:2,get(e,r){return t.read(e,r,!1,10,this.len)},put(e,r,n){return t.write(e,n,r,!1,10,this.len),r+this.len}},e.Float16_LE={len:2,get(e,r){return t.read(e,r,!0,10,this.len)},put(e,r,n){return t.write(e,n,r,!0,10,this.len),r+this.len}},e.Float32_BE={len:4,get:(e,t)=>r(e).getFloat32(t),put:(e,t,n)=>(r(e).setFloat32(t,n),t+4)},e.Float32_LE={len:4,get:(e,t)=>r(e).getFloat32(t,!0),put:(e,t,n)=>(r(e).setFloat32(t,n,!0),t+4)},e.Float64_BE={len:8,get:(e,t)=>r(e).getFloat64(t),put:(e,t,n)=>(r(e).setFloat64(t,n),t+8)},e.Float64_LE={len:8,get:(e,t)=>r(e).getFloat64(t,!0),put:(e,t,n)=>(r(e).setFloat64(t,n,!0),t+8)},e.Float80_BE={len:10,get(e,r){return t.read(e,r,!1,63,this.len)},put(e,r,n){return t.write(e,n,r,!1,63,this.len),r+this.len}},e.Float80_LE={len:10,get(e,r){return t.read(e,r,!0,63,this.len)},put(e,r,n){return t.write(e,n,r,!0,63,this.len),r+this.len}};e.IgnoreType=class{constructor(e){this.len=e}get(e,t){}};e.Uint8ArrayType=class{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}};e.BufferType=class{constructor(e){this.len=e}get(e,t){return e.slice(t,t+this.len)}};e.StringType=class{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return Buffer.from(e).toString(this.encoding,t,t+this.len)}};class n{constructor(e){this.len=e}static decode(e,t,r){let i="";for(let o=t;o<r;++o)i+=n.codePointToString(n.singleByteDecoder(e[o]));return i}static inRange(e,t,r){return t<=e&&e<=r}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(n.inRange(e,0,127))return e;const t=n.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return n.decode(e,t,t+this.len)}}e.AnsiStringType=n,n.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]}(lib);var util$b={stringToBytes:e=>[...e].map((e=>e.charCodeAt(0))),tarHeaderChecksumMatches:(e,t=0)=>{const r=parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(r))return!1;let n=256;for(let i=t;i<t+148;i++)n+=e[i];for(let i=t+156;i<t+512;i++)n+=e[i];return r===n},uint32SyncSafeToken:{get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4}},supported$1={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]};const Token$t=lib,strtok3$5=core$1,{stringToBytes:stringToBytes,tarHeaderChecksumMatches:tarHeaderChecksumMatches,uint32SyncSafeToken:uint32SyncSafeToken}=util$b,supported=supported$1,minimumBytes=4100;async function fromStream(e){const t=await strtok3$5.fromStream(e);try{return await fromTokenizer(t)}finally{await t.close()}}async function fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Buffer?e:Buffer.from(e);if(!(t&&t.length>1))return;return fromTokenizer(strtok3$5.fromBuffer(t))}function _check(e,t,r){r=__spreadValues({offset:0},r);for(const[n,i]of t.entries())if(r.mask){if(i!==(r.mask[n]&e[n+r.offset]))return!1}else if(i!==e[n+r.offset])return!1;return!0}async function fromTokenizer(e){try{return _fromTokenizer(e)}catch(t){if(!(t instanceof strtok3$5.EndOfStreamError))throw t}}async function _fromTokenizer(e){let t=Buffer.alloc(minimumBytes);const r=(e,r)=>_check(t,e,r),n=(e,t)=>r(stringToBytes(e),t);if(e.fileInfo.size||(e.fileInfo.size=Number.MAX_SAFE_INTEGER),await e.peekBuffer(t,{length:12,mayBeLess:!0}),r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(r([37,33]))return await e.peekBuffer(t,{length:24,mayBeLess:!0}),n("PS-Adobe-",{offset:2})&&n(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n("ID3")){await e.ignore(6);const t=await e.readToken(uint32SyncSafeToken);return e.position+t>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(t),fromTokenizer(e))}if(n("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===t[0]||70===t[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n("FLIF"))return{ext:"flif",mime:"image/flif"};if(n("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(n("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(n("FORM"))return{ext:"aif",mime:"audio/aiff"};if(n("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(r([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(t,{length:30});const r={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)};if(r.filename=await e.readToken(new Token$t.StringType(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),"META-INF/mozilla.rsa"===r.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml")){switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===r.filename&&r.compressedSize===r.uncompressedSize){switch(await e.readToken(new Token$t.StringType(r.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===r.compressedSize){let r=-1;for(;r<0&&e.position<e.fileInfo.size;)await e.peekBuffer(t,{mayBeLess:!0}),r=t.indexOf("504B0304",0,"hex"),await e.ignore(r>=0?r:t.length)}else await e.ignore(r.compressedSize)}}catch(c){if(!(c instanceof strtok3$5.EndOfStreamError))throw c}return{ext:"zip",mime:"application/zip"}}if(n("OggS")){await e.ignore(28);const t=Buffer.alloc(8);return await e.readBuffer(t),_check(t,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(t,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(t,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(t,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(t,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(t,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(r([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(n("ftyp",{offset:4})&&0!=(96&t[8])){const e=t.toString("binary",8,12).replace("\0"," ").trim();switch(e){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return e.startsWith("3g")?e.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(n("MThd"))return{ext:"mid",mime:"audio/midi"};if(n("wOFF")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(n("wOF2")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([212,195,178,161])||r([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(n("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(n("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(n("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(n("%PDF")){await e.ignore(1350);const t=10485760,r=Buffer.alloc(Math.min(t,e.fileInfo.size));return await e.readBuffer(r,{mayBeLess:!0}),r.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([73,73,42,0]))return n("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:r([28,0,254,0],{offset:8})||r([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:r([8,0,0,0],{offset:4})&&(r([45,0,254,0],{offset:8})||r([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(t=Buffer.alloc(24),await e.peekBuffer(t),(r([16,251,134,1],{offset:4})||r([8,0,0,0],{offset:4}))&&r([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n("MAC "))return{ext:"ape",mime:"audio/ape"};if(r([26,69,223,163])){async function i(){const t=await e.peekNumber(Token$t.UINT8);let r=128,n=0;for(;0==(t&r);)++n,r>>=1;const i=Buffer.alloc(n+1);return await e.readBuffer(i),i}async function o(){const e=await i(),t=await i();t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}const t=await o();switch(await async function(t,r){for(;r>0;){const t=await o();if(17026===t.id)return e.readToken(new Token$t.StringType(t.len,"utf-8"));await e.ignore(t.len),--r}}(0,t.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n("MSCF")||n("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(r([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(n("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n("IMPM"))return{ext:"it",mime:"audio/x-it"};if(n("-lh0-",{offset:2})||n("-lh1-",{offset:2})||n("-lh2-",{offset:2})||n("-lh3-",{offset:2})||n("-lh4-",{offset:2})||n("-lh5-",{offset:2})||n("-lh6-",{offset:2})||n("-lh7-",{offset:2})||n("-lzs-",{offset:2})||n("-lz4-",{offset:2})||n("-lz5-",{offset:2})||n("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(r([0,0,1,186])){if(r([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(r([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(n("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n("solid "))return{ext:"stl",mime:"model/stl"};if(n("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(n("!<arch>")){await e.ignore(8);return"debian-binary"===await e.readToken(new Token$t.StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(r([137,80,78,71,13,10,26,10])){async function a(){return{length:await e.readToken(Token$t.INT32_BE),type:await e.readToken(new Token$t.StringType(4,"binary"))}}await e.ignore(8);do{const t=await a();if(t.length<0)return;switch(t.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(t.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(r([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(r([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(r([102,114,101,101],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(n("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(r([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r([48,38,178,117,142,102,207,17,166,217])){async function s(){const t=Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Token$t.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const t=await s();let r=t.size-24;if(_check(t.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const t=Buffer.alloc(16);if(r-=await e.readBuffer(t),_check(t,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(t,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(r)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((r([126,16,4])||r([126,24,4]))&&r([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(r([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){await e.ignore(20);switch(await e.readToken(new Token$t.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(r([255,10])||r([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(t,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),n("BEGIN:")){if(n("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(n("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(n("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(n("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(n("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(r([4,0,0,0])&&t.length>=16){const e=t.readUInt32LE(12);if(e>12&&t.length>=e+16)try{const r=t.slice(16,e+16).toString();if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch(u){}}if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(r([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(r([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(t,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(r([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(n("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(t.length>=2&&r([255,224],{offset:0,mask:[255,224]})){if(r([16],{offset:1,mask:[22]}))return r([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(r([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const e=new stream.PassThrough;let t;t=stream.pipeline?stream.pipeline(readableStream,e,(()=>{})):readableStream.pipe(e);const r=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const t=await fromBuffer(r);e.fileType=t}catch(n){reject(n)}resolve(t)}))})),fileType={fromStream:fromStream,fromTokenizer:fromTokenizer,fromBuffer:fromBuffer,stream:stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)});var core=fileType,contentType={},PARAM_REGEXP=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,TEXT_REGEXP=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,TOKEN_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,QESC_REGEXP=/\\([\u000b\u0020-\u00ff])/g,QUOTE_REGEXP=/([\\"])/g,TYPE_REGEXP$1=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function format$1(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!TYPE_REGEXP$1.test(r))throw new TypeError("invalid type");var n=r;if(t&&"object"==typeof t)for(var i,o=Object.keys(t).sort(),a=0;a<o.length;a++){if(i=o[a],!TOKEN_REGEXP.test(i))throw new TypeError("invalid parameter name");n+="; "+i+"="+qstring(t[i])}return n}function parse$2(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?getcontenttype(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var r=t.indexOf(";"),n=-1!==r?t.substr(0,r).trim():t.trim();if(!TYPE_REGEXP$1.test(n))throw new TypeError("invalid media type");var i=new ContentType$1(n.toLowerCase());if(-1!==r){var o,a,s;for(PARAM_REGEXP.lastIndex=r;a=PARAM_REGEXP.exec(t);){if(a.index!==r)throw new TypeError("invalid parameter format");r+=a[0].length,o=a[1].toLowerCase(),'"'===(s=a[2])[0]&&(s=s.substr(1,s.length-2).replace(QESC_REGEXP,"$1")),i.parameters[o]=s}if(r!==t.length)throw new TypeError("invalid parameter format")}return i}function getcontenttype(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}function qstring(e){var t=String(e);if(TOKEN_REGEXP.test(t))return t;if(t.length>0&&!TEXT_REGEXP.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(QUOTE_REGEXP,"\\$1")+'"'}function ContentType$1(e){this.parameters=Object.create(null),this.type=e}contentType.format=format$1,contentType.parse=parse$2;var mediaTyper={},SUBTYPE_NAME_REGEXP=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,TYPE_NAME_REGEXP=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,TYPE_REGEXP=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;
/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */function format(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.subtype,r=e.suffix,n=e.type;if(!n||!TYPE_NAME_REGEXP.test(n))throw new TypeError("invalid type");if(!t||!SUBTYPE_NAME_REGEXP.test(t))throw new TypeError("invalid subtype");var i=n+"/"+t;if(r){if(!TYPE_NAME_REGEXP.test(r))throw new TypeError("invalid suffix");i+="+"+r}return i}function test(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");return TYPE_REGEXP.test(e.toLowerCase())}function parse$1(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var t=TYPE_REGEXP.exec(e.toLowerCase());if(!t)throw new TypeError("invalid media type");var r,n=t[1],i=t[2],o=i.lastIndexOf("+");return-1!==o&&(r=i.substr(o+1),i=i.substr(0,o)),new MediaType(n,i,r)}function MediaType(e,t,r){this.type=e,this.subtype=t,this.suffix=r}mediaTyper.format=format,mediaTyper.parse=parse$1,mediaTyper.test=test;var browser={exports:{}},s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d,ms=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return parse(e);if("number"===r&&isFinite(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"weeks":case"week":case"w":return r*w;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fmtShort(e){var t=Math.abs(e);return t>=d?Math.round(e/d)+"d":t>=h?Math.round(e/h)+"h":t>=m?Math.round(e/m)+"m":t>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){var t=Math.abs(e);return t>=d?plural(e,t,d,"day"):t>=h?plural(e,t,h,"hour"):t>=m?plural(e,t,m,"minute"):t>=s?plural(e,t,s,"second"):e+" ms"}function plural(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}function setup(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=ms,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}var common$3=setup;!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!=typeof process&&"env"in process&&(e={}.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=common$3(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}(browser,browser.exports);var MetadataCollector$1={},type={},exports,TrackType;exports=type,Object.defineProperty(exports,"__esModule",{value:!0}),exports.TrackType=void 0,(TrackType=exports.TrackType||(exports.TrackType={}))[TrackType.video=1]="video",TrackType[TrackType.audio=2]="audio",TrackType[TrackType.complex=3]="complex",TrackType[TrackType.logo=4]="logo",TrackType[TrackType.subtitle=17]="subtitle",TrackType[TrackType.button=18]="button",TrackType[TrackType.control=32]="control";var GenericTagTypes={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isUnique=e.isSingleton=e.commonTags=void 0,e.commonTags={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}},e.isSingleton=function(t){return e.commonTags.hasOwnProperty(t)&&!e.commonTags[t].multiple},e.isUnique=function(t){return!e.commonTags[t].multiple||e.commonTags[t].unique}}(GenericTagTypes);var CombinedTagMapper$1={},ID3v1TagMap={},GenericTagMapper={};Object.defineProperty(GenericTagMapper,"__esModule",{value:!0}),GenericTagMapper.CommonTagMapper=void 0;class CommonTagMapper{constructor(e,t){this.tagTypes=e,this.tagMap=t}static toIntOrNull(e){const t=parseInt(e,10);return isNaN(t)?null:t}static normalizeTrack(e){const t=e.toString().split("/");return{no:parseInt(t[0],10)||null,of:parseInt(t[1],10)||null}}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}}GenericTagMapper.CommonTagMapper=CommonTagMapper,CommonTagMapper.maxRatingScore=1,Object.defineProperty(ID3v1TagMap,"__esModule",{value:!0}),ID3v1TagMap.ID3v1TagMapper=void 0;const GenericTagMapper_1$5=GenericTagMapper,id3v1TagMap={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class ID3v1TagMapper extends GenericTagMapper_1$5.CommonTagMapper{constructor(){super(["ID3v1"],id3v1TagMap)}}ID3v1TagMap.ID3v1TagMapper=ID3v1TagMapper;var ID3v24TagMapper$1={},Util={};function getBit(e,t,r){return 0!=(e[t]&1<<r)}function findZero(e,t,r,n){let i=t;if("utf16le"===n){for(;0!==e[i]||0!==e[i+1];){if(i>=r)return r;i+=2}return i}for(;0!==e[i];){if(i>=r)return r;i++}return i}function trimRightNull(e){const t=e.indexOf("\0");return-1===t?e:e.substr(0,t)}function swapBytes(e){const t=e.length;if(0!=(1&t))throw new Error("Buffer length must be even");for(let r=0;r<t;r+=2){const t=e[r];e[r]=e[r+1],e[r+1]=t}return e}function decodeString(e,t){let r=0;if(255===e[0]&&254===e[1])("utf16le"===t||254===e[2]&&255===e[3])&&(r=2);else if("utf16le"===t&&254===e[0]&&255===e[1])return decodeString(swapBytes(e),t);return e.toString(t,r)}function stripNulls(e){return e=(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")}function getBitAllignedNumber(e,t,r,n){const i=r%8;let o=e[t+~~(r/8)];o&=255>>i;const a=8-i,s=n-a;return s<0?o>>=8-i-n:s>0&&(o<<=s,o|=getBitAllignedNumber(e,t,r+a,s)),o}function isBitSet(e,t,r){return 1===getBitAllignedNumber(e,t,r,1)}function a2hex(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=Number(e.charCodeAt(r)).toString(16);t.push(1===n.length?"0"+n:n)}return t.join(" ")}function ratioToDb(e){return 10*Math.log10(e)}function dbToRatio(e){return Math.pow(10,e/10)}function toRatio(e){const t=e.split(" ").map((e=>e.trim().toLowerCase()));if(t.length>=1){const e=parseFloat(t[0]);return 2===t.length&&"db"===t[1]?{dB:e,ratio:dbToRatio(e)}:{dB:ratioToDb(e),ratio:e}}}Object.defineProperty(Util,"__esModule",{value:!0}),Util.toRatio=Util.dbToRatio=Util.ratioToDb=Util.a2hex=Util.isBitSet=Util.getBitAllignedNumber=Util.stripNulls=Util.decodeString=Util.trimRightNull=Util.findZero=Util.getBit=void 0,Util.getBit=getBit,Util.findZero=findZero,Util.trimRightNull=trimRightNull,Util.decodeString=decodeString,Util.stripNulls=stripNulls,Util.getBitAllignedNumber=getBitAllignedNumber,Util.isBitSet=isBitSet,Util.a2hex=a2hex,Util.ratioToDb=ratioToDb,Util.dbToRatio=dbToRatio,Util.toRatio=toRatio;var CaseInsensitiveTagMap$1={};Object.defineProperty(CaseInsensitiveTagMap$1,"__esModule",{value:!0}),CaseInsensitiveTagMap$1.CaseInsensitiveTagMap=void 0;const GenericTagMapper_1$4=GenericTagMapper;class CaseInsensitiveTagMap extends GenericTagMapper_1$4.CommonTagMapper{constructor(e,t){const r={};for(const n of Object.keys(t))r[n.toUpperCase()]=t[n];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}CaseInsensitiveTagMap$1.CaseInsensitiveTagMap=CaseInsensitiveTagMap,Object.defineProperty(ID3v24TagMapper$1,"__esModule",{value:!0}),ID3v24TagMapper$1.ID3v24TagMapper=void 0;const GenericTagMapper_1$3=GenericTagMapper,util$a=Util,CaseInsensitiveTagMap_1$2=CaseInsensitiveTagMap$1,id3v24TagMap={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer","USLT:description":"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"date",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl"};class ID3v24TagMapper extends CaseInsensitiveTagMap_1$2.CaseInsensitiveTagMap{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*GenericTagMapper_1$3.CommonTagMapper.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],id3v24TagMap)}postMap(e,t){switch(e.id){case"UFID":"http://musicbrainz.org"===e.value.owner_identifier&&(e.id+=":"+e.value.owner_identifier,e.value=util$a.decodeString(e.value.identifier,"latin1"));break;case"PRIV":switch(e.value.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=":"+e.value.owner_identifier,e.value=4===e.value.data.length?e.value.data.readUInt32LE(0):null,null===e.value&&t.addWarning("Failed to parse PRIV:PeakValue");break;default:t.addWarning(`Unknown PRIV owner-identifier: ${e.value.owner_identifier}`)}break;case"COMM":e.value=e.value?e.value.text:null;break;case"POPM":e.value=ID3v24TagMapper.toRating(e.value)}}}ID3v24TagMapper$1.ID3v24TagMapper=ID3v24TagMapper;var AsfTagMapper$1={};Object.defineProperty(AsfTagMapper$1,"__esModule",{value:!0}),AsfTagMapper$1.AsfTagMapper=void 0;const GenericTagMapper_1$2=GenericTagMapper,asfTagMap={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class AsfTagMapper extends GenericTagMapper_1$2.CommonTagMapper{static toRating(e){return{rating:parseFloat(e+1)/5}}constructor(){super(["asf"],asfTagMap)}postMap(e){switch(e.id){case"WM/SharedUserRating":const t=e.id.split(":");e.value=AsfTagMapper.toRating(e.value),e.id=t[0]}}}AsfTagMapper$1.AsfTagMapper=AsfTagMapper;var ID3v22TagMapper={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ID3v22TagMapper=e.id3v22TagMap=void 0;const t=CaseInsensitiveTagMap$1;e.id3v22TagMap={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website","COM:iTunPGAP":"gapless",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl"};class r extends t.CaseInsensitiveTagMap{constructor(){super(["ID3v2.2"],e.id3v22TagMap)}}e.ID3v22TagMapper=r}(ID3v22TagMapper);var APEv2TagMapper$1={};Object.defineProperty(APEv2TagMapper$1,"__esModule",{value:!0}),APEv2TagMapper$1.APEv2TagMapper=void 0;const CaseInsensitiveTagMap_1$1=CaseInsensitiveTagMap$1,apev2TagMap={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class APEv2TagMapper extends CaseInsensitiveTagMap_1$1.CaseInsensitiveTagMap{constructor(){super(["APEv2"],apev2TagMap)}}APEv2TagMapper$1.APEv2TagMapper=APEv2TagMapper;var MP4TagMapper={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MP4TagMapper=e.tagType=void 0;const t=CaseInsensitiveTagMap$1,r={"nam":"title","ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","alb":"album","day":"date","cmt":"comment","com":"comment",trkn:"track",disk:"disk","gen":"genre",covr:"picture","wrt":"composer","lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear",desc:"description",ldes:"longDescription","mvn":"movement","mvi":"movementIndex","mvc":"movementTotal","wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik"};e.tagType="iTunes";class n extends t.CaseInsensitiveTagMap{constructor(){super([e.tagType],r)}}e.MP4TagMapper=n}(MP4TagMapper);var VorbisTagMapper$1={};Object.defineProperty(VorbisTagMapper$1,"__esModule",{value:!0}),VorbisTagMapper$1.VorbisTagMapper=void 0;const GenericTagMapper_1$1=GenericTagMapper,vorbisTagMap={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class VorbisTagMapper extends GenericTagMapper_1$1.CommonTagMapper{static toRating(e,t){return{source:e?e.toLowerCase():e,rating:parseFloat(t)*GenericTagMapper_1$1.CommonTagMapper.maxRatingScore}}constructor(){super(["vorbis"],vorbisTagMap)}postMap(e){if(0===e.id.indexOf("RATING:")){const t=e.id.split(":");e.value=VorbisTagMapper.toRating(t[1],e.value),e.id=t[0]}}}VorbisTagMapper$1.VorbisTagMapper=VorbisTagMapper;var RiffInfoTagMap={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RiffInfoTagMapper=e.riffInfoTagMap=void 0;const t=GenericTagMapper;e.riffInfoTagMap={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class r extends t.CommonTagMapper{constructor(){super(["exif"],e.riffInfoTagMap)}}e.RiffInfoTagMapper=r}(RiffInfoTagMap);var MatroskaTagMapper$1={};Object.defineProperty(MatroskaTagMapper$1,"__esModule",{value:!0}),MatroskaTagMapper$1.MatroskaTagMapper=void 0;const CaseInsensitiveTagMap_1=CaseInsensitiveTagMap$1,ebmlTagMap={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class MatroskaTagMapper extends CaseInsensitiveTagMap_1.CaseInsensitiveTagMap{constructor(){super(["matroska"],ebmlTagMap)}}MatroskaTagMapper$1.MatroskaTagMapper=MatroskaTagMapper,Object.defineProperty(CombinedTagMapper$1,"__esModule",{value:!0}),CombinedTagMapper$1.CombinedTagMapper=void 0;const ID3v1TagMap_1=ID3v1TagMap,ID3v24TagMapper_1=ID3v24TagMapper$1,AsfTagMapper_1=AsfTagMapper$1,ID3v22TagMapper_1=ID3v22TagMapper,APEv2TagMapper_1=APEv2TagMapper$1,MP4TagMapper_1=MP4TagMapper,VorbisTagMapper_1=VorbisTagMapper$1,RiffInfoTagMap_1=RiffInfoTagMap,MatroskaTagMapper_1=MatroskaTagMapper$1;class CombinedTagMapper{constructor(){this.tagMappers={},[new ID3v1TagMap_1.ID3v1TagMapper,new ID3v22TagMapper_1.ID3v22TagMapper,new ID3v24TagMapper_1.ID3v24TagMapper,new MP4TagMapper_1.MP4TagMapper,new MP4TagMapper_1.MP4TagMapper,new VorbisTagMapper_1.VorbisTagMapper,new APEv2TagMapper_1.APEv2TagMapper,new AsfTagMapper_1.AsfTagMapper,new RiffInfoTagMap_1.RiffInfoTagMapper,new MatroskaTagMapper_1.MatroskaTagMapper].forEach((e=>{this.registerTagMapper(e)}))}mapTag(e,t,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,r);throw new Error("No generic tag mapper defined for tag-format: "+e)}registerTagMapper(e){for(const t of e.tagTypes)this.tagMappers[t]=e}}CombinedTagMapper$1.CombinedTagMapper=CombinedTagMapper,Object.defineProperty(MetadataCollector$1,"__esModule",{value:!0}),MetadataCollector$1.joinArtists=MetadataCollector$1.MetadataCollector=void 0;const type_1$2=type,_debug$7=browser.exports,GenericTagTypes_1=GenericTagTypes,CombinedTagMapper_1=CombinedTagMapper$1,GenericTagMapper_1=GenericTagMapper,Util_1=Util,FileType$1=core,debug$n=_debug$7("music-metadata:collector"),TagPriority=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","ID3v1"];class MetadataCollector{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new CombinedTagMapper_1.CombinedTagMapper;let t=1;for(const r of TagPriority)this.originPriority[r]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){debug$n(`streamInfo: type=${type_1$2.TrackType[e.type]}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){debug$n(`format: ${e} = ${t}`),this.format[e]=t,this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:t}})}addTag(e,t,r){debug$n(`tag ${e}.${t} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:r}),this.toCommon(e,t,r)}addWarning(e){this.quality.warnings.push({message:e})}postMap(e,t){switch(t.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:t.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:t.value});break;case"artists":if(!(this.common.artist&&this.commonOrigin.artist!==this.originPriority.artificial||this.common.artists&&-1!==this.common.artists.indexOf(t.value))){const e={id:"artist",value:joinArtists((this.common.artists||[]).concat([t.value]))};this.setGenericTag("artificial",e)}break;case"picture":return void this.postFixPicture(t.value).then((r=>{null!==r&&(t.value=r,this.setGenericTag(e,t))}));case"totaltracks":return void(this.common.track.of=GenericTagMapper_1.CommonTagMapper.toIntOrNull(t.value));case"totaldiscs":return void(this.common.disk.of=GenericTagMapper_1.CommonTagMapper.toIntOrNull(t.value));case"movementTotal":return void(this.common.movementIndex.of=GenericTagMapper_1.CommonTagMapper.toIntOrNull(t.value));case"track":case"disk":case"movementIndex":const r=this.common[t.id].of;return this.common[t.id]=GenericTagMapper_1.CommonTagMapper.normalizeTrack(t.value),void(this.common[t.id].of=null!=r?r:this.common[t.id].of);case"year":case"originalyear":t.value=parseInt(t.value,10);break;case"date":const n=parseInt(t.value.substr(0,4),10);isNaN(n)||(this.common.year=n);break;case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":t.value="string"==typeof t.value?parseInt(t.value,10):t.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":t.value=Util_1.toRatio(t.value);break;case"replaygain_track_minmax":t.value=t.value.split(",").map((e=>parseInt(e,10)));break;case"replaygain_undo":const i=t.value.split(",").map((e=>parseInt(e,10)));t.value={leftChannel:i[0],rightChannel:i[1]};break;case"gapless":case"compilation":case"podcast":case"showMovement":t.value="1"===t.value||1===t.value;break;case"isrc":if(this.common[t.id]&&-1!==this.common[t.id].indexOf(t.value))return}null!==t.value&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const t=await FileType$1.fromBuffer(e.data);if(!t)return null;e.format=t.mime}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}toCommon(e,t,r){const n={id:t,value:r},i=this.tagMapper.mapTag(e,n,this);i&&this.postMap(e,i)}setGenericTag(e,t){debug$n(`common.${t.id} = ${t.value}`);const r=this.commonOrigin[t.id]||1e3,n=this.originPriority[e];if(GenericTagTypes_1.isSingleton(t.id)){if(!(n<=r))return debug$n(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);this.common[t.id]=t.value,this.commonOrigin[t.id]=n}else if(n===r)GenericTagTypes_1.isUnique(t.id)&&-1!==this.common[t.id].indexOf(t.value)?debug$n(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`):this.common[t.id].push(t.value);else{if(!(n<r))return debug$n(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.common[t.id]=[t.value],this.commonOrigin[t.id]=n}this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:t.id,value:t.value}})}}function joinArtists(e){return e.length>2?e.slice(0,e.length-1).join(", ")+" & "+e[e.length-1]:e.join(" & ")}MetadataCollector$1.MetadataCollector=MetadataCollector,MetadataCollector$1.joinArtists=joinArtists;var AiffParser={},ID3v2Parser$1={},FrameParser$1={},ID3v2Token={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TextEncodingToken=e.ExtendedHeader=e.ID3v2Header=e.UINT32SYNCSAFE=e.AttachedPictureType=void 0;const t=lib,r=Util;var n;(n=e.AttachedPictureType||(e.AttachedPictureType={}))[n.Other=0]="Other",n[n["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",n[n["Other file icon"]=2]="Other file icon",n[n["Cover (front)"]=3]="Cover (front)",n[n["Cover (back)"]=4]="Cover (back)",n[n["Leaflet page"]=5]="Leaflet page",n[n["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",n[n["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",n[n["Artist/performer"]=8]="Artist/performer",n[n.Conductor=9]="Conductor",n[n["Band/Orchestra"]=10]="Band/Orchestra",n[n.Composer=11]="Composer",n[n["Lyricist/text writer"]=12]="Lyricist/text writer",n[n["Recording Location"]=13]="Recording Location",n[n["During recording"]=14]="During recording",n[n["During performance"]=15]="During performance",n[n["Movie/video screen capture"]=16]="Movie/video screen capture",n[n["A bright coloured fish"]=17]="A bright coloured fish",n[n.Illustration=18]="Illustration",n[n["Band/artist logotype"]=19]="Band/artist logotype",n[n["Publisher/Studio logotype"]=20]="Publisher/Studio logotype",e.UINT32SYNCSAFE={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},e.ID3v2Header={len:10,get:(n,i)=>({fileIdentifier:new t.StringType(3,"ascii").get(n,i),version:{major:t.INT8.get(n,i+3),revision:t.INT8.get(n,i+4)},flags:{unsynchronisation:r.getBit(n,i+5,7),isExtendedHeader:r.getBit(n,i+5,6),expIndicator:r.getBit(n,i+5,5),footer:r.getBit(n,i+5,4)},size:e.UINT32SYNCSAFE.get(n,i+6)})},e.ExtendedHeader={len:10,get:(e,n)=>({size:t.UINT32_BE.get(e,n),extendedFlags:t.UINT16_BE.get(e,n+4),sizeOfPadding:t.UINT32_BE.get(e,n+6),crcDataPresent:r.getBit(e,n+4,31)})},e.TextEncodingToken={len:1,get:(e,t)=>{switch(e.readUInt8(t)){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf16le",bom:!0};case 2:return{encoding:"utf16le",bom:!1};case 3:default:return{encoding:"utf8",bom:!1}}}}}(ID3v2Token);var ID3v1Parser={},BasicParser$1={};Object.defineProperty(BasicParser$1,"__esModule",{value:!0}),BasicParser$1.BasicParser=void 0;class BasicParser{init(e,t,r){return this.metadata=e,this.tokenizer=t,this.options=r,this}}BasicParser$1.BasicParser=BasicParser;var APEv2Parser$1={},APEv2Token={},FourCC={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FourCcToken=void 0;const t=Util,r=/^[\x21-\x7e][\x20-\x7e\x00()]{3}/;e.FourCcToken={len:4,get:(n,i)=>{const o=n.toString("binary",i,i+e.FourCcToken.len);if(!o.match(r))throw new Error(`FourCC contains invalid characters: ${t.a2hex(o)} "${o}"`);return o},put:(e,t,r)=>{const n=Buffer.from(r,"binary");if(4!==n.length)throw new Error("Invalid length");return n.copy(e,t)}}}(FourCC),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isBitSet=e.parseTagFlags=e.TagField=e.TagItemHeader=e.TagFooter=e.Header=e.DescriptorParser=e.DataType=void 0;const t=lib,r=FourCC;var n;(n=e.DataType||(e.DataType={}))[n.text_utf8=0]="text_utf8",n[n.binary=1]="binary",n[n.external_info=2]="external_info",n[n.reserved=3]="reserved",e.DescriptorParser={len:52,get:(e,n)=>({ID:r.FourCcToken.get(e,n),version:t.UINT32_LE.get(e,n+4)/1e3,descriptorBytes:t.UINT32_LE.get(e,n+8),headerBytes:t.UINT32_LE.get(e,n+12),seekTableBytes:t.UINT32_LE.get(e,n+16),headerDataBytes:t.UINT32_LE.get(e,n+20),apeFrameDataBytes:t.UINT32_LE.get(e,n+24),apeFrameDataBytesHigh:t.UINT32_LE.get(e,n+28),terminatingDataBytes:t.UINT32_LE.get(e,n+32),fileMD5:new t.Uint8ArrayType(16).get(e,n+36)})},e.Header={len:24,get:(e,r)=>({compressionLevel:t.UINT16_LE.get(e,r),formatFlags:t.UINT16_LE.get(e,r+2),blocksPerFrame:t.UINT32_LE.get(e,r+4),finalFrameBlocks:t.UINT32_LE.get(e,r+8),totalFrames:t.UINT32_LE.get(e,r+12),bitsPerSample:t.UINT16_LE.get(e,r+16),channel:t.UINT16_LE.get(e,r+18),sampleRate:t.UINT32_LE.get(e,r+20)})},e.TagFooter={len:32,get:(e,r)=>({ID:new t.StringType(8,"ascii").get(e,r),version:t.UINT32_LE.get(e,r+8),size:t.UINT32_LE.get(e,r+12),fields:t.UINT32_LE.get(e,r+16),flags:i(t.UINT32_LE.get(e,r+20))})},e.TagItemHeader={len:8,get:(e,r)=>({size:t.UINT32_LE.get(e,r),flags:i(t.UINT32_LE.get(e,r+4))})};function i(e){return{containsHeader:o(e,31),containsFooter:o(e,30),isHeader:o(e,31),readOnly:o(e,0),dataType:(6&e)>>1}}function o(e,t){return 0!=(e&1<<t)}e.TagField=r=>new t.Uint8ArrayType(r.size-e.TagFooter.len),e.parseTagFlags=i,e.isBitSet=o}(APEv2Token),Object.defineProperty(APEv2Parser$1,"__esModule",{value:!0}),APEv2Parser$1.APEv2Parser=void 0;const initDebug$f=browser.exports,strtok3$4=core$1,util$9=Util,BasicParser_1$b=BasicParser$1,APEv2Token_1=APEv2Token,token_types_1=lib,debug$m=initDebug$f("music-metadata:parser:APEv2"),tagFormat$1="APEv2",preamble="APETAGEX";class APEv2Parser extends BasicParser_1$b.BasicParser{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,t,r){const n=new APEv2Parser;return n.init(e,t,r),n.tryParseApeHeader()}static calculateDuration(e){let t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return t+=e.finalFrameBlocks,t/e.sampleRate}static async findApeFooterOffset(e,t){const r=Buffer.alloc(APEv2Token_1.TagFooter.len);await e.randomRead(r,0,APEv2Token_1.TagFooter.len,t-APEv2Token_1.TagFooter.len);const n=APEv2Token_1.TagFooter.get(r,0);if("APETAGEX"===n.ID)return debug$m(`APE footer header at offset=${t}`),{footer:n,offset:t-n.size}}static parseTagFooter(e,t,r){const n=APEv2Token_1.TagFooter.get(t,t.length-APEv2Token_1.TagFooter.len);if(n.ID!==preamble)throw new Error("Unexpected APEv2 Footer ID preamble value.");strtok3$4.fromBuffer(t);const i=new APEv2Parser;return i.init(e,strtok3$4.fromBuffer(t),r),i.parseTags(n)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<APEv2Token_1.TagFooter.len)return void debug$m("No APEv2 header found, end-of-file reached");const e=await this.tokenizer.peekToken(APEv2Token_1.TagFooter);if(e.ID===preamble)return await this.tokenizer.ignore(APEv2Token_1.TagFooter.len),this.parseTags(e);if(debug$m(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position,t=Buffer.alloc(e);return await this.tokenizer.readBuffer(t),APEv2Parser.parseTagFooter(this.metadata,t,this.options)}}async parse(){const e=await this.tokenizer.readToken(APEv2Token_1.DescriptorParser);if("MAC "!==e.ID)throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const t=e.descriptorBytes-APEv2Token_1.DescriptorParser.len,r=await(t>0?this.parseDescriptorExpansion(t):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const t=Buffer.alloc(256);let r=e.size-APEv2Token_1.TagFooter.len;debug$m(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let n=0;n<e.fields;n++){if(r<APEv2Token_1.TagItemHeader.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-n} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(APEv2Token_1.TagItemHeader);r-=APEv2Token_1.TagItemHeader.len+i.size,await this.tokenizer.peekBuffer(t,{length:Math.min(t.length,r)});let o=util$9.findZero(t,0,t.length);const a=await this.tokenizer.readToken(new token_types_1.StringType(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=a.length+1,i.flags.dataType){case APEv2Token_1.DataType.text_utf8:{const e=(await this.tokenizer.readToken(new token_types_1.StringType(i.size,"utf8"))).split(/\x00/g);for(const t of e)this.metadata.addTag(tagFormat$1,a,t);break}case APEv2Token_1.DataType.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const e=Buffer.alloc(i.size);await this.tokenizer.readBuffer(e),o=util$9.findZero(e,0,e.length);const t=e.toString("utf8",0,o),r=Buffer.from(e.slice(o+1));this.metadata.addTag(tagFormat$1,a,{description:t,data:r})}break;case APEv2Token_1.DataType.external_info:debug$m(`Ignore external info ${a}`),await this.tokenizer.ignore(i.size);break;default:throw new Error(`Unexpected data-type: ${i.flags.dataType}`)}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(APEv2Token_1.Header);return this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",APEv2Parser.calculateDuration(e)),{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}APEv2Parser$1.APEv2Parser=APEv2Parser,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hasID3v1Header=e.ID3v1Parser=e.Genres=void 0;const t=browser.exports,r=Util,n=lib,i=BasicParser$1,o=APEv2Parser$1,a=t("music-metadata:parser:ID3v1");e.Genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"];const s={len:128,get:(e,t)=>{const r=new c(3).get(e,t);return"TAG"===r?{header:r,title:new c(30).get(e,t+3),artist:new c(30).get(e,t+33),album:new c(30).get(e,t+63),year:new c(4).get(e,t+93),comment:new c(28).get(e,t+97),zeroByte:n.UINT8.get(e,t+127),track:n.UINT8.get(e,t+126),genre:n.UINT8.get(e,t+127)}:null}};class c extends n.StringType{constructor(e){super(e,"binary")}get(e,t){let n=super.get(e,t);return n=r.trimRightNull(n),n=n.trim(),n.length>0?n:void 0}}class u extends i.BasicParser{static getGenre(t){if(t<e.Genres.length)return e.Genres[t]}async parse(){if(!this.tokenizer.fileInfo.size)return void a("Skip checking for ID3v1 because the file-size is unknown");if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const e=new o.APEv2Parser;e.init(this.metadata,this.tokenizer,this.options),await e.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-s.len;if(this.tokenizer.position>e)return void a("Already consumed the last 128 bytes");const t=await this.tokenizer.readToken(s,e);if(t){a("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-s.len);for(const r of["title","artist","album","comment","track","year"])t[r]&&""!==t[r]&&this.addTag(r,t[r]);const e=u.getGenre(t.genre);e&&this.addTag("genre",e)}else a("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-s.len)}addTag(e,t){this.metadata.addTag("ID3v1",e,t)}}e.ID3v1Parser=u,e.hasID3v1Header=async function(e){if(e.fileSize>=128){const t=Buffer.alloc(3);return await e.randomRead(t,0,t.length,e.fileSize-128),"TAG"===t.toString("binary")}return!1}}(ID3v1Parser),Object.defineProperty(FrameParser$1,"__esModule",{value:!0}),FrameParser$1.FrameParser=FrameParser$1.parseGenre=void 0;const initDebug$e=browser.exports,Token$s=lib,util$8=Util,ID3v2Token_1$3=ID3v2Token,ID3v1Parser_1$3=ID3v1Parser,debug$l=initDebug$e("music-metadata:id3v2:frame-parser"),defaultEnc="latin1";function parseGenre(e){const t=[];let r,n="";for(const i of e)if("string"==typeof r)if("("===i&&""===r)n+="(",r=void 0;else if(")"===i){""!==n&&(t.push(n),n="");const e=parseGenreCode(r);e&&t.push(e),r=void 0}else r+=i;else"("===i?r="":n+=i;return n&&(0===t.length&&n.match(/^\d*$/)&&(n=ID3v1Parser_1$3.Genres[n]),t.push(n)),t}function parseGenreCode(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?ID3v1Parser_1$3.Genres[e]:void 0}FrameParser$1.parseGenre=parseGenre;class FrameParser{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,r){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:n,bom:i}=ID3v2Token_1$3.TextEncodingToken.get(e,0),o=e.length;let a=0,s=[];const c=FrameParser.getNullTerminatorLength(n);let u;const l={};switch(debug$l(`Parsing tag type=${t}, encoding=${n}, bom=${i}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":const i=util$8.decodeString(e.slice(1),n).replace(/\x00+$/,"");switch(t){case"TMCL":case"TIPL":case"IPLS":s=this.splitValue(t,i),s=FrameParser.functionList(s);break;case"TRK":case"TRCK":case"TPOS":s=i;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":s=this.splitValue(t,i);break;case"TCO":case"TCON":s=this.splitValue(t,i).map((e=>parseGenre(e))).reduce(((e,t)=>e.concat(t)),[]);break;case"PCS":case"PCST":s=this.major>=4?this.splitValue(t,i):[i],s=Array.isArray(s)&&""===s[0]?1:0;break;default:s=this.major>=4?this.splitValue(t,i):[i]}break;case"TXXX":s=FrameParser.readIdentifierAndData(e,a+1,o,n),s={description:s.id,text:this.splitValue(t,util$8.decodeString(s.data,n).replace(/\x00+$/,""))};break;case"PIC":case"APIC":if(r){const t={};switch(a+=1,this.major){case 2:t.format=util$8.decodeString(e.slice(a,a+3),"latin1"),a+=3;break;case 3:case 4:u=util$8.findZero(e,a,o,defaultEnc),t.format=util$8.decodeString(e.slice(a,u),defaultEnc),a=u+1;break;default:throw new Error("Warning: unexpected major versionIndex: "+this.major)}t.format=FrameParser.fixPictureMimeType(t.format),t.type=ID3v2Token_1$3.AttachedPictureType[e[a]],a+=1,u=util$8.findZero(e,a,o,n),t.description=util$8.decodeString(e.slice(a,u),n),a=u+c,t.data=Buffer.from(e.slice(a,o)),s=t}break;case"CNT":case"PCNT":s=Token$s.UINT32_BE.get(e,0);break;case"SYLT":for(a+=7,s=[];a<o;){const t=e.slice(a,a=util$8.findZero(e,a,o,n));a+=5,s.push(util$8.decodeString(t,n))}break;case"ULT":case"USLT":case"COM":case"COMM":a+=1,l.language=util$8.decodeString(e.slice(a,a+3),defaultEnc),a+=3,u=util$8.findZero(e,a,o,n),l.description=util$8.decodeString(e.slice(a,u),n),a=u+c,l.text=util$8.decodeString(e.slice(a,o),n).replace(/\x00+$/,""),s=[l];break;case"UFID":s=FrameParser.readIdentifierAndData(e,a,o,defaultEnc),s={owner_identifier:s.id,identifier:s.data};break;case"PRIV":s=FrameParser.readIdentifierAndData(e,a,o,defaultEnc),s={owner_identifier:s.id,data:s.data};break;case"POPM":u=util$8.findZero(e,a,o,defaultEnc);const p=util$8.decodeString(e.slice(a,u),defaultEnc);a=u+1;const f=o-a;s={email:p,rating:e.readUInt8(a),counter:f>=5?e.readUInt32BE(a+1):void 0};break;case"GEOB":{u=util$8.findZero(e,a+1,o,n);const t=util$8.decodeString(e.slice(a+1,u),defaultEnc);a=u+1,u=util$8.findZero(e,a,o-a,n);const r=util$8.decodeString(e.slice(a,u),defaultEnc);a=u+1,u=util$8.findZero(e,a,o-a,n);s={type:t,filename:r,description:util$8.decodeString(e.slice(a,u),defaultEnc),data:e.slice(a+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":s=util$8.decodeString(e.slice(a,u),defaultEnc);break;case"WXXX":{u=util$8.findZero(e,a+1,o,n);const t=util$8.decodeString(e.slice(a+1,u),n);a=u+("utf16le"===n?2:1),s={description:t,url:util$8.decodeString(e.slice(a,o),defaultEnc)};break}case"WFD":case"WFED":s=util$8.decodeString(e.slice(a+1,util$8.findZero(e,a+1,o,n)),n);break;case"MCDI":s=e.slice(0,o);break;default:debug$l("Warning: unsupported id3v2-tag-type: "+t)}return s}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let r=0;r+1<e.length;r+=2){const n=e[r+1].split(",");t[e[r]]=t.hasOwnProperty(e[r])?t[e[r]].concat(n):n}return t}splitValue(e,t){let r;return this.major<4?(r=t.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=t.split(/\//g)):r=t.split(/\x00/g),FrameParser.trimArray(r)}static trimArray(e){return e.map((e=>e.replace(/\x00+$/,"").trim()))}static readIdentifierAndData(e,t,r,n){const i=util$8.findZero(e,t,r,n),o=util$8.decodeString(e.slice(t,i),n);return t=i+FrameParser.getNullTerminatorLength(n),{id:o,data:e.slice(t,r)}}static getNullTerminatorLength(e){return"utf16le"===e?2:1}}FrameParser$1.FrameParser=FrameParser,Object.defineProperty(ID3v2Parser$1,"__esModule",{value:!0}),ID3v2Parser$1.ID3v2Parser=void 0;const Token$r=lib,util$7=Util,FrameParser_1=FrameParser$1,ID3v2Token_1$2=ID3v2Token;class ID3v2Parser{static removeUnsyncBytes(e){let t=0,r=0;for(;t<e.length-1;)t!==r&&(e[r]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,r++;return t<e.length&&(e[r++]=e[t]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:util$7.getBit(e,0,6),file_alter_preservation:util$7.getBit(e,0,5),read_only:util$7.getBit(e,0,4)},format:{grouping_identity:util$7.getBit(e,1,7),compression:util$7.getBit(e,1,3),encryption:util$7.getBit(e,1,2),unsynchronisation:util$7.getBit(e,1,1),data_length_indicator:util$7.getBit(e,1,0)}}}static readFrameData(e,t,r,n,i){const o=new FrameParser_1.FrameParser(r,i);switch(r){case 2:return o.readData(e,t.id,n);case 3:case 4:return t.flags.format.unsynchronisation&&(e=ID3v2Parser.removeUnsyncBytes(e)),t.flags.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,t.id,n);default:throw new Error("Unexpected majorVer: "+r)}}static makeDescriptionTagName(e,t){return e+(t?":"+t:"")}async parse(e,t,r){this.tokenizer=t,this.metadata=e,this.options=r;const n=await this.tokenizer.readToken(ID3v2Token_1$2.ID3v2Header);if("ID3"!==n.fileIdentifier)throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=n,this.headerType="ID3v2."+n.version.major,n.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(n.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(ID3v2Token_1$2.ExtendedHeader),t=e.size-ID3v2Token_1$2.ExtendedHeader.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){const r=Buffer.alloc(e);return await this.tokenizer.readBuffer(r,{length:e}),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=Buffer.alloc(e);await this.tokenizer.readBuffer(t,{length:e});for(const r of this.parseMetadata(t))if("TXXX"===r.id){if(r.value)for(const e of r.value.text)this.addTag(ID3v2Parser.makeDescriptionTagName(r.id,r.value.description),e)}else if("COM"===r.id)for(const e of r.value)this.addTag(ID3v2Parser.makeDescriptionTagName(r.id,e.description),e.text);else if("COMM"===r.id)for(const e of r.value)this.addTag(ID3v2Parser.makeDescriptionTagName(r.id,e.description),e);else if(Array.isArray(r.value))for(const e of r.value)this.addTag(r.id,e);else this.addTag(r.id,r.value)}addTag(e,t){this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const r=[];for(;t!==e.length;){const n=ID3v2Parser.getFrameHeaderLength(this.id3Header.version.major);if(t+n>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(t,t+=n),o=this.readFrameHeader(i,this.id3Header.version.major),a=e.slice(t,t+=o.length),s=ID3v2Parser.readFrameData(a,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);s&&r.push({id:o.id,value:s})}return r}readFrameHeader(e,t){let r;switch(t){case 2:r={id:e.toString("ascii",0,3),length:Token$r.UINT24_BE.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:e.toString("ascii",0,4),length:(4===t?ID3v2Token_1$2.UINT32SYNCSAFE:Token$r.UINT32_BE).get(e,4),flags:ID3v2Parser.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error("Unexpected majorVer: "+t)}return r}}ID3v2Parser$1.ID3v2Parser=ID3v2Parser;var AiffToken$1={};Object.defineProperty(AiffToken$1,"__esModule",{value:!0}),AiffToken$1.Common=void 0;const Token$q=lib,FourCC_1$a=FourCC;class Common{constructor(e,t){this.isAifc=t;const r=t?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,t){const r=e.readUInt16BE(t+8)-16398,n=e.readUInt16BE(t+8+2),i={numChannels:e.readUInt16BE(t),numSampleFrames:e.readUInt32BE(t+2),sampleSize:e.readUInt16BE(t+6),sampleRate:r<0?n>>Math.abs(r):n<<r};if(this.isAifc){if(i.compressionType=FourCC_1$a.FourCcToken.get(e,t+18),this.len>22){const r=e.readInt8(t+22);if(23+r+(r+1)%2!==this.len)throw new Error("Illegal pstring length");i.compressionName=new Token$q.StringType(r,"binary").get(e,t+23)}}else i.compressionName="PCM";return i}}AiffToken$1.Common=Common;var iff$1={};Object.defineProperty(iff$1,"__esModule",{value:!0}),iff$1.Header=void 0;const FourCC_1$9=FourCC,Token$p=lib;iff$1.Header={len:8,get:(e,t)=>({chunkID:FourCC_1$9.FourCcToken.get(e,t),chunkSize:Number(BigInt(Token$p.UINT32_BE.get(e,t+4)))})},Object.defineProperty(AiffParser,"__esModule",{value:!0}),AiffParser.AIFFParser=void 0;const Token$o=lib,initDebug$d=browser.exports,strtok3$3=core$1,ID3v2Parser_1$4=ID3v2Parser$1,FourCC_1$8=FourCC,BasicParser_1$a=BasicParser$1,AiffToken=AiffToken$1,iff=iff$1,debug$k=initDebug$d("music-metadata:parser:aiff");class AIFFParser extends BasicParser_1$a.BasicParser{async parse(){if("FORM"!==(await this.tokenizer.readToken(iff.Header)).chunkID)throw new Error("Invalid Chunk-ID, expected 'FORM'");const e=await this.tokenizer.readToken(FourCC_1$8.FourCcToken);switch(e){case"AIFF":this.metadata.setFormat("container",e),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw Error("Unsupported AIFF type: "+e)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=iff.Header.len;){debug$k("Reading AIFF chunk at offset="+this.tokenizer.position);const e=await this.tokenizer.readToken(iff.Header);debug$k(`Chunk id=${e.chunkID}`);const t=2*Math.round(e.chunkSize/2),r=await this.readData(e);await this.tokenizer.ignore(t-r)}}catch(t){if(!(t instanceof strtok3$3.EndOfStreamError))throw t;debug$k("End-of-stream")}}async readData(e){switch(e.chunkID){case"COMM":const t=await this.tokenizer.readToken(new AiffToken.Common(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",t.sampleSize),this.metadata.setFormat("sampleRate",t.sampleRate),this.metadata.setFormat("numberOfChannels",t.numChannels),this.metadata.setFormat("numberOfSamples",t.numSampleFrames),this.metadata.setFormat("duration",t.numSampleFrames/t.sampleRate),this.metadata.setFormat("codec",t.compressionName),e.chunkSize;case"ID3 ":const r=await this.tokenizer.readToken(new Token$o.Uint8ArrayType(e.chunkSize)),n=strtok3$3.fromBuffer(r);return await(new ID3v2Parser_1$4.ID3v2Parser).parse(this.metadata,n,this.options),e.chunkSize;case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;default:return 0}}}AiffParser.AIFFParser=AIFFParser;var AsfParser$1={},GUID$1={};Object.defineProperty(GUID$1,"__esModule",{value:!0});class GUID{constructor(e){this.str=e}static fromBin(e,t=0){return new GUID(this.decode(e,t))}static decode(e,t=0){return(e.readUInt32LE(t).toString(16)+"-"+e.readUInt16LE(t+4).toString(16)+"-"+e.readUInt16LE(t+6).toString(16)+"-"+e.readUInt16BE(t+8).toString(16)+"-"+e.slice(t+10,t+16).toString("hex")).toUpperCase()}static decodeMediaType(e){switch(e.str){case GUID.AudioMedia.str:return"audio";case GUID.VideoMedia.str:return"video";case GUID.CommandMedia.str:return"command";case GUID.Degradable_JPEG_Media.str:return"degradable-jpeg";case GUID.FileTransferMedia.str:return"file-transfer";case GUID.BinaryMedia.str:return"binary"}}static encode(e){const t=Buffer.alloc(16);return t.writeUInt32LE(parseInt(e.slice(0,8),16),0),t.writeUInt16LE(parseInt(e.slice(9,13),16),4),t.writeUInt16LE(parseInt(e.slice(14,18),16),6),Buffer.from(e.slice(19,23),"hex").copy(t,8),Buffer.from(e.slice(24),"hex").copy(t,10),t}equals(e){return this.str===e.str}toBin(){return GUID.encode(this.str)}}GUID$1.default=GUID,GUID.HeaderObject=new GUID("75B22630-668E-11CF-A6D9-00AA0062CE6C"),GUID.DataObject=new GUID("75B22636-668E-11CF-A6D9-00AA0062CE6C"),GUID.SimpleIndexObject=new GUID("33000890-E5B1-11CF-89F4-00A0C90349CB"),GUID.IndexObject=new GUID("D6E229D3-35DA-11D1-9034-00A0C90349BE"),GUID.MediaObjectIndexObject=new GUID("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),GUID.TimecodeIndexObject=new GUID("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),GUID.FilePropertiesObject=new GUID("8CABDCA1-A947-11CF-8EE4-00C00C205365"),GUID.StreamPropertiesObject=new GUID("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),GUID.HeaderExtensionObject=new GUID("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),GUID.CodecListObject=new GUID("86D15240-311D-11D0-A3A4-00A0C90348F6"),GUID.ScriptCommandObject=new GUID("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),GUID.MarkerObject=new GUID("F487CD01-A951-11CF-8EE6-00C00C205365"),GUID.BitrateMutualExclusionObject=new GUID("D6E229DC-35DA-11D1-9034-00A0C90349BE"),GUID.ErrorCorrectionObject=new GUID("75B22635-668E-11CF-A6D9-00AA0062CE6C"),GUID.ContentDescriptionObject=new GUID("75B22633-668E-11CF-A6D9-00AA0062CE6C"),GUID.ExtendedContentDescriptionObject=new GUID("D2D0A440-E307-11D2-97F0-00A0C95EA850"),GUID.ContentBrandingObject=new GUID("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),GUID.StreamBitratePropertiesObject=new GUID("7BF875CE-468D-11D1-8D82-006097C9A2B2"),GUID.ContentEncryptionObject=new GUID("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),GUID.ExtendedContentEncryptionObject=new GUID("298AE614-2622-4C17-B935-DAE07EE9289C"),GUID.DigitalSignatureObject=new GUID("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),GUID.PaddingObject=new GUID("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),GUID.ExtendedStreamPropertiesObject=new GUID("14E6A5CB-C672-4332-8399-A96952065B5A"),GUID.AdvancedMutualExclusionObject=new GUID("A08649CF-4775-4670-8A16-6E35357566CD"),GUID.GroupMutualExclusionObject=new GUID("D1465A40-5A79-4338-B71B-E36B8FD6C249"),GUID.StreamPrioritizationObject=new GUID("D4FED15B-88D3-454F-81F0-ED5C45999E24"),GUID.BandwidthSharingObject=new GUID("A69609E6-517B-11D2-B6AF-00C04FD908E9"),GUID.LanguageListObject=new GUID("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),GUID.MetadataObject=new GUID("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),GUID.MetadataLibraryObject=new GUID("44231C94-9498-49D1-A141-1D134E457054"),GUID.IndexParametersObject=new GUID("D6E229DF-35DA-11D1-9034-00A0C90349BE"),GUID.MediaObjectIndexParametersObject=new GUID("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),GUID.TimecodeIndexParametersObject=new GUID("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),GUID.CompatibilityObject=new GUID("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),GUID.AdvancedContentEncryptionObject=new GUID("43058533-6981-49E6-9B74-AD12CB86D58C"),GUID.AudioMedia=new GUID("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),GUID.VideoMedia=new GUID("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),GUID.CommandMedia=new GUID("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),GUID.JFIF_Media=new GUID("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),GUID.Degradable_JPEG_Media=new GUID("35907DE0-E415-11CF-A917-00805F5C442B"),GUID.FileTransferMedia=new GUID("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),GUID.BinaryMedia=new GUID("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),GUID.ASF_Index_Placeholder_Object=new GUID("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");var AsfObject$1={},AsfUtil$1={};Object.defineProperty(AsfUtil$1,"__esModule",{value:!0}),AsfUtil$1.AsfUtil=void 0;const util$6=Util,Token$n=lib;class AsfUtil{static getParserForAttr(e){return AsfUtil.attributeParsers[e]}static parseUnicodeAttr(e){return util$6.stripNulls(util$6.decodeString(e,"utf16le"))}static parseByteArrayAttr(e){const t=Buffer.alloc(e.length);return e.copy(t),t}static parseBoolAttr(e,t=0){return 1===AsfUtil.parseWordAttr(e,t)}static parseDWordAttr(e,t=0){return e.readUInt32LE(t)}static parseQWordAttr(e,t=0){return Token$n.UINT64_LE.get(e,t)}static parseWordAttr(e,t=0){return e.readUInt16LE(t)}}AsfUtil$1.AsfUtil=AsfUtil,AsfUtil.attributeParsers=[AsfUtil.parseUnicodeAttr,AsfUtil.parseByteArrayAttr,AsfUtil.parseBoolAttr,AsfUtil.parseDWordAttr,AsfUtil.parseQWordAttr,AsfUtil.parseWordAttr,AsfUtil.parseByteArrayAttr],function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WmPictureToken=e.MetadataLibraryObjectState=e.MetadataObjectState=e.ExtendedStreamPropertiesObjectState=e.ExtendedContentDescriptionObjectState=e.ContentDescriptionObjectState=e.readCodecEntries=e.HeaderExtensionObject=e.StreamPropertiesObject=e.FilePropertiesObject=e.IgnoreObjectState=e.State=e.HeaderObjectToken=e.TopLevelHeaderObjectToken=e.DataType=void 0;const t=Util,r=lib,n=GUID$1,i=AsfUtil$1,o=ID3v2Token;var a;(a=e.DataType||(e.DataType={}))[a.UnicodeString=0]="UnicodeString",a[a.ByteArray=1]="ByteArray",a[a.Bool=2]="Bool",a[a.DWord=3]="DWord",a[a.QWord=4]="QWord",a[a.Word=5]="Word",e.TopLevelHeaderObjectToken={len:30,get:(e,t)=>({objectId:n.default.fromBin(new r.BufferType(16).get(e,t)),objectSize:Number(r.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:r.UINT32_LE.get(e,t+24)})},e.HeaderObjectToken={len:24,get:(e,t)=>({objectId:n.default.fromBin(new r.BufferType(16).get(e,t)),objectSize:Number(r.UINT64_LE.get(e,t+16))})};class s{constructor(t){this.len=Number(t.objectSize)-e.HeaderObjectToken.len}postProcessTag(e,t,r,n){if("WM/Picture"===t)e.push({id:t,value:b.fromBuffer(n)});else{const o=i.AsfUtil.getParserForAttr(r);if(!o)throw new Error("unexpected value headerType: "+r);e.push({id:t,value:o(n)})}}}e.State=s;e.IgnoreObjectState=class extends s{constructor(e){super(e)}get(e,t){return null}};class c extends s{constructor(e){super(e)}get(e,i){return{fileId:n.default.fromBin(e,i),fileSize:r.UINT64_LE.get(e,i+16),creationDate:r.UINT64_LE.get(e,i+24),dataPacketsCount:r.UINT64_LE.get(e,i+32),playDuration:r.UINT64_LE.get(e,i+40),sendDuration:r.UINT64_LE.get(e,i+48),preroll:r.UINT64_LE.get(e,i+56),flags:{broadcast:t.getBit(e,i+64,24),seekable:t.getBit(e,i+64,25)},minimumDataPacketSize:r.UINT32_LE.get(e,i+68),maximumDataPacketSize:r.UINT32_LE.get(e,i+72),maximumBitrate:r.UINT32_LE.get(e,i+76)}}}e.FilePropertiesObject=c,c.guid=n.default.FilePropertiesObject;class u extends s{constructor(e){super(e)}get(e,t){return{streamType:n.default.decodeMediaType(n.default.fromBin(e,t)),errorCorrectionType:n.default.fromBin(e,t+8)}}}e.StreamPropertiesObject=u,u.guid=n.default.StreamPropertiesObject;class l{constructor(){this.len=22}get(e,t){return{reserved1:n.default.fromBin(e,t),reserved2:e.readUInt16LE(t+16),extensionDataSize:e.readUInt32LE(t+18)}}}e.HeaderExtensionObject=l,l.guid=n.default.HeaderExtensionObject;const p={len:20,get:(e,t)=>({entryCount:e.readUInt16LE(t+16)})};async function f(e){const t=await e.readNumber(r.UINT16_LE);return(await e.readToken(new r.StringType(2*t,"utf16le"))).replace("\0","")}async function d(e){const t=await e.readNumber(r.UINT16_LE),n=Buffer.alloc(t);return await e.readBuffer(n),n}async function h(e){const t=await e.readNumber(r.UINT16_LE);return{type:{videoCodec:1==(1&t),audioCodec:2==(2&t)},codecName:await f(e),description:await f(e),information:await d(e)}}e.readCodecEntries=async function(e){const t=await e.readToken(p),r=[];for(let n=0;n<t.entryCount;++n)r.push(await h(e));return r};class m extends s{constructor(e){super(e)}get(e,t){const r=[];let n=t+10;for(let o=0;o<m.contentDescTags.length;++o){const a=e.readUInt16LE(t+2*o);if(a>0){const t=m.contentDescTags[o],s=n+a;r.push({id:t,value:i.AsfUtil.parseUnicodeAttr(e.slice(n,s))}),n=s}}return r}}e.ContentDescriptionObjectState=m,m.guid=n.default.ContentDescriptionObject,m.contentDescTags=["Title","Author","Copyright","Description","Rating"];class g extends s{constructor(e){super(e)}get(e,t){const r=[],n=e.readUInt16LE(t);let o=t+2;for(let a=0;a<n;a+=1){const t=e.readUInt16LE(o);o+=2;const n=i.AsfUtil.parseUnicodeAttr(e.slice(o,o+t));o+=t;const a=e.readUInt16LE(o);o+=2;const s=e.readUInt16LE(o);o+=2;const c=e.slice(o,o+s);o+=s,this.postProcessTag(r,n,a,c)}return r}}e.ExtendedContentDescriptionObjectState=g,g.guid=n.default.ExtendedContentDescriptionObject;class y extends s{constructor(e){super(e)}get(e,n){return{startTime:r.UINT64_LE.get(e,n),endTime:r.UINT64_LE.get(e,n+8),dataBitrate:e.readInt32LE(n+12),bufferSize:e.readInt32LE(n+16),initialBufferFullness:e.readInt32LE(n+20),alternateDataBitrate:e.readInt32LE(n+24),alternateBufferSize:e.readInt32LE(n+28),alternateInitialBufferFullness:e.readInt32LE(n+32),maximumObjectSize:e.readInt32LE(n+36),flags:{reliableFlag:t.getBit(e,n+40,0),seekableFlag:t.getBit(e,n+40,1),resendLiveCleanpointsFlag:t.getBit(e,n+40,2)},streamNumber:e.readInt16LE(n+42),streamLanguageId:e.readInt16LE(n+44),averageTimePerFrame:e.readInt32LE(n+52),streamNameCount:e.readInt32LE(n+54),payloadExtensionSystems:e.readInt32LE(n+56),streamNames:[],streamPropertiesObject:null}}}e.ExtendedStreamPropertiesObjectState=y,y.guid=n.default.ExtendedStreamPropertiesObject;class v extends s{constructor(e){super(e)}get(e,t){const r=[],n=e.readUInt16LE(t);let o=t+2;for(let a=0;a<n;a+=1){o+=4;const t=e.readUInt16LE(o);o+=2;const n=e.readUInt16LE(o);o+=2;const a=e.readUInt32LE(o);o+=4;const s=i.AsfUtil.parseUnicodeAttr(e.slice(o,o+t));o+=t;const c=e.slice(o,o+a);o+=a;if(!i.AsfUtil.getParserForAttr(n))throw new Error("unexpected value headerType: "+n);this.postProcessTag(r,s,n,c)}return r}}e.MetadataObjectState=v,v.guid=n.default.MetadataObject;class _ extends v{constructor(e){super(e)}}e.MetadataLibraryObjectState=_,_.guid=n.default.MetadataLibraryObject;class b{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(Buffer.from(e,"base64"))}static fromBuffer(e){return new b(e.length).get(e,0)}get(e,t){const r=e.readUInt8(t++),n=e.readInt32LE(t);let i=5;for(;0!==e.readUInt16BE(i);)i+=2;const a=e.slice(5,i).toString("utf16le");for(;0!==e.readUInt16BE(i);)i+=2;const s=e.slice(5,i).toString("utf16le");return{type:o.AttachedPictureType[r],format:a,description:s,size:n,data:e.slice(i+4)}}}e.WmPictureToken=b}(AsfObject$1),Object.defineProperty(AsfParser$1,"__esModule",{value:!0}),AsfParser$1.AsfParser=void 0;const type_1$1=type,GUID_1=GUID$1,AsfObject=AsfObject$1,_debug$6=browser.exports,BasicParser_1$9=BasicParser$1,debug$j=_debug$6("music-metadata:parser:ASF"),headerType="asf";class AsfParser extends BasicParser_1$9.BasicParser{async parse(){const e=await this.tokenizer.readToken(AsfObject.TopLevelHeaderObjectToken);if(!e.objectId.equals(GUID_1.default.HeaderObject))throw new Error("expected asf header; but was not found; got: "+e.objectId.str);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(t){debug$j("Error while parsing ASF: %s",t)}}async parseObjectHeader(e){let t;do{const e=await this.tokenizer.readToken(AsfObject.HeaderObjectToken);switch(debug$j("header GUID=%s",e.objectId.str),e.objectId.str){case AsfObject.FilePropertiesObject.guid.str:const r=await this.tokenizer.readToken(new AsfObject.FilePropertiesObject(e));this.metadata.setFormat("duration",Number(r.playDuration/BigInt(1e3))/1e4-Number(r.preroll)/1e3),this.metadata.setFormat("bitrate",r.maximumBitrate);break;case AsfObject.StreamPropertiesObject.guid.str:const n=await this.tokenizer.readToken(new AsfObject.StreamPropertiesObject(e));this.metadata.setFormat("container","ASF/"+n.streamType);break;case AsfObject.HeaderExtensionObject.guid.str:const i=await this.tokenizer.readToken(new AsfObject.HeaderExtensionObject);await this.parseExtensionObject(i.extensionDataSize);break;case AsfObject.ContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new AsfObject.ContentDescriptionObjectState(e)),this.addTags(t);break;case AsfObject.ExtendedContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new AsfObject.ExtendedContentDescriptionObjectState(e)),this.addTags(t);break;case GUID_1.default.CodecListObject.str:const o=await AsfObject.readCodecEntries(this.tokenizer);o.forEach((e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?type_1$1.TrackType.video:type_1$1.TrackType.audio,codecName:e.codecName})}));const a=o.filter((e=>e.type.audioCodec)).map((e=>e.codecName)).join("/");this.metadata.setFormat("codec",a);break;case GUID_1.default.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-AsfObject.HeaderObjectToken.len);break;case GUID_1.default.PaddingObject.str:debug$j("Padding: %s bytes",e.objectSize-AsfObject.HeaderObjectToken.len),await this.tokenizer.ignore(e.objectSize-AsfObject.HeaderObjectToken.len);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+e.objectId.str),debug$j("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new AsfObject.IgnoreObjectState(e))}}while(--e)}addTags(e){e.forEach((e=>{this.metadata.addTag(headerType,e.id,e.value)}))}async parseExtensionObject(e){do{const t=await this.tokenizer.readToken(AsfObject.HeaderObjectToken),r=t.objectSize-AsfObject.HeaderObjectToken.len;switch(t.objectId.str){case AsfObject.ExtendedStreamPropertiesObjectState.guid.str:await this.tokenizer.readToken(new AsfObject.ExtendedStreamPropertiesObjectState(t));break;case AsfObject.MetadataObjectState.guid.str:const e=await this.tokenizer.readToken(new AsfObject.MetadataObjectState(t));this.addTags(e);break;case AsfObject.MetadataLibraryObjectState.guid.str:const n=await this.tokenizer.readToken(new AsfObject.MetadataLibraryObjectState(t));this.addTags(n);break;case GUID_1.default.PaddingObject.str:await this.tokenizer.ignore(r);break;case GUID_1.default.CompatibilityObject.str:this.tokenizer.ignore(r);break;case GUID_1.default.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+t.objectId.str),await this.tokenizer.readToken(new AsfObject.IgnoreObjectState(t))}e-=t.objectSize}while(e>0)}}AsfParser$1.AsfParser=AsfParser;var FlacParser$1={},Vorbis={};Object.defineProperty(Vorbis,"__esModule",{value:!0}),Vorbis.IdentificationHeader=Vorbis.CommonHeader=Vorbis.VorbisPictureToken=void 0;const Token$m=lib,ID3v2Token_1$1=ID3v2Token;class VorbisPictureToken{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(Buffer.from(e,"base64"))}static fromBuffer(e){return new VorbisPictureToken(e.length).get(e,0)}get(e,t){const r=ID3v2Token_1$1.AttachedPictureType[Token$m.UINT32_BE.get(e,t)],n=Token$m.UINT32_BE.get(e,t+=4),i=e.toString("utf-8",t+=4,t+n),o=Token$m.UINT32_BE.get(e,t+=n),a=e.toString("utf-8",t+=4,t+o),s=Token$m.UINT32_BE.get(e,t+=o),c=Token$m.UINT32_BE.get(e,t+=4),u=Token$m.UINT32_BE.get(e,t+=4),l=Token$m.UINT32_BE.get(e,t+=4),p=Token$m.UINT32_BE.get(e,t+=4);return{type:r,format:i,description:a,width:s,height:c,colour_depth:u,indexed_color:l,data:Buffer.from(e.slice(t+=4,t+p))}}}Vorbis.VorbisPictureToken=VorbisPictureToken,Vorbis.CommonHeader={len:7,get:(e,t)=>({packetType:e.readUInt8(t),vorbis:new Token$m.StringType(6,"ascii").get(e,t+1)})},Vorbis.IdentificationHeader={len:23,get:(e,t)=>{const r=new DataView(e.buffer,e.byteOffset);return{version:r.getUint32(t+0,!0),channelMode:r.getUint8(t+4),sampleRate:r.getUint32(t+5,!0),bitrateMax:r.getUint32(t+9,!0),bitrateNominal:r.getUint32(t+13,!0),bitrateMin:r.getUint32(t+17,!0)}}};var AbstractID3Parser$1={};Object.defineProperty(AbstractID3Parser$1,"__esModule",{value:!0}),AbstractID3Parser$1.AbstractID3Parser=void 0;const core_1$2=core$1,ID3v2Token_1=ID3v2Token,ID3v2Parser_1$3=ID3v2Parser$1,ID3v1Parser_1$2=ID3v1Parser,_debug$5=browser.exports,BasicParser_1$8=BasicParser$1,debug$i=_debug$5("music-metadata:parser:ID3");class AbstractID3Parser extends BasicParser_1$8.BasicParser{constructor(){super(...arguments),this.id3parser=new ID3v2Parser_1$3.ID3v2Parser}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(ID3v2Token_1.ID3v2Header)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof core_1$2.EndOfStreamError))throw e;debug$i("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),debug$i("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this._parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new ID3v1Parser_1$2.ID3v1Parser;await e.init(this.metadata,this.tokenizer,this.options).parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(ID3v2Token_1.ID3v2Header)).fileIdentifier)return debug$i("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}AbstractID3Parser$1.AbstractID3Parser=AbstractID3Parser;var VorbisParser$1={},VorbisDecoder$1={};Object.defineProperty(VorbisDecoder$1,"__esModule",{value:!0}),VorbisDecoder$1.VorbisDecoder=void 0;const Token$l=lib;class VorbisDecoder{constructor(e,t){this.data=e,this.offset=t}readInt32(){const e=Token$l.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),t=Buffer.from(this.data).toString("utf-8",this.offset,this.offset+e);return this.offset+=e,t}parseUserComment(){const e=this.offset,t=this.readStringUtf8(),r=t.indexOf("=");return{key:t.slice(0,r).toUpperCase(),value:t.slice(r+1),len:this.offset-e}}}VorbisDecoder$1.VorbisDecoder=VorbisDecoder,Object.defineProperty(VorbisParser$1,"__esModule",{value:!0}),VorbisParser$1.VorbisParser=void 0;const Token$k=lib,_debug$4=browser.exports,VorbisDecoder_1$1=VorbisDecoder$1,Vorbis_1$1=Vorbis,debug$h=_debug$4("music-metadata:parser:ogg:vorbis1");class VorbisParser{constructor(e,t){this.metadata=e,this.options=t,this.pageSegments=[]}parsePage(e,t){if(e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw new Error("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const e=Buffer.concat(this.pageSegments);this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}e.headerType.lastPage&&this.calculateDuration(e)}flush(){this.parseFullPage(Buffer.concat(this.pageSegments))}parseUserComment(e,t){const r=new VorbisDecoder_1$1.VorbisDecoder(e,t).parseUserComment();return this.addTag(r.key,r.value),r.len}addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers)return void debug$h("Ignore picture");t=Vorbis_1$1.VorbisPictureToken.fromBase64(t),debug$h(`Push picture: id=${e}, format=${t.format}`)}else debug$h(`Push tag: id=${e}, value=${t}`);this.metadata.addTag("vorbis",e,t)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),debug$h("Parse first page");const r=Vorbis_1$1.CommonHeader.get(t,0);if("vorbis"!==r.vorbis)throw new Error("Metadata does not look like Vorbis");if(1!==r.packetType)throw new Error("First Ogg page should be type 1: the identification header");{const e=Vorbis_1$1.IdentificationHeader.get(t,Vorbis_1$1.CommonHeader.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),debug$h("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}}parseFullPage(e){const t=Vorbis_1$1.CommonHeader.get(e,0);switch(debug$h("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),t.packetType){case 3:return this.parseUserCommentList(e,Vorbis_1$1.CommonHeader.len)}}parseUserCommentList(e,t){const r=Token$k.UINT32_LE.get(e,t);t+=4,t+=r;let n=Token$k.UINT32_LE.get(e,t);for(t+=4;n-- >0;)t+=this.parseUserComment(e,t)}}VorbisParser$1.VorbisParser=VorbisParser,Object.defineProperty(FlacParser$1,"__esModule",{value:!0}),FlacParser$1.FlacParser=void 0;const util$5=Util,Token$j=lib,Vorbis_1=Vorbis,AbstractID3Parser_1$3=AbstractID3Parser$1,FourCC_1$7=FourCC,_debug$3=browser.exports,VorbisParser_1$3=VorbisParser$1,VorbisDecoder_1=VorbisDecoder$1,debug$g=_debug$3("music-metadata:parser:FLAC");var BlockType,BlockType2;BlockType2=BlockType||(BlockType={}),BlockType2[BlockType2.STREAMINFO=0]="STREAMINFO",BlockType2[BlockType2.PADDING=1]="PADDING",BlockType2[BlockType2.APPLICATION=2]="APPLICATION",BlockType2[BlockType2.SEEKTABLE=3]="SEEKTABLE",BlockType2[BlockType2.VORBIS_COMMENT=4]="VORBIS_COMMENT",BlockType2[BlockType2.CUESHEET=5]="CUESHEET",BlockType2[BlockType2.PICTURE=6]="PICTURE";class FlacParser extends AbstractID3Parser_1$3.AbstractID3Parser{constructor(){super(...arguments),this.padding=0}init(e,t,r){return super.init(e,t,r),this.vorbisParser=new VorbisParser_1$3.VorbisParser(e,r),this}async _parse(){if("fLaC"!==(await this.tokenizer.readToken(FourCC_1$7.FourCcToken)).toString())throw new Error("Invalid FLAC preamble");let e;do{e=await this.tokenizer.readToken(Metadata.BlockHeader),await this.parseDataBlock(e)}while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}parseDataBlock(e){switch(debug$g(`blockHeader type=${e.type}, length=${e.length}`),e.type){case BlockType.STREAMINFO:return this.parseBlockStreamInfo(e.length);case BlockType.PADDING:this.padding+=e.length;break;case BlockType.APPLICATION:case BlockType.SEEKTABLE:break;case BlockType.VORBIS_COMMENT:return this.parseComment(e.length);case BlockType.CUESHEET:break;case BlockType.PICTURE:return this.parsePicture(e.length).then();default:this.metadata.addWarning("Unknown block type: "+e.type)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==Metadata.BlockStreamInfo.len)throw new Error("Unexpected block-stream-info length");const t=await this.tokenizer.readToken(Metadata.BlockStreamInfo);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",t.channels),this.metadata.setFormat("bitsPerSample",t.bitsPerSample),this.metadata.setFormat("sampleRate",t.sampleRate),t.totalSamples>0&&this.metadata.setFormat("duration",t.totalSamples/t.sampleRate)}async parseComment(e){const t=await this.tokenizer.readToken(new Token$j.Uint8ArrayType(e)),r=new VorbisDecoder_1.VorbisDecoder(t,0);r.readStringUtf8();const n=r.readInt32();for(let i=0;i<n;i++){const e=r.parseUserComment();this.vorbisParser.addTag(e.key,e.value)}}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);{const t=await this.tokenizer.readToken(new Vorbis_1.VorbisPictureToken(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",t)}}}FlacParser$1.FlacParser=FlacParser;class Metadata{}Metadata.BlockHeader={len:4,get:(e,t)=>({lastBlock:util$5.getBit(e,t,7),type:util$5.getBitAllignedNumber(e,t,1,7),length:Token$j.UINT24_BE.get(e,t+1)})},Metadata.BlockStreamInfo={len:34,get:(e,t)=>({minimumBlockSize:Token$j.UINT16_BE.get(e,t),maximumBlockSize:Token$j.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:Token$j.UINT24_BE.get(e,t+4),maximumFrameSize:Token$j.UINT24_BE.get(e,t+7),sampleRate:Token$j.UINT24_BE.get(e,t+10)>>4,channels:util$5.getBitAllignedNumber(e,t+12,4,3)+1,bitsPerSample:util$5.getBitAllignedNumber(e,t+12,7,5)+1,totalSamples:util$5.getBitAllignedNumber(e,t+13,4,36),fileMD5:new Token$j.Uint8ArrayType(16).get(e,t+18)})};var MP4Parser$1={},Atom$1={},AtomToken$2={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ChapterText=e.StcoAtom=e.StszAtom=e.StscAtom=e.SampleToChunkToken=e.SttsAtom=e.TimeToSampleToken=e.SoundSampleDescriptionV0=e.SoundSampleDescriptionVersion=e.StsdAtom=e.TrackHeaderAtom=e.NameAtom=e.DataAtom=e.MvhdAtom=e.MdhdAtom=e.FixedLengthAtom=e.mhdr=e.tkhd=e.ftyp=e.ExtendedSize=e.Header=void 0;const t=lib,r=FourCC,n=(0,browser.exports)("music-metadata:parser:MP4:atom");e.Header={len:8,get:(e,r)=>{const n=t.UINT32_BE.get(e,r);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new t.StringType(4,"binary").get(e,r+4)}},put:(e,n,i)=>(t.UINT32_BE.put(e,n,Number(i.length)),r.FourCcToken.put(e,n+4,i.name))},e.ExtendedSize=t.UINT64_BE,e.ftyp={len:4,get:(e,r)=>({type:new t.StringType(4,"ascii").get(e,r)})},e.tkhd={len:4,get:(e,r)=>({type:new t.StringType(4,"ascii").get(e,r)})},e.mhdr={len:8,get:(e,r)=>({version:t.UINT8.get(e,r),flags:t.UINT24_BE.get(e,r+1),nextItemID:t.UINT32_BE.get(e,r+4)})};class i{constructor(e,t,r){if(this.len=e,e<t)throw new Error(`Atom ${r} expected to be ${t}, but specifies ${e} bytes long.`);e>t&&n(`Warning: atom ${r} expected to be ${t}, but was actually ${e} bytes long.`)}}e.FixedLengthAtom=i;const o=(e,r)=>{const n=t.UINT32_BE.get(e,r)-2082844800;return new Date(1e3*n)};e.MdhdAtom=class extends i{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,r){return{version:t.UINT8.get(e,r+0),flags:t.UINT24_BE.get(e,r+1),creationTime:o(e,r+4),modificationTime:o(e,r+8),timeScale:t.UINT32_BE.get(e,r+12),duration:t.UINT32_BE.get(e,r+16),language:t.UINT16_BE.get(e,r+20),quality:t.UINT16_BE.get(e,r+22)}}};e.MvhdAtom=class extends i{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,r){return{version:t.UINT8.get(e,r),flags:t.UINT24_BE.get(e,r+1),creationTime:o(e,r+4),modificationTime:o(e,r+8),timeScale:t.UINT32_BE.get(e,r+12),duration:t.UINT32_BE.get(e,r+16),preferredRate:t.UINT32_BE.get(e,r+20),preferredVolume:t.UINT16_BE.get(e,r+24),previewTime:t.UINT32_BE.get(e,r+72),previewDuration:t.UINT32_BE.get(e,r+76),posterTime:t.UINT32_BE.get(e,r+80),selectionTime:t.UINT32_BE.get(e,r+84),selectionDuration:t.UINT32_BE.get(e,r+88),currentTime:t.UINT32_BE.get(e,r+92),nextTrackID:t.UINT32_BE.get(e,r+96)}}};e.DataAtom=class{constructor(e){this.len=e}get(e,r){return{type:{set:t.UINT8.get(e,r+0),type:t.UINT24_BE.get(e,r+1)},locale:t.UINT24_BE.get(e,r+4),value:Buffer.from(new t.Uint8ArrayType(this.len-8).get(e,r+8))}}};e.NameAtom=class{constructor(e){this.len=e}get(e,r){return{version:t.UINT8.get(e,r),flags:t.UINT24_BE.get(e,r+1),name:new t.StringType(this.len-4,"utf-8").get(e,r+4)}}};e.TrackHeaderAtom=class{constructor(e){this.len=e}get(e,r){return{version:t.UINT8.get(e,r),flags:t.UINT24_BE.get(e,r+1),creationTime:o(e,r+4),modificationTime:o(e,r+8),trackId:t.UINT32_BE.get(e,r+12),duration:t.UINT32_BE.get(e,r+20),layer:t.UINT16_BE.get(e,r+24),alternateGroup:t.UINT16_BE.get(e,r+26),volume:t.UINT16_BE.get(e,r+28)}}};const a=8,s=(e,r)=>({version:t.UINT8.get(e,r),flags:t.UINT24_BE.get(e,r+1),numberOfEntries:t.UINT32_BE.get(e,r+4)});class c{constructor(e){this.len=e}get(e,n){return{dataFormat:r.FourCcToken.get(e,n),dataReferenceIndex:t.UINT16_BE.get(e,n+10),description:new t.Uint8ArrayType(this.len-12).get(e,n+12)}}}e.StsdAtom=class{constructor(e){this.len=e}get(e,r){const n=s(e,r);r+=a;const i=[];for(let o=0;o<n.numberOfEntries;++o){const n=t.UINT32_BE.get(e,r);r+=t.UINT32_BE.len,i.push(new c(n).get(e,r)),r+=n}return{header:n,table:i}}},e.SoundSampleDescriptionVersion={len:8,get:(e,r)=>({version:t.INT16_BE.get(e,r),revision:t.INT16_BE.get(e,r+2),vendor:t.INT32_BE.get(e,r+4)})},e.SoundSampleDescriptionV0={len:12,get:(e,r)=>({numAudioChannels:t.INT16_BE.get(e,r+0),sampleSize:t.INT16_BE.get(e,r+2),compressionId:t.INT16_BE.get(e,r+4),packetSize:t.INT16_BE.get(e,r+6),sampleRate:t.UINT16_BE.get(e,r+8)+t.UINT16_BE.get(e,r+10)/1e4})};class u{constructor(e,t){this.len=e,this.token=t}get(e,r){const n=t.INT32_BE.get(e,r+4);return{version:t.INT8.get(e,r+0),flags:t.INT24_BE.get(e,r+1),numberOfEntries:n,entries:l(e,this.token,r+8,this.len-8,n)}}}e.TimeToSampleToken={len:8,get:(e,r)=>({count:t.INT32_BE.get(e,r+0),duration:t.INT32_BE.get(e,r+4)})};e.SttsAtom=class extends u{constructor(t){super(t,e.TimeToSampleToken),this.len=t}},e.SampleToChunkToken={len:12,get:(e,r)=>({firstChunk:t.INT32_BE.get(e,r),samplesPerChunk:t.INT32_BE.get(e,r+4),sampleDescriptionId:t.INT32_BE.get(e,r+8)})};e.StscAtom=class extends u{constructor(t){super(t,e.SampleToChunkToken),this.len=t}};e.StszAtom=class{constructor(e){this.len=e}get(e,r){const n=t.INT32_BE.get(e,r+8);return{version:t.INT8.get(e,r),flags:t.INT24_BE.get(e,r+1),sampleSize:t.INT32_BE.get(e,r+4),numberOfEntries:n,entries:l(e,t.INT32_BE,r+12,this.len-12,n)}}};e.StcoAtom=class extends u{constructor(e){super(e,t.INT32_BE),this.len=e}};function l(e,t,r,i,o){if(n(`remainingLen=${i}, numberOfEntries=${o} * token-len=${t.len}`),0===i)return[];if(i!==o*t.len)throw new Error("mismatch number-of-entries with remaining atom-length");const a=[];for(let n=0;n<o;++n)a.push(t.get(e,r)),r+=t.len;return a}e.ChapterText=class{constructor(e){this.len=e}get(e,r){const n=t.INT16_BE.get(e,r+0);return new t.StringType(n,"utf-8").get(e,r+2)}}}(AtomToken$2),Object.defineProperty(Atom$1,"__esModule",{value:!0}),Atom$1.Atom=void 0;const initDebug$c=browser.exports,AtomToken$1=AtomToken$2,debug$f=initDebug$c("music-metadata:parser:MP4:Atom");class Atom{constructor(e,t,r){this.header=e,this.extended=t,this.parent=r,this.children=[],this.atomPath=(this.parent?this.parent.atomPath+".":"")+this.header.name}static async readAtom(e,t,r,n){const i=e.position,o=await e.readToken(AtomToken$1.Header);o.length===BigInt(1)&&(o.length=await e.readToken(AtomToken$1.ExtendedSize));const a=new Atom(o,o.length===BigInt(1),r),s=a.getPayloadLength(n);return debug$f(`parse atom name=${a.atomPath}, extended=${a.extended}, offset=${i}, len=${a.header.length}`),await a.readData(e,t,s),a}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,t,r){for(;r>0;){const n=await Atom.readAtom(e,t,this,r);this.children.push(n),r-=n.header.length===BigInt(0)?r:Number(n.header.length)}}async readData(e,t,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,t,this.getPayloadLength(r));case"meta":return await e.ignore(4),this.readAtoms(e,t,this.getPayloadLength(r)-4);case"mdhd":case"mvhd":case"tkhd":case"stsz":case"mdat":default:return t(this,r)}}}Atom$1.Atom=Atom,Object.defineProperty(MP4Parser$1,"__esModule",{value:!0}),MP4Parser$1.MP4Parser=void 0;const initDebug$b=browser.exports,Token$i=lib,BasicParser_1$7=BasicParser$1,Atom_1=Atom$1,AtomToken=AtomToken$2,ID3v1Parser_1$1=ID3v1Parser,type_1=type,debug$e=initDebug$b("music-metadata:parser:MP4"),tagFormat="iTunes",encoderDict={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function distinct(e,t,r){return r.indexOf(e)===t}class MP4Parser extends BasicParser_1$7.BasicParser{constructor(){super(...arguments),this.atomParsers={mvhd:async e=>{const t=await this.tokenizer.readToken(new AtomToken.MvhdAtom(e));this.metadata.setFormat("creationTime",t.creationTime),this.metadata.setFormat("modificationTime",t.modificationTime)},mdhd:async e=>{const t=await this.tokenizer.readToken(new AtomToken.MdhdAtom(e)),r=this.getTrackDescription();r.creationTime=t.creationTime,r.modificationTime=t.modificationTime,r.timeScale=t.timeScale,r.duration=t.duration},chap:async e=>{const t=this.getTrackDescription(),r=[];for(;e>=Token$i.UINT32_BE.len;)r.push(await this.tokenizer.readNumber(Token$i.UINT32_BE)),e-=Token$i.UINT32_BE.len;t.chapterList=r},tkhd:async e=>{const t=await this.tokenizer.readToken(new AtomToken.TrackHeaderAtom(e));this.tracks.push(t)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const t=this.tracks.filter((e=>e.chapterList));if(1===t.length){const r=t[0].chapterList,n=this.tracks.filter((e=>-1!==r.indexOf(e.trackId)));if(1===n.length)return this.parseChapterTrack(n[0],t[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const t=[];for(;e>0;){const r=await this.tokenizer.readToken(AtomToken.ftyp);e-=AtomToken.ftyp.len;const n=r.type.replace(/\W/g,"");n.length>0&&t.push(n)}debug$e(`ftyp: ${t.join("/")}`);const r=t.filter(distinct).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const t=await this.tokenizer.readToken(new AtomToken.StsdAtom(e));this.getTrackDescription().soundSampleDescription=t.table.map((e=>this.parseSoundSampleDescription(e)))},stsc:async e=>{const t=await this.tokenizer.readToken(new AtomToken.StscAtom(e));this.getTrackDescription().sampleToChunkTable=t.entries},stts:async e=>{const t=await this.tokenizer.readToken(new AtomToken.SttsAtom(e));this.getTrackDescription().timeToSampleTable=t.entries},stsz:async e=>{const t=await this.tokenizer.readToken(new AtomToken.StszAtom(e)),r=this.getTrackDescription();r.sampleSize=t.sampleSize,r.sampleSizeTable=t.entries},stco:async e=>{const t=await this.tokenizer.readToken(new AtomToken.StcoAtom(e));this.getTrackDescription().chunkOffsetTable=t.entries},date:async e=>{const t=await this.tokenizer.readToken(new Token$i.StringType(e,"utf-8"));this.addTag("date",t)}}}static read_BE_Integer(e,t){const r=(t?"INT":"UINT")+8*e.length+(e.length>1?"_BE":""),n=Token$i[r];if(!n)throw new Error('Token for integer type not found: "'+r+'"');return Number(n.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size;for(;!this.tokenizer.fileInfo.size||e>0;){try{if("\0\0\0\0"===(await this.tokenizer.peekToken(AtomToken.Header)).name){const e=`Error at offset=${this.tokenizer.position}: box.id=0`;debug$e(e),this.addWarning(e);break}}catch(n){const e=`Error at offset=${this.tokenizer.position}: ${n.message}`;debug$e(e),this.addWarning(e);break}const t=await Atom_1.Atom.readAtom(this.tokenizer,((e,t)=>this.handleAtom(e,t)),null,e);e-=t.header.length===BigInt(0)?e:Number(t.header.length)}const t=[];this.tracks.forEach((e=>{const r=[];e.soundSampleDescription.forEach((e=>{const t={},n=encoderDict[e.dataFormat];if(n?(r.push(n.format),t.codecName=n.format):t.codecName=`<${e.dataFormat}>`,e.description){const{description:r}=e;r.sampleRate>0&&(t.type=type_1.TrackType.audio,t.audio={samplingFrequency:r.sampleRate,bitDepth:r.sampleSize,channels:r.numAudioChannels})}this.metadata.addStreamInfo(t)})),r.length>=1&&t.push(r.join("/"))})),t.length>0&&this.metadata.setFormat("codec",t.filter(distinct).join("+"));const r=this.tracks.filter((e=>e.soundSampleDescription.length>=1&&e.soundSampleDescription[0].description&&e.soundSampleDescription[0].description.numAudioChannels>0));if(r.length>=1){const e=r[0],t=e.duration/e.timeScale;this.metadata.setFormat("duration",t);const n=e.soundSampleDescription[0];n.description&&(this.metadata.setFormat("sampleRate",n.description.sampleRate),this.metadata.setFormat("bitsPerSample",n.description.sampleSize),this.metadata.setFormat("numberOfChannels",n.description.numAudioChannels));const i=encoderDict[n.dataFormat];i&&this.metadata.setFormat("lossless",!i.lossy),this.calculateBitRate()}}async handleAtom(e,t){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](t);debug$e(`No parser for atom path=${e.atomPath}, payload-len=${t}, ignoring atom`),await this.tokenizer.ignore(t)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}addTag(e,t){this.metadata.addTag(tagFormat,e,t)}addWarning(e){debug$e("Warning: "+e),this.metadata.addWarning(e)}parseMetadataItemData(e){let t=e.header.name;return e.readAtoms(this.tokenizer,(async(e,r)=>{const n=e.getPayloadLength(r);switch(e.header.name){case"data":return this.parseValueAtom(t,e);case"name":const r=await this.tokenizer.readToken(new AtomToken.NameAtom(n));t+=":"+r.name;break;case"mean":const i=await this.tokenizer.readToken(new AtomToken.NameAtom(n));t+=":"+i.name;break;default:const o=await this.tokenizer.readToken(new Token$i.BufferType(n));this.addWarning("Unsupported meta-item: "+t+"["+e.header.name+"] => value="+o.toString("hex")+" ascii="+o.toString("ascii"))}}),e.getPayloadLength(0))}async parseValueAtom(e,t){const r=await this.tokenizer.readToken(new AtomToken.DataAtom(Number(t.header.length)-AtomToken.Header.len));if(0!==r.type.set)throw new Error("Unsupported type-set != 0: "+r.type.set);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":const t=Token$i.UINT8.get(r.value,3),n=Token$i.UINT8.get(r.value,5);this.addTag(e,t+"/"+n);break;case"gnre":const i=Token$i.UINT8.get(r.value,1),o=ID3v1Parser_1$1.Genres[i-1];this.addTag(e,o)}break;case 1:case 18:this.addTag(e,r.value.toString("utf-8"));break;case 13:if(this.options.skipCovers)break;this.addTag(e,{format:"image/jpeg",data:Buffer.from(r.value)});break;case 14:if(this.options.skipCovers)break;this.addTag(e,{format:"image/png",data:Buffer.from(r.value)});break;case 21:this.addTag(e,MP4Parser.read_BE_Integer(r.value,!0));break;case 22:this.addTag(e,MP4Parser.read_BE_Integer(r.value,!1));break;case 65:this.addTag(e,r.value.readInt8(0));break;case 66:this.addTag(e,r.value.readInt16BE(0));break;case 67:this.addTag(e,r.value.readInt32BE(0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const t={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const n=AtomToken.SoundSampleDescriptionVersion.get(e.description,r);return r+=AtomToken.SoundSampleDescriptionVersion.len,0===n.version||1===n.version?t.description=AtomToken.SoundSampleDescriptionV0.get(e.description,r):debug$e(`Warning: sound-sample-description ${n} not implemented`),t}async parseChapterTrack(e,t,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const n=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const o=e.chunkOffsetTable[i]-this.tokenizer.position,a=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if((r-=o+a)<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(o);const s=await this.tokenizer.readToken(new AtomToken.ChapterText(a));debug$e(`Chapter ${i+1}: ${s}`);const c={title:s,sampleOffset:this.findSampleOffset(t,this.tokenizer.position)};debug$e(`Chapter title=${c.title}, offset=${c.sampleOffset}/${this.tracks[0].duration}`),n.push(c)}this.metadata.setFormat("chapters",n),await this.tokenizer.ignore(r)}findSampleOffset(e,t){let r=0;e.timeToSampleTable.forEach((e=>{r+=e.count*e.duration})),debug$e(`Total duration=${r}`);let n=0;for(;n<e.chunkOffsetTable.length&&e.chunkOffsetTable[n]<t;)++n;return this.getChunkDuration(n+1,e)}getChunkDuration(e,t){let r=0,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration,o=1,a=this.getSamplesPerChunk(o,t.sampleToChunkTable),s=0;for(;o<e;){const e=Math.min(n,a);s+=e*i,n-=e,a-=e,0===a?(++o,a=this.getSamplesPerChunk(o,t.sampleToChunkTable)):(++r,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration)}return s}getSamplesPerChunk(e,t){for(let r=0;r<t.length-1;++r)if(e>=t[r].firstChunk&&e<t[r+1].firstChunk)return t[r].samplesPerChunk;return t[t.length-1].samplesPerChunk}}MP4Parser$1.MP4Parser=MP4Parser;var MpegParser$1={},XingTag={},ExtendedLameHeader={},ReplayGainDataFormat={};Object.defineProperty(ReplayGainDataFormat,"__esModule",{value:!0}),ReplayGainDataFormat.ReplayGain=void 0;const common$2=Util;var NameCode,NameCode2,ReplayGainOriginator,ReplayGainOriginator2;NameCode2=NameCode||(NameCode={}),NameCode2[NameCode2.not_set=0]="not_set",NameCode2[NameCode2.radio=1]="radio",NameCode2[NameCode2.audiophile=2]="audiophile",ReplayGainOriginator2=ReplayGainOriginator||(ReplayGainOriginator={}),ReplayGainOriginator2[ReplayGainOriginator2.unspecified=0]="unspecified",ReplayGainOriginator2[ReplayGainOriginator2.engineer=1]="engineer",ReplayGainOriginator2[ReplayGainOriginator2.user=2]="user",ReplayGainOriginator2[ReplayGainOriginator2.automatic=3]="automatic",ReplayGainOriginator2[ReplayGainOriginator2.rms_average=4]="rms_average",ReplayGainDataFormat.ReplayGain={len:2,get:(e,t)=>{const r=common$2.getBitAllignedNumber(e,t,0,3),n=common$2.getBitAllignedNumber(e,t,6,1),i=common$2.getBitAllignedNumber(e,t,7,9)/10;if(r>0)return{type:common$2.getBitAllignedNumber(e,t,0,3),origin:common$2.getBitAllignedNumber(e,t,3,3),adjustment:n?-i:i}}},Object.defineProperty(ExtendedLameHeader,"__esModule",{value:!0}),ExtendedLameHeader.ExtendedLameHeader=void 0;const Token$h=lib,common$1=Util,ReplayGainDataFormat_1=ReplayGainDataFormat;ExtendedLameHeader.ExtendedLameHeader={len:27,get:(e,t)=>{const r=Token$h.UINT32_BE.get(e,t+2);return{revision:common$1.getBitAllignedNumber(e,t,0,4),vbr_method:common$1.getBitAllignedNumber(e,t,4,4),lowpass_filter:100*Token$h.UINT8.get(e,t+1),track_peak:0===r?void 0:r/Math.pow(2,23),track_gain:ReplayGainDataFormat_1.ReplayGain.get(e,6),album_gain:ReplayGainDataFormat_1.ReplayGain.get(e,8),music_length:Token$h.UINT32_BE.get(e,t+20),music_crc:Token$h.UINT8.get(e,t+24),header_crc:Token$h.UINT16_BE.get(e,t+24)}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.readXingHeader=e.XingHeaderFlags=e.LameEncoderVersion=e.InfoTagHeaderTag=void 0;const t=lib,r=Util,n=ExtendedLameHeader;e.InfoTagHeaderTag=new t.StringType(4,"ascii"),e.LameEncoderVersion=new t.StringType(6,"ascii"),e.XingHeaderFlags={len:4,get:(e,t)=>({frames:r.isBitSet(e,t,31),bytes:r.isBitSet(e,t,30),toc:r.isBitSet(e,t,29),vbrScale:r.isBitSet(e,t,28)})},e.readXingHeader=async function(r){const i=await r.readToken(e.XingHeaderFlags),o={};if(i.frames&&(o.numFrames=await r.readToken(t.UINT32_BE)),i.bytes&&(o.streamSize=await r.readToken(t.UINT32_BE)),i.toc&&(o.toc=Buffer.alloc(100),await r.readBuffer(o.toc)),i.vbrScale&&(o.vbrScale=await r.readToken(t.UINT32_BE)),"LAME"===await r.peekToken(new t.StringType(4,"ascii"))){await r.ignore(4),o.lame={version:await r.readToken(new t.StringType(5,"ascii"))};if(o.lame.version.match(/\d+.\d+/g)){const e=o.lame.version.match(/\d+.\d+/g)[0].split(".").map((e=>parseInt(e,10)));e[0]>=3&&e[1]>=90&&(o.lame.extended=await r.readToken(n.ExtendedLameHeader))}}return o}}(XingTag),Object.defineProperty(MpegParser$1,"__esModule",{value:!0}),MpegParser$1.MpegParser=void 0;const Token$g=lib,core_1$1=core$1,initDebug$a=browser.exports,common=Util,AbstractID3Parser_1$2=AbstractID3Parser$1,XingTag_1=XingTag,debug$d=initDebug$a("music-metadata:parser:mpeg"),maxPeekLen=1024,MPEG4={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,void 0,void 0,-1]},MPEG4_ChannelConfigurations=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class MpegFrameHeader{constructor(e,t){this.versionIndex=common.getBitAllignedNumber(e,t+1,3,2),this.layer=MpegFrameHeader.LayerDescription[common.getBitAllignedNumber(e,t+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(e,t):this.parseMpegHeader(e,t),this.isProtectedByCRC=!common.isBitSet(e,t+1,7)}calcDuration(e){return e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return MpegFrameHeader.samplesInFrameTable[1===this.version?0:1][this.layer]}calculateSideInfoLength(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,t){this.container="MPEG",this.bitrateIndex=common.getBitAllignedNumber(e,t+2,0,4),this.sampRateFreqIndex=common.getBitAllignedNumber(e,t+2,4,2),this.padding=common.isBitSet(e,t+2,6),this.privateBit=common.isBitSet(e,t+2,7),this.channelModeIndex=common.getBitAllignedNumber(e,t+3,0,2),this.modeExtension=common.getBitAllignedNumber(e,t+3,2,2),this.isCopyrighted=common.isBitSet(e,t+3,4),this.isOriginalMedia=common.isBitSet(e,t+3,5),this.emphasis=common.getBitAllignedNumber(e,t+3,7,2),this.version=MpegFrameHeader.VersionID[this.versionIndex],this.channelMode=MpegFrameHeader.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=1e3*r,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,t){debug$d("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container="ADTS/MPEG-"+this.version;const r=common.getBitAllignedNumber(e,t+2,0,2);this.codec="AAC",this.codecProfile=MPEG4.AudioObjectTypes[r],debug$d(`MPEG-4 audio-codec=${this.codec}`);const n=common.getBitAllignedNumber(e,t+2,2,4);this.samplingRate=MPEG4.SamplingFrequencies[n],debug$d(`sampling-rate=${this.samplingRate}`);const i=common.getBitAllignedNumber(e,t+2,7,3);this.mp4ChannelConfig=MPEG4_ChannelConfigurations[i],debug$d(`channel-config=${this.mp4ChannelConfig.join("+")}`),this.frameLength=common.getBitAllignedNumber(e,t+3,6,2)<<11}calcBitrate(){if(0===this.bitrateIndex||15===this.bitrateIndex)return;const e=`${Math.floor(this.version)}${this.layer}`;return MpegFrameHeader.bitrate_index[this.bitrateIndex][e]}calcSamplingRate(){return 3===this.sampRateFreqIndex?null:MpegFrameHeader.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}MpegFrameHeader.SyncByte1=255,MpegFrameHeader.SyncByte2=224,MpegFrameHeader.VersionID=[2.5,null,2,1],MpegFrameHeader.LayerDescription=[0,3,2,1],MpegFrameHeader.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],MpegFrameHeader.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},MpegFrameHeader.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},MpegFrameHeader.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const FrameHeader={len:4,get:(e,t)=>new MpegFrameHeader(e,t)};function getVbrCodecProfile(e){return"V"+Math.floor((100-e)/10)}class MpegParser extends AbstractID3Parser_1$2.AbstractID3Parser{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.calculateEofDuration=!1,this.buf_frame_header=Buffer.alloc(4),this.syncPeek={buf:Buffer.alloc(maxPeekLen),len:0}}async _parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(!(e instanceof core_1$1.EndOfStreamError))throw e;if(debug$d("End-of-stream"),this.calculateEofDuration){const e=this.frameCount*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",e);const t=e/this.metadata.format.sampleRate;debug$d(`Calculate duration at EOF: ${t} sec.`,t),this.metadata.setFormat("duration",t)}}}finalize(){const e=this.metadata.format,t=this.metadata.native.hasOwnProperty("ID3v1");if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*r/e.duration)}else if(this.tokenizer.fileInfo.size&&"CBR"===e.codecProfile){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0),n=Math.round(r/this.frame_size)*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",n);const i=n/e.sampleRate;debug$d("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}async sync(){let e=!1;for(;;){let t=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:maxPeekLen,mayBeLess:!0}),this.syncPeek.len<=163)throw new core_1$1.EndOfStreamError;for(;;){if(e&&224==(224&this.syncPeek.buf[t]))return this.buf_frame_header[0]=MpegFrameHeader.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[t],await this.tokenizer.ignore(t),debug$d(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(debug$d(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),void(this.syncFrameCount=this.frameCount);if(e=!1,t=this.syncPeek.buf.indexOf(MpegFrameHeader.SyncByte1,t),-1===t){if(this.syncPeek.len<this.syncPeek.buf.length)throw new core_1$1.EndOfStreamError;await this.tokenizer.ignore(this.syncPeek.len);break}++t,e=!0}}}async parseCommonMpegHeader(){let e;0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});try{e=FrameHeader.get(this.buf_frame_header,0)}catch(t){return await this.tokenizer.ignore(1),this.metadata.addWarning("Parse error: "+t.message),!1}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version>=2&&0===e.layer?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels","mono"===e.channelMode?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<2e5&&debug$d("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const t=e.calcSlotSize();if(null===t)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();debug$d(`samples_per_frame=${r}`);const n=r/8*e.bitrate/e.samplingRate+(e.padding?t:0);if(this.frame_size=Math.floor(n),this.audioFrameHeader=e,this.bitrates.push(e.bitrate),1===this.frameCount)return this.offset=FrameHeader.len,await this.skipSideInformation(),!1;if(3===this.frameCount){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const t=Buffer.alloc(3);await this.tokenizer.readBuffer(t),e.frameLength+=common.getBitAllignedNumber(t,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024;const r=e.samplingRate/this.samplesPerFrame,n=8*(0===this.frameCount?0:this.totalDataLength/this.frameCount)*r+.5;if(this.metadata.setFormat("bitrate",n),debug$d(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${n}`),await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),3===this.frameCount){if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),!this.options.duration)return!0;this.calculateEofDuration=!0}return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Token$g.INT16_BE),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){const e=this.audioFrameHeader.calculateSideInfoLength();await this.tokenizer.readToken(new Token$g.Uint8ArrayType(e)),this.offset+=e,await this.readXtraInfoHeader()}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(XingTag_1.InfoTagHeaderTag);switch(this.offset+=XingTag_1.InfoTagHeaderTag.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":const e=getVbrCodecProfile((await this.readXingInfoHeader()).vbrScale);return this.metadata.setFormat("codecProfile",e),null;case"Xtra":break;case"LAME":const t=await this.tokenizer.readToken(XingTag_1.LameEncoderVersion);if(this.frame_size>=this.offset+XingTag_1.LameEncoderVersion.len)return this.offset+=XingTag_1.LameEncoderVersion.len,this.metadata.setFormat("tool","LAME "+t),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header")}const t=this.frame_size-this.offset;return t<0?this.metadata.addWarning("Frame "+this.frameCount+"corrupt: negative frameDataLeft"):await this.skipFrameData(t),null}async readXingInfoHeader(){const e=this.tokenizer.position,t=await XingTag_1.readXingHeader(this.tokenizer);if(this.offset+=this.tokenizer.position-e,t.lame&&(this.metadata.setFormat("tool","LAME "+common.stripNulls(t.lame.version)),t.lame.extended&&(this.metadata.setFormat("trackPeakLevel",t.lame.extended.track_peak),t.lame.extended.track_gain&&this.metadata.setFormat("trackGain",t.lame.extended.track_gain.adjustment),t.lame.extended.album_gain&&this.metadata.setFormat("albumGain",t.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",t.lame.extended.music_length/1e3))),t.streamSize){const e=this.audioFrameHeader.calcDuration(t.numFrames);return this.metadata.setFormat("duration",e),debug$d("Get duration from Xing header: %s",this.metadata.format.duration),t}const r=this.frame_size-this.offset;return await this.skipFrameData(r),t}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const t=e[0];return e.every((e=>e===t))}}MpegParser$1.MpegParser=MpegParser;var musepack={},MpcSv8Parser$1={},StreamVersion8={};Object.defineProperty(StreamVersion8,"__esModule",{value:!0}),StreamVersion8.StreamReader=void 0;const Token$f=lib,util$4=Util,initDebug$9=browser.exports,debug$c=initDebug$9("music-metadata:parser:musepack:sv8"),PacketKey=new Token$f.StringType(2,"binary"),SH_part1={len:5,get:(e,t)=>({crc:Token$f.UINT32_LE.get(e,t),streamVersion:Token$f.UINT8.get(e,t+4)})},SH_part3={len:2,get:(e,t)=>({sampleFrequency:[44100,48e3,37800,32e3][util$4.getBitAllignedNumber(e,t,0,3)],maxUsedBands:util$4.getBitAllignedNumber(e,t,3,5),channelCount:util$4.getBitAllignedNumber(e,t+1,0,4)+1,msUsed:util$4.isBitSet(e,t+1,4),audioBlockFrames:util$4.getBitAllignedNumber(e,t+1,5,3)})};class StreamReader{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(PacketKey),t=await this.readVariableSizeField();return{key:e,payloadLength:t.value-2-t.len}}async readStreamHeader(e){const t={};debug$c(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(SH_part1);e-=SH_part1.len,Object.assign(t,r),debug$c(`SH.streamVersion = ${r.streamVersion}`);const n=await this.readVariableSizeField();e-=n.len,t.sampleCount=n.value;const i=await this.readVariableSizeField();e-=i.len,t.beginningOfSilence=i.value;const o=await this.tokenizer.readToken(SH_part3);return e-=SH_part3.len,Object.assign(t,o),await this.tokenizer.ignore(e),t}async readVariableSizeField(e=1,t=0){let r=await this.tokenizer.readNumber(Token$f.UINT8);return 0==(128&r)?{len:e,value:t+r}:(r&=127,r+=t,this.readVariableSizeField(e+1,r<<7))}}StreamVersion8.StreamReader=StreamReader,Object.defineProperty(MpcSv8Parser$1,"__esModule",{value:!0}),MpcSv8Parser$1.MpcSv8Parser=void 0;const initDebug$8=browser.exports,BasicParser_1$6=BasicParser$1,SV8=StreamVersion8,APEv2Parser_1$4=APEv2Parser$1,FourCC_1$6=FourCC,debug$b=initDebug$8("music-metadata:parser:musepack");class MpcSv8Parser extends BasicParser_1$6.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){if("MPCK"!==await this.tokenizer.readToken(FourCC_1$6.FourCcToken))throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new SV8.StreamReader(this.tokenizer);for(;;){const t=await e.readPacketHeader();switch(debug$b(`packet-header key=${t.key}, payloadLength=${t.payloadLength}`),t.key){case"SH":const r=await e.readStreamHeader(t.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break;case"AP":this.audioLength+=t.payloadLength,await this.tokenizer.ignore(t.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(t.payloadLength);break;case"SE":return this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),APEv2Parser_1$4.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${t.key}`)}}}}MpcSv8Parser$1.MpcSv8Parser=MpcSv8Parser;var MpcSv7Parser$1={},StreamVersion7={};Object.defineProperty(StreamVersion7,"__esModule",{value:!0}),StreamVersion7.Header=void 0;const Token$e=lib,util$3=Util;StreamVersion7.Header={len:24,get:(e,t)=>{const r={signature:Buffer.from(e).toString("latin1",t,t+3),streamMinorVersion:util$3.getBitAllignedNumber(e,t+3,0,4),streamMajorVersion:util$3.getBitAllignedNumber(e,t+3,4,4),frameCount:Token$e.UINT32_LE.get(e,t+4),maxLevel:Token$e.UINT16_LE.get(e,t+8),sampleFrequency:[44100,48e3,37800,32e3][util$3.getBitAllignedNumber(e,t+10,0,2)],link:util$3.getBitAllignedNumber(e,t+10,2,2),profile:util$3.getBitAllignedNumber(e,t+10,4,4),maxBand:util$3.getBitAllignedNumber(e,t+11,0,6),intensityStereo:util$3.isBitSet(e,t+11,6),midSideStereo:util$3.isBitSet(e,t+11,7),titlePeak:Token$e.UINT16_LE.get(e,t+12),titleGain:Token$e.UINT16_LE.get(e,t+14),albumPeak:Token$e.UINT16_LE.get(e,t+16),albumGain:Token$e.UINT16_LE.get(e,t+18),lastFrameLength:Token$e.UINT32_LE.get(e,t+20)>>>20&2047,trueGapless:util$3.isBitSet(e,t+23,0)};return r.lastFrameLength=r.trueGapless?Token$e.UINT32_LE.get(e,20)>>>20&2047:0,r}};var BitReader$1={};Object.defineProperty(BitReader$1,"__esModule",{value:!0}),BitReader$1.BitReader=void 0;const Token$d=lib;class BitReader{constructor(e){this.tokenizer=e,this.pos=0,this.dword=void 0}async read(e){for(;void 0===this.dword;)this.dword=await this.tokenizer.readToken(Token$d.UINT32_LE);let t=this.dword;return this.pos+=e,this.pos<32?(t>>>=32-this.pos,t&(1<<e)-1):(this.pos-=32,0===this.pos?(this.dword=void 0,t&(1<<e)-1):(this.dword=await this.tokenizer.readToken(Token$d.UINT32_LE),this.pos&&(t<<=this.pos,t|=this.dword>>>32-this.pos),t&(1<<e)-1))}async ignore(e){if(this.pos>0){const t=32-this.pos;this.dword=void 0,e-=t,this.pos=0}const t=e%32,r=(e-t)/32;return await this.tokenizer.ignore(4*r),this.read(t)}}BitReader$1.BitReader=BitReader,Object.defineProperty(MpcSv7Parser$1,"__esModule",{value:!0}),MpcSv7Parser$1.MpcSv7Parser=void 0;const initDebug$7=browser.exports,BasicParser_1$5=BasicParser$1,SV7=StreamVersion7,APEv2Parser_1$3=APEv2Parser$1,BitReader_1=BitReader$1,debug$a=initDebug$7("music-metadata:parser:musepack");class MpcSv7Parser extends BasicParser_1$5.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){const e=await this.tokenizer.readToken(SV7.Header);if("MP+"!==e.signature)throw new Error("Unexpected magic number");debug$a(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const t=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",t),this.duration=t/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new BitReader_1.BitReader(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),debug$a(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),APEv2Parser_1$3.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const e=await this.bitreader.read(20);this.audioLength+=20+e,await this.bitreader.ignore(e)}const t=await this.bitreader.read(11);this.audioLength+=t,this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}MpcSv7Parser$1.MpcSv7Parser=MpcSv7Parser,Object.defineProperty(musepack,"__esModule",{value:!0});const initDebug$6=browser.exports,Token$c=lib,MpcSv8Parser_1=MpcSv8Parser$1,MpcSv7Parser_1=MpcSv7Parser$1,AbstractID3Parser_1$1=AbstractID3Parser$1,debug$9=initDebug$6("music-metadata:parser:musepack");class MusepackParser extends AbstractID3Parser_1$1.AbstractID3Parser{async _parse(){let e;switch(await this.tokenizer.peekToken(new Token$c.StringType(3,"binary"))){case"MP+":debug$9("Musepack stream-version 7"),e=new MpcSv7Parser_1.MpcSv7Parser;break;case"MPC":debug$9("Musepack stream-version 8"),e=new MpcSv8Parser_1.MpcSv8Parser;break;default:throw new Error("Invalid Musepack signature prefix")}return e.init(this.metadata,this.tokenizer,this.options),e.parse()}}musepack.default=MusepackParser;var OggParser$1={},OpusParser$1={},Opus$1={};Object.defineProperty(Opus$1,"__esModule",{value:!0}),Opus$1.IdHeader=void 0;const Token$b=lib;class IdHeader{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,t){return{magicSignature:new Token$b.StringType(8,"ascii").get(e,t+0),version:e.readUInt8(t+8),channelCount:e.readUInt8(t+9),preSkip:e.readInt16LE(t+10),inputSampleRate:e.readInt32LE(t+12),outputGain:e.readInt16LE(t+16),channelMapping:e.readUInt8(t+18)}}}Opus$1.IdHeader=IdHeader,Object.defineProperty(OpusParser$1,"__esModule",{value:!0}),OpusParser$1.OpusParser=void 0;const Token$a=lib,Opus=Opus$1,VorbisParser_1$2=VorbisParser$1;class OpusParser extends VorbisParser_1$2.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r,this.lastPos=-1}parseFirstPage(e,t){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new Opus.IdHeader(t.length).get(t,0),"OpusHead"!==this.idHeader.magicSignature)throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}parseFullPage(e){switch(new Token$a.StringType(8,"ascii").get(e,0)){case"OpusTags":this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const t=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",t),this.metadata.setFormat("duration",t/48e3),-1!==this.lastPos&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}}OpusParser$1.OpusParser=OpusParser;var SpeexParser$1={},Speex$1={};Object.defineProperty(Speex$1,"__esModule",{value:!0}),Speex$1.Header=void 0;const Token$9=lib,util$2=Util;Speex$1.Header={len:80,get:(e,t)=>({speex:new Token$9.StringType(8,"ascii").get(e,t+0),version:util$2.trimRightNull(new Token$9.StringType(20,"ascii").get(e,t+8)),version_id:e.readInt32LE(t+28),header_size:e.readInt32LE(t+32),rate:e.readInt32LE(t+36),mode:e.readInt32LE(t+40),mode_bitstream_version:e.readInt32LE(t+44),nb_channels:e.readInt32LE(t+48),bitrate:e.readInt32LE(t+52),frame_size:e.readInt32LE(t+56),vbr:e.readInt32LE(t+60),frames_per_packet:e.readInt32LE(t+64),extra_headers:e.readInt32LE(t+68),reserved1:e.readInt32LE(t+72),reserved2:e.readInt32LE(t+76)})},Object.defineProperty(SpeexParser$1,"__esModule",{value:!0}),SpeexParser$1.SpeexParser=void 0;const initDebug$5=browser.exports,Speex=Speex$1,VorbisParser_1$1=VorbisParser$1,debug$8=initDebug$5("music-metadata:parser:ogg:speex");class SpeexParser extends VorbisParser_1$1.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r}parseFirstPage(e,t){debug$8("First Ogg/Speex page");const r=Speex.Header.get(t,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),-1!==r.bitrate&&this.metadata.setFormat("bitrate",r.bitrate)}}SpeexParser$1.SpeexParser=SpeexParser;var TheoraParser$1={},Theora={};Object.defineProperty(Theora,"__esModule",{value:!0}),Theora.IdentificationHeader=void 0;const Token$8=lib;Theora.IdentificationHeader={len:42,get:(e,t)=>({id:new Token$8.StringType(7,"ascii").get(e,t),vmaj:e.readUInt8(t+7),vmin:e.readUInt8(t+8),vrev:e.readUInt8(t+9),vmbw:e.readUInt16BE(t+10),vmbh:e.readUInt16BE(t+17),nombr:Token$8.UINT24_BE.get(e,t+37),nqual:e.readUInt8(t+40)})},Object.defineProperty(TheoraParser$1,"__esModule",{value:!0}),TheoraParser$1.TheoraParser=void 0;const initDebug$4=browser.exports,Theora_1=Theora,debug$7=initDebug$4("music-metadata:parser:ogg:theora");class TheoraParser{constructor(e,t,r){this.metadata=e,this.tokenizer=r}parsePage(e,t){e.headerType.firstPage&&this.parseFirstPage(e,t)}flush(){debug$7("flush")}calculateDuration(e){debug$7("duration calculation not implemented")}parseFirstPage(e,t){debug$7("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=Theora_1.IdentificationHeader.get(t,0);this.metadata.setFormat("bitrate",r.nombr)}}TheoraParser$1.TheoraParser=TheoraParser,Object.defineProperty(OggParser$1,"__esModule",{value:!0}),OggParser$1.OggParser=OggParser$1.SegmentTable=void 0;const Token$7=lib,initDebug$3=browser.exports,util$1=Util,FourCC_1$5=FourCC,VorbisParser_1=VorbisParser$1,OpusParser_1=OpusParser$1,SpeexParser_1=SpeexParser$1,BasicParser_1$4=BasicParser$1,TheoraParser_1=TheoraParser$1,core_1=core$1,debug$6=initDebug$3("music-metadata:parser:ogg");class SegmentTable{constructor(e){this.len=e.page_segments}static sum(e,t,r){let n=0;for(let i=t;i<t+r;++i)n+=e[i];return n}get(e,t){return{totalPageSize:SegmentTable.sum(e,t,this.len)}}}OggParser$1.SegmentTable=SegmentTable;class OggParser extends BasicParser_1$4.BasicParser{async parse(){debug$6("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(OggParser.Header),"OggS"!==e.capturePattern)throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,debug$6("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const t=await this.tokenizer.readToken(new SegmentTable(e));debug$6("totalPageSize=%s",t.totalPageSize);const r=await this.tokenizer.readToken(new Token$7.Uint8ArrayType(t.totalPageSize));if(debug$6("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const e=new Token$7.StringType(7,"ascii").get(Buffer.from(r),0);switch(e){case"vorbis":debug$6("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new VorbisParser_1.VorbisParser(this.metadata,this.options);break;case"OpusHea":debug$6("Set page consumer to Ogg/Opus"),this.pageConsumer=new OpusParser_1.OpusParser(this.metadata,this.options,this.tokenizer);break;case"Speex  ":debug$6("Set page consumer to Ogg/Speex"),this.pageConsumer=new SpeexParser_1.SpeexParser(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":debug$6("Set page consumer to Ogg/Theora"),this.pageConsumer=new TheoraParser_1.TheoraParser(this.metadata,this.options,this.tokenizer);break;default:throw new Error("gg audio-codec not recognized (id="+e+")")}}this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof core_1.EndOfStreamError)this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),debug$6("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header);else{if(!e.message.startsWith("FourCC"))throw e;this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),this.pageConsumer.flush())}}}}OggParser$1.OggParser=OggParser,OggParser.Header={len:27,get:(e,t)=>({capturePattern:FourCC_1$5.FourCcToken.get(e,t),version:Token$7.UINT8.get(e,t+4),headerType:{continued:util$1.getBit(e,t+5,0),firstPage:util$1.getBit(e,t+5,1),lastPage:util$1.getBit(e,t+5,2)},absoluteGranulePosition:Number(Token$7.UINT64_LE.get(e,t+6)),streamSerialNumber:Token$7.UINT32_LE.get(e,t+14),pageSequenceNo:Token$7.UINT32_LE.get(e,t+18),pageChecksum:Token$7.UINT32_LE.get(e,t+22),page_segments:Token$7.UINT8.get(e,t+26)})};var WaveParser$1={},RiffChunk={};Object.defineProperty(RiffChunk,"__esModule",{value:!0}),RiffChunk.ListInfoTagValue=RiffChunk.Header=void 0;const Token$6=lib;RiffChunk.Header={len:8,get:(e,t)=>({chunkID:e.toString("binary",t,t+4),chunkSize:Token$6.UINT32_LE.get(e,4)})};class ListInfoTagValue{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=1&this.len}get(e,t){return new Token$6.StringType(this.tagHeader.chunkSize,"ascii").get(e,t)}}RiffChunk.ListInfoTagValue=ListInfoTagValue;var WaveChunk$1={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.FactChunk=e.Format=e.WaveFormat=void 0,(t=e.WaveFormat||(e.WaveFormat={}))[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG";e.Format=class{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,t){return{wFormatTag:e.readUInt16LE(t),nChannels:e.readUInt16LE(t+2),nSamplesPerSec:e.readUInt32LE(t+4),nAvgBytesPerSec:e.readUInt32LE(t+8),nBlockAlign:e.readUInt16LE(t+12),wBitsPerSample:e.readUInt16LE(t+14)}}};e.FactChunk=class{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,t){return{dwSampleLength:e.readUInt32LE(t)}}}}(WaveChunk$1),Object.defineProperty(WaveParser$1,"__esModule",{value:!0}),WaveParser$1.WaveParser=void 0;const strtok3$2=core$1,Token$5=lib,initDebug$2=browser.exports,riff=RiffChunk,WaveChunk=WaveChunk$1,ID3v2Parser_1$2=ID3v2Parser$1,util=Util,FourCC_1$4=FourCC,BasicParser_1$3=BasicParser$1,debug$5=initDebug$2("music-metadata:parser:RIFF");class WaveParser extends BasicParser_1$3.BasicParser{async parse(){const e=await this.tokenizer.readToken(riff.Header);if(debug$5(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),"RIFF"===e.chunkID)return this.parseRiffChunk(e.chunkSize).catch((e=>{if(!(e instanceof strtok3$2.EndOfStreamError))throw e}))}async parseRiffChunk(e){const t=await this.tokenizer.readToken(FourCC_1$4.FourCcToken);switch(this.metadata.setFormat("container",t),t){case"WAVE":return this.readWaveChunk(e-FourCC_1$4.FourCcToken.len);default:throw new Error(`Unsupported RIFF format: RIFF/${t}`)}}async readWaveChunk(e){for(;e>=riff.Header.len;){const t=await this.tokenizer.readToken(riff.Header);switch(e-=riff.Header.len+t.chunkSize,t.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=t,debug$5(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${t.chunkID}`),t.chunkID){case"LIST":await this.parseListTag(t);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new WaveChunk.FactChunk(t));break;case"fmt ":const e=await this.tokenizer.readToken(new WaveChunk.Format(t));let r=WaveChunk.WaveFormat[e.wFormatTag];r||(debug$5("WAVE/non-PCM format="+e.wFormatTag),r="non-PCM ("+e.wFormatTag+")"),this.metadata.setFormat("codec",r),this.metadata.setFormat("bitsPerSample",e.wBitsPerSample),this.metadata.setFormat("sampleRate",e.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",e.nChannels),this.metadata.setFormat("bitrate",e.nBlockAlign*e.nSamplesPerSec*8),this.blockAlign=e.nBlockAlign;break;case"id3 ":case"ID3 ":const n=await this.tokenizer.readToken(new Token$5.Uint8ArrayType(t.chunkSize)),i=strtok3$2.fromBuffer(n);await(new ID3v2Parser_1$2.ID3v2Parser).parse(this.metadata,i,this.options);break;case"data":!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0);let o=t.chunkSize;if(this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;e<o&&(this.metadata.addWarning("data chunk length exceeding file length"),o=e)}const a=this.fact?this.fact.dwSampleLength:4294967295===o?void 0:o/this.blockAlign;a&&(this.metadata.setFormat("numberOfSamples",a),this.metadata.setFormat("duration",a/this.metadata.format.sampleRate)),this.metadata.setFormat("bitrate",this.metadata.format.numberOfChannels*this.blockAlign*this.metadata.format.sampleRate),await this.tokenizer.ignore(t.chunkSize);break;default:debug$5(`Ignore chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize)}this.header.chunkSize%2==1&&(debug$5("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const t=await this.tokenizer.readToken(new Token$5.StringType(4,"binary"));switch(debug$5("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,t),t){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);case"adtl":default:return this.metadata.addWarning("Ignore chunk: RIFF/WAVE/LIST/"+t),debug$5("Ignoring chunkID=RIFF/WAVE/LIST/"+t),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const t=await this.tokenizer.readToken(riff.Header),r=new riff.ListInfoTagValue(t),n=await this.tokenizer.readToken(r);this.addTag(t.chunkID,util.stripNulls(n)),e-=8+r.len}if(0!==e)throw Error("Illegal remaining size: "+e)}addTag(e,t){this.metadata.addTag("exif",e,t)}}WaveParser$1.WaveParser=WaveParser;var WavPackParser$1={},WavPackToken={};Object.defineProperty(WavPackToken,"__esModule",{value:!0}),WavPackToken.WavPack=void 0;const Token$4=lib,FourCC_1$3=FourCC,SampleRates=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1];class WavPack{static isBitSet(e,t){return 1===WavPack.getBitAllignedNumber(e,t,1)}static getBitAllignedNumber(e,t,r){return e>>>t&4294967295>>>32-r}}WavPackToken.WavPack=WavPack,WavPack.BlockHeaderToken={len:32,get:(e,t)=>{const r=Token$4.UINT32_LE.get(e,t+24),n={BlockID:FourCC_1$3.FourCcToken.get(e,t),blockSize:Token$4.UINT32_LE.get(e,t+4),version:Token$4.UINT16_LE.get(e,t+8),totalSamples:Token$4.UINT32_LE.get(e,t+12),blockIndex:Token$4.UINT32_LE.get(e,t+16),blockSamples:Token$4.UINT32_LE.get(e,t+20),flags:{bitsPerSample:8*(1+WavPack.getBitAllignedNumber(r,0,2)),isMono:WavPack.isBitSet(r,2),isHybrid:WavPack.isBitSet(r,3),isJointStereo:WavPack.isBitSet(r,4),crossChannel:WavPack.isBitSet(r,5),hybridNoiseShaping:WavPack.isBitSet(r,6),floatingPoint:WavPack.isBitSet(r,7),samplingRate:SampleRates[WavPack.getBitAllignedNumber(r,23,4)],isDSD:WavPack.isBitSet(r,31)},crc:new Token$4.Uint8ArrayType(4).get(e,t+28)};return n.flags.isDSD&&(n.totalSamples*=8),n}},WavPack.MetadataIdToken={len:1,get:(e,t)=>({functionId:WavPack.getBitAllignedNumber(e[t],0,6),isOptional:WavPack.isBitSet(e[t],5),isOddSize:WavPack.isBitSet(e[t],6),largeBlock:WavPack.isBitSet(e[t],7)})},Object.defineProperty(WavPackParser$1,"__esModule",{value:!0}),WavPackParser$1.WavPackParser=void 0;const Token$3=lib,APEv2Parser_1$2=APEv2Parser$1,FourCC_1$2=FourCC,BasicParser_1$2=BasicParser$1,WavPackToken_1=WavPackToken,initDebug$1=browser.exports,debug$4=initDebug$1("music-metadata:parser:WavPack");class WavPackParser extends BasicParser_1$2.BasicParser{async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),APEv2Parser_1$2.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if("wvpk"!==await this.tokenizer.peekToken(FourCC_1$2.FourCcToken))break;const e=await this.tokenizer.readToken(WavPackToken_1.WavPack.BlockHeaderToken);if("wvpk"!==e.BlockID)throw new Error("Invalid WavPack Block-ID");debug$4(`WavPack header blockIndex=${e.blockIndex}, len=${WavPackToken_1.WavPack.BlockHeaderToken.len}`),0!==e.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!e.flags.isHybrid),this.metadata.setFormat("bitsPerSample",e.flags.bitsPerSample),e.flags.isDSD||(this.metadata.setFormat("sampleRate",e.flags.samplingRate),this.metadata.setFormat("duration",e.totalSamples/e.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",e.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",e.totalSamples),this.metadata.setFormat("codec",e.flags.isDSD?"DSD":"PCM"));const t=e.blockSize-(WavPackToken_1.WavPack.BlockHeaderToken.len-8);0===e.blockIndex?await this.parseMetadataSubBlock(e,t):await this.tokenizer.ignore(t),e.blockSamples>0&&(this.audioDataSize+=e.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=WavPackToken_1.WavPack.BlockHeaderToken.len);this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration)}async parseMetadataSubBlock(e,t){for(;t>WavPackToken_1.WavPack.MetadataIdToken.len;){const r=await this.tokenizer.readToken(WavPackToken_1.WavPack.MetadataIdToken),n=await this.tokenizer.readNumber(r.largeBlock?Token$3.UINT24_LE:Token$3.UINT8),i=Buffer.alloc(2*n-(r.isOddSize?1:0));switch(await this.tokenizer.readBuffer(i),debug$4(`Metadata Sub-Blocks functionId=0x${r.functionId.toString(16)}, id.largeBlock=${r.largeBlock},data-size=${i.length}`),r.functionId){case 0:break;case 14:debug$4("ID_DSD_BLOCK");const t=1<<i.readUInt8(0),n=e.flags.samplingRate*t*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",n),this.metadata.setFormat("duration",e.totalSamples/n);break;case 36:debug$4("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",i);break;case 47:debug$4(`ID_BLOCK_CHECKSUM: checksum=${i.toString("hex")}`);break;default:debug$4(`Ignore unsupported meta-sub-block-id functionId=0x${r.functionId.toString(16)}`)}t-=WavPackToken_1.WavPack.MetadataIdToken.len+(r.largeBlock?Token$3.UINT24_LE.len:Token$3.UINT8.len)+2*n,debug$4(`remainingLength=${t}`),r.isOddSize&&this.tokenizer.ignore(1)}if(0!==t)throw new Error("metadata-sub-block should fit it remaining length")}}WavPackParser$1.WavPackParser=WavPackParser;var DsfParser$1={},DsfChunk={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FormatChunk=e.ChannelType=e.DsdChunk=e.ChunkHeader=void 0;const t=lib,r=FourCC;var n;e.ChunkHeader={len:12,get:(e,n)=>({id:r.FourCcToken.get(e,n),size:t.UINT64_LE.get(e,n+4)})},e.DsdChunk={len:16,get:(e,r)=>({fileSize:t.INT64_LE.get(e,r),metadataPointer:t.INT64_LE.get(e,r+8)})},(n=e.ChannelType||(e.ChannelType={}))[n.mono=1]="mono",n[n.stereo=2]="stereo",n[n.channels=3]="channels",n[n.quad=4]="quad",n[n["4 channels"]=5]="4 channels",n[n["5 channels"]=6]="5 channels",n[n["5.1 channels"]=7]="5.1 channels",e.FormatChunk={len:40,get:(e,r)=>({formatVersion:t.INT32_LE.get(e,r),formatID:t.INT32_LE.get(e,r+4),channelType:t.INT32_LE.get(e,r+8),channelNum:t.INT32_LE.get(e,r+12),samplingFrequency:t.INT32_LE.get(e,r+16),bitsPerSample:t.INT32_LE.get(e,r+20),sampleCount:t.INT64_LE.get(e,r+24),blockSizePerChannel:t.INT32_LE.get(e,r+32)})}}(DsfChunk),Object.defineProperty(DsfParser$1,"__esModule",{value:!0}),DsfParser$1.DsfParser=void 0;const AbstractID3Parser_1=AbstractID3Parser$1,_debug$2=browser.exports,DsfChunk_1=DsfChunk,ID3v2Parser_1$1=ID3v2Parser$1,debug$3=_debug$2("music-metadata:parser:DSF");class DsfParser extends AbstractID3Parser_1.AbstractID3Parser{async _parse(){const e=this.tokenizer.position,t=await this.tokenizer.readToken(DsfChunk_1.ChunkHeader);if("DSD "!==t.id)throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(DsfChunk_1.DsdChunk);if(r.metadataPointer!==BigInt(0))return debug$3(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-t.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),(new ID3v2Parser_1$1.ID3v2Parser).parse(this.metadata,this.tokenizer,this.options);debug$3("No ID3v2 tag present")}async parseChunks(e){for(;e>=DsfChunk_1.ChunkHeader.len;){const t=await this.tokenizer.readToken(DsfChunk_1.ChunkHeader);switch(debug$3(`Parsing chunk name=${t.id} size=${t.size}`),t.id){case"fmt ":const e=await this.tokenizer.readToken(DsfChunk_1.FormatChunk);this.metadata.setFormat("numberOfChannels",e.channelNum),this.metadata.setFormat("sampleRate",e.samplingFrequency),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("numberOfSamples",e.sampleCount),this.metadata.setFormat("duration",Number(e.sampleCount)/e.samplingFrequency);const r=e.bitsPerSample*e.samplingFrequency*e.channelNum;return void this.metadata.setFormat("bitrate",r);default:this.tokenizer.ignore(Number(t.size)-DsfChunk_1.ChunkHeader.len)}e-=t.size}}}DsfParser$1.DsfParser=DsfParser;var DsdiffParser$1={},DsdiffToken={};Object.defineProperty(DsdiffToken,"__esModule",{value:!0}),DsdiffToken.ChunkHeader64=void 0;const Token$2=lib,FourCC_1$1=FourCC;DsdiffToken.ChunkHeader64={len:12,get:(e,t)=>({chunkID:FourCC_1$1.FourCcToken.get(e,t),chunkSize:Token$2.INT64_BE.get(e,t+4)})},Object.defineProperty(DsdiffParser$1,"__esModule",{value:!0}),DsdiffParser$1.DsdiffParser=void 0;const Token$1=lib,initDebug=browser.exports,FourCC_1=FourCC,BasicParser_1$1=BasicParser$1,DsdiffToken_1=DsdiffToken,strtok3$1=core$1,ID3v2Parser_1=ID3v2Parser$1,debug$2=initDebug("music-metadata:parser:aiff");class DsdiffParser extends BasicParser_1$1.BasicParser{async parse(){const e=await this.tokenizer.readToken(DsdiffToken_1.ChunkHeader64);if("FRM8"!==e.chunkID)throw new Error("Unexpected chunk-ID");const t=(await this.tokenizer.readToken(FourCC_1.FourCcToken)).trim();switch(t){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${t}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(FourCC_1.FourCcToken.len));default:throw Error(`Unsupported DSDIFF type: ${t}`)}}async readFmt8Chunks(e){for(;e>=DsdiffToken_1.ChunkHeader64.len;){const t=await this.tokenizer.readToken(DsdiffToken_1.ChunkHeader64);debug$2(`Chunk id=${t.chunkID}`),await this.readData(t),e-=BigInt(DsdiffToken_1.ChunkHeader64.len)+t.chunkSize}}async readData(e){debug$2(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const t=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":const t=await this.tokenizer.readToken(Token$1.UINT32_LE);debug$2(`DSDIFF version=${t}`);break;case"PROP":if("SND "!==await this.tokenizer.readToken(FourCC_1.FourCcToken))throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(FourCC_1.FourCcToken.len));break;case"ID3":const r=await this.tokenizer.readToken(new Token$1.Uint8ArrayType(Number(e.chunkSize))),n=strtok3$1.fromBuffer(r);await(new ID3v2Parser_1.ID3v2Parser).parse(this.metadata,n,this.options);break;default:debug$2(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break;case"DSD":this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate)}const r=e.chunkSize-BigInt(this.tokenizer.position-t);r>0&&(debug$2(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(debug$2(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const t=await this.tokenizer.readToken(DsdiffToken_1.ChunkHeader64);debug$2(`Sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`);const r=this.tokenizer.position;switch(t.chunkID.trim()){case"FS":const e=await this.tokenizer.readToken(Token$1.UINT32_BE);this.metadata.setFormat("sampleRate",e);break;case"CHNL":const r=await this.tokenizer.readToken(Token$1.UINT16_BE);this.metadata.setFormat("numberOfChannels",r),await this.handleChannelChunks(t.chunkSize-BigInt(Token$1.UINT16_BE.len));break;case"CMPR":const n=(await this.tokenizer.readToken(FourCC_1.FourCcToken)).trim(),i=await this.tokenizer.readToken(Token$1.UINT8),o=await this.tokenizer.readToken(new Token$1.StringType(i,"ascii"));"DSD"===n&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${n} (${o})`);break;case"ABSS":const a=await this.tokenizer.readToken(Token$1.UINT16_BE),s=await this.tokenizer.readToken(Token$1.UINT8),c=await this.tokenizer.readToken(Token$1.UINT8),u=await this.tokenizer.readToken(Token$1.UINT32_BE);debug$2(`ABSS ${a}:${s}:${c}.${u}`);break;case"LSCO":const l=await this.tokenizer.readToken(Token$1.UINT16_BE);debug$2(`LSCO lsConfig=${l}`);break;case"COMT":default:debug$2(`Unknown sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`),await this.tokenizer.ignore(Number(t.chunkSize))}const n=t.chunkSize-BigInt(this.tokenizer.position-r);n>0&&(debug$2(`After Parsing sound-property-chunk ${t.chunkSize}, remaining ${n} bytes`),await this.tokenizer.ignore(Number(n))),e-=BigInt(DsdiffToken_1.ChunkHeader64.len)+t.chunkSize,debug$2(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const e=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",e)}}async handleChannelChunks(e){debug$2(`Parsing channel-chunks, remainingSize=${e}`);const t=[];for(;e>=FourCC_1.FourCcToken.len;){const r=await this.tokenizer.readToken(FourCC_1.FourCcToken);debug$2(`Channel[ID=${r}]`),t.push(r),e-=BigInt(FourCC_1.FourCcToken.len)}return debug$2(`Channels: ${t.join(", ")}`),t}}DsdiffParser$1.DsdiffParser=DsdiffParser;var MatroskaParser$1={},types={};!function(e){var t,r;Object.defineProperty(e,"__esModule",{value:!0}),e.TrackType=e.TargetType=e.DataType=void 0,(t=e.DataType||(e.DataType={}))[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float",(r=e.TargetType||(e.TargetType={}))[r.shot=10]="shot",r[r.scene=20]="scene",r[r.track=30]="track",r[r.part=40]="part",r[r.album=50]="album",r[r.edition=60]="edition",r[r.collection=70]="collection",function(e){e[e.video=1]="video",e[e.audio=2]="audio",e[e.complex=3]="complex",e[e.logo=4]="logo",e[e.subtitle=17]="subtitle",e[e.button=18]="button",e[e.control=32]="control"}(e.TrackType||(e.TrackType={}))}(types);var MatroskaDtd={};Object.defineProperty(MatroskaDtd,"__esModule",{value:!0}),MatroskaDtd.elements=void 0;const types_1$1=types;MatroskaDtd.elements={440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:types_1$1.DataType.uint},17143:{name:"ebmlReadVersion",value:types_1$1.DataType.uint},17138:{name:"ebmlMaxIDWidth",value:types_1$1.DataType.uint},17139:{name:"ebmlMaxSizeWidth",value:types_1$1.DataType.uint},17026:{name:"docType",value:types_1$1.DataType.string},17031:{name:"docTypeVersion",value:types_1$1.DataType.uint},17029:{name:"docTypeReadVersion",value:types_1$1.DataType.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",container:{21419:{name:"seekId",value:types_1$1.DataType.binary},21420:{name:"seekPosition",value:types_1$1.DataType.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:types_1$1.DataType.uid},29572:{name:"filename",value:types_1$1.DataType.string},3979555:{name:"prevUID",value:types_1$1.DataType.uid},3965867:{name:"prevFilename",value:types_1$1.DataType.string},4110627:{name:"nextUID",value:types_1$1.DataType.uid},4096955:{name:"nextFilename",value:types_1$1.DataType.string},2807729:{name:"timecodeScale",value:types_1$1.DataType.uint},17545:{name:"duration",value:types_1$1.DataType.float},17505:{name:"dateUTC",value:types_1$1.DataType.uint},31657:{name:"title",value:types_1$1.DataType.string},19840:{name:"muxingApp",value:types_1$1.DataType.string},22337:{name:"writingApp",value:types_1$1.DataType.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:types_1$1.DataType.uid},163:{name:"unknown",value:types_1$1.DataType.binary},167:{name:"position",value:types_1$1.DataType.uid},171:{name:"prevSize",value:types_1$1.DataType.uid}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:types_1$1.DataType.uint},29637:{name:"uid",value:types_1$1.DataType.uid},131:{name:"trackType",value:types_1$1.DataType.uint},185:{name:"flagEnabled",value:types_1$1.DataType.bool},136:{name:"flagDefault",value:types_1$1.DataType.bool},21930:{name:"flagForced",value:types_1$1.DataType.bool},156:{name:"flagLacing",value:types_1$1.DataType.bool},28135:{name:"minCache",value:types_1$1.DataType.uint},28136:{name:"maxCache",value:types_1$1.DataType.uint},2352003:{name:"defaultDuration",value:types_1$1.DataType.uint},2306383:{name:"timecodeScale",value:types_1$1.DataType.float},21358:{name:"name",value:types_1$1.DataType.string},2274716:{name:"language",value:types_1$1.DataType.string},134:{name:"codecID",value:types_1$1.DataType.string},25506:{name:"codecPrivate",value:types_1$1.DataType.binary},2459272:{name:"codecName",value:types_1$1.DataType.string},3839639:{name:"codecSettings",value:types_1$1.DataType.string},3883072:{name:"codecInfoUrl",value:types_1$1.DataType.string},2536e3:{name:"codecDownloadUrl",value:types_1$1.DataType.string},170:{name:"codecDecodeAll",value:types_1$1.DataType.bool},28587:{name:"trackOverlay",value:types_1$1.DataType.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:types_1$1.DataType.bool},21432:{name:"stereoMode",value:types_1$1.DataType.uint},176:{name:"pixelWidth",value:types_1$1.DataType.uint},186:{name:"pixelHeight",value:types_1$1.DataType.uint},21680:{name:"displayWidth",value:types_1$1.DataType.uint},21690:{name:"displayHeight",value:types_1$1.DataType.uint},21683:{name:"aspectRatioType",value:types_1$1.DataType.uint},3061028:{name:"colourSpace",value:types_1$1.DataType.uint},3126563:{name:"gammaValue",value:types_1$1.DataType.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:types_1$1.DataType.float},30901:{name:"outputSamplingFrequency",value:types_1$1.DataType.float},159:{name:"channels",value:types_1$1.DataType.uint},148:{name:"channels",value:types_1$1.DataType.uint},32123:{name:"channelPositions",value:types_1$1.DataType.binary},25188:{name:"bitDepth",value:types_1$1.DataType.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:types_1$1.DataType.uint},20530:{name:"scope",value:types_1$1.DataType.bool},20531:{name:"type",value:types_1$1.DataType.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:types_1$1.DataType.uint},16981:{name:"contentCompSettings",value:types_1$1.DataType.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:types_1$1.DataType.uint},18402:{name:"contentEncKeyID",value:types_1$1.DataType.binary},18403:{name:"contentSignature ",value:types_1$1.DataType.binary},18404:{name:"ContentSigKeyID  ",value:types_1$1.DataType.binary},18405:{name:"contentSigAlgo ",value:types_1$1.DataType.uint},18406:{name:"contentSigHashAlgo ",value:types_1$1.DataType.uint}}},25188:{name:"bitDepth",value:types_1$1.DataType.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:types_1$1.DataType.uid},183:{name:"positions",container:{247:{name:"track",value:types_1$1.DataType.uint},241:{name:"clusterPosition",value:types_1$1.DataType.uint},21368:{name:"blockNumber",value:types_1$1.DataType.uint},234:{name:"codecState",value:types_1$1.DataType.uint},219:{name:"reference",container:{150:{name:"time",value:types_1$1.DataType.uint},151:{name:"cluster",value:types_1$1.DataType.uint},21343:{name:"number",value:types_1$1.DataType.uint},235:{name:"codecState",value:types_1$1.DataType.uint}}},240:{name:"relativePosition",value:types_1$1.DataType.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:types_1$1.DataType.string},18030:{name:"name",value:types_1$1.DataType.string},18016:{name:"mimeType",value:types_1$1.DataType.string},18012:{name:"data",value:types_1$1.DataType.binary},18094:{name:"uid",value:types_1$1.DataType.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:types_1$1.DataType.uid},145:{name:"timeStart",value:types_1$1.DataType.uint},146:{name:"timeEnd",value:types_1$1.DataType.uid},152:{name:"hidden",value:types_1$1.DataType.bool},17816:{name:"enabled",value:types_1$1.DataType.uid},143:{name:"track",container:{137:{name:"trackNumber",value:types_1$1.DataType.uid},128:{name:"display",container:{133:{name:"string",value:types_1$1.DataType.string},17276:{name:"language ",value:types_1$1.DataType.string},17278:{name:"country ",value:types_1$1.DataType.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:types_1$1.DataType.uid},25540:{name:"tagChapterUID",value:types_1$1.DataType.uint},25542:{name:"tagAttachmentUID",value:types_1$1.DataType.uid},25546:{name:"targetType",value:types_1$1.DataType.string},26826:{name:"targetTypeValue",value:types_1$1.DataType.uint},25545:{name:"tagEditionUID",value:types_1$1.DataType.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:types_1$1.DataType.string},17543:{name:"string",value:types_1$1.DataType.string},17541:{name:"binary",value:types_1$1.DataType.binary},17530:{name:"language",value:types_1$1.DataType.string},17531:{name:"languageIETF",value:types_1$1.DataType.string},17540:{name:"default",value:types_1$1.DataType.bool}}}}}}}}}},Object.defineProperty(MatroskaParser$1,"__esModule",{value:!0}),MatroskaParser$1.MatroskaParser=void 0;const Token=lib,_debug$1=browser.exports,BasicParser_1=BasicParser$1,types_1=types,matroskaDtd=MatroskaDtd,debug$1=_debug$1("music-metadata:parser:matroska");class MatroskaParser extends BasicParser_1.BasicParser{constructor(){super(),this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(types_1.DataType.uint,(e=>this.readUint(e))),this.parserMap.set(types_1.DataType.string,(e=>this.readString(e))),this.parserMap.set(types_1.DataType.binary,(e=>this.readBuffer(e))),this.parserMap.set(types_1.DataType.uid,(async e=>1===await this.readUint(e))),this.parserMap.set(types_1.DataType.bool,(e=>this.readFlag(e))),this.parserMap.set(types_1.DataType.float,(e=>this.readFloat(e)))}init(e,t,r){return super.init(e,t,r),this}async parse(){const e=await this.parseContainer(matroskaDtd.elements,this.tokenizer.fileInfo.size,[]);if(this.metadata.setFormat("container",`EBML/${e.ebml.docType}`),e.segment){const t=e.segment.info;if(t){const e=t.timecodeScale?t.timecodeScale:1e6,r=t.duration*e/1e9;this.addTag("segment:title",t.title),this.metadata.setFormat("duration",r)}const r=e.segment.tracks;if(r&&r.entries){r.entries.forEach((e=>{const t={codecName:e.codecID.replace("A_","").replace("V_",""),codecSettings:e.codecSettings,flagDefault:e.flagDefault,flagLacing:e.flagLacing,flagEnabled:e.flagEnabled,language:e.language,name:e.name,type:e.trackType,audio:e.audio,video:e.video};this.metadata.addStreamInfo(t)}));const t=r.entries.filter((e=>e.trackType===types_1.TrackType.audio.valueOf())).reduce(((e,t)=>e?!e.flagDefault&&t.flagDefault||t.trackNumber&&t.trackNumber<e.trackNumber?t:e:t),null);t&&(this.metadata.setFormat("codec",t.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",t.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",t.audio.channels)),e.segment.tags&&e.segment.tags.tag.forEach((e=>{const t=e.target,r=t.targetTypeValue?types_1.TargetType[t.targetTypeValue]:t.targetType?t.targetType:"track";e.simpleTags.forEach((e=>{const t=e.string?e.string:e.binary;this.addTag(`${r}:${e.name}`,t)}))})),e.segment.attachments&&e.segment.attachments.attachedFiles.filter((e=>e.mimeType.startsWith("image/"))).map((e=>({data:e.data,format:e.mimeType,description:e.description,name:e.name}))).forEach((e=>{this.addTag("picture",e)}))}}}async parseContainer(e,t,r){const n={};for(;this.tokenizer.position<t;){let t;try{t=await this.readElement()}catch(i){if("End-Of-Stream"===i.message)break;throw i}const o=e[t.id];if(o)if(debug$1(`Element: name=${o.name}, container=${!!o.container}`),o.container){const e=await this.parseContainer(o.container,t.len>=0?this.tokenizer.position+t.len:-1,r.concat([o.name]));o.multiple?(n[o.name]||(n[o.name]=[]),n[o.name].push(e)):n[o.name]=e}else n[o.name]=await this.parserMap.get(o.value)(t);else switch(t.id){case 236:this.padding+=t.len,await this.tokenizer.ignore(t.len);break;default:debug$1(`parseEbml: path=${r.join("/")}, unknown element: id=${t.id.toString(16)}`),this.padding+=t.len,await this.tokenizer.ignore(t.len)}}return n}async readVintData(e){const t=await this.tokenizer.peekNumber(Token.UINT8);let r=128,n=1;for(;0==(t&r);){if(n>e)throw new Error("VINT value exceeding maximum size");++n,r>>=1}const i=Buffer.alloc(n);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),t=await this.readVintData(this.ebmlMaxSizeLength);t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}isMaxValue(e){if(e.length===this.ebmlMaxSizeLength){for(let t=1;t<this.ebmlMaxSizeLength;++t)if(255!==e[t])return!1;return!0}return!1}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(Token.Float32_BE);case 8:case 10:return this.tokenizer.readNumber(Token.Float64_BE);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return 1===await this.readUint(e)}async readUint(e){const t=await this.readBuffer(e),r=Math.min(6,e.len);return t.readUIntBE(e.len-r,r)}async readString(e){return this.tokenizer.readToken(new Token.StringType(e.len,"utf-8"))}async readBuffer(e){const t=Buffer.alloc(e.len);return await this.tokenizer.readBuffer(t),t}addTag(e,t){this.metadata.addTag("matroska",e,t)}}MatroskaParser$1.MatroskaParser=MatroskaParser,Object.defineProperty(ParserFactory$1,"__esModule",{value:!0}),ParserFactory$1.ParserFactory=ParserFactory$1.parseHttpContentType=void 0;const FileType=core,ContentType=contentType,MimeType=mediaTyper,_debug=browser.exports,MetadataCollector_1=MetadataCollector$1,AiffParser_1=AiffParser,APEv2Parser_1$1=APEv2Parser$1,AsfParser_1=AsfParser$1,FlacParser_1=FlacParser$1,MP4Parser_1=MP4Parser$1,MpegParser_1=MpegParser$1,musepack_1=musepack,OggParser_1=OggParser$1,WaveParser_1=WaveParser$1,WavPackParser_1=WavPackParser$1,DsfParser_1=DsfParser$1,DsdiffParser_1=DsdiffParser$1,MatroskaParser_1=MatroskaParser$1,debug=_debug("music-metadata:parser:factory");function parseHttpContentType(e){const t=ContentType.parse(e),r=MimeType.parse(t.type);return{type:r.type,subtype:r.subtype,suffix:r.suffix,parameters:t.parameters}}ParserFactory$1.parseHttpContentType=parseHttpContentType;class ParserFactory{static async parseOnContentType(e,t){const{mimeType:r,path:n,url:i}=await e.fileInfo,o=ParserFactory.getParserIdForMimeType(r)||ParserFactory.getParserIdForExtension(n)||ParserFactory.getParserIdForExtension(i);return o||debug("No parser found for MIME-type / extension: "+r),this.parse(e,o,t)}static async parse(e,t,r){if(!t){debug("Guess parser on content...");const r=Buffer.alloc(4100);if(await e.peekBuffer(r,{mayBeLess:!0}),e.fileInfo.path&&(t=this.getParserIdForExtension(e.fileInfo.path)),!t){const e=await FileType.fromBuffer(r);if(!e)throw new Error("Failed to determine audio format");if(debug(`Guessed file type is mime=${e.mime}, extension=${e.ext}`),!(t=ParserFactory.getParserIdForMimeType(e.mime)))throw new Error("Guessed MIME-type not supported: "+e.mime)}}return this._parse(e,t,r)}static getParserIdForExtension(e){if(!e)return;switch(this.getExtension(e).toLocaleLowerCase()||e){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}static async loadParser(e){switch(e){case"aiff":return new AiffParser_1.AIFFParser;case"adts":case"mpeg":return new MpegParser_1.MpegParser;case"apev2":return new APEv2Parser_1$1.APEv2Parser;case"asf":return new AsfParser_1.AsfParser;case"dsf":return new DsfParser_1.DsfParser;case"dsdiff":return new DsdiffParser_1.DsdiffParser;case"flac":return new FlacParser_1.FlacParser;case"mp4":return new MP4Parser_1.MP4Parser;case"musepack":return new musepack_1.default;case"ogg":return new OggParser_1.OggParser;case"riff":return new WaveParser_1.WaveParser;case"wavpack":return new WavPackParser_1.WavPackParser;case"matroska":return new MatroskaParser_1.MatroskaParser;default:throw new Error(`Unknown parser type: ${e}`)}}static async _parse(e,t,r={}){const n=await ParserFactory.loadParser(t),i=new MetadataCollector_1.MetadataCollector(r);return await n.init(i,e,r).parse(),i.toCommonMetadata()}static getExtension(e){const t=e.lastIndexOf(".");return-1===t?"":e.slice(t)}static getParserIdForMimeType(e){let t;try{t=parseHttpContentType(e)}catch(n){return void debug(`Invalid HTTP Content-Type header value: ${e}`)}const r=0===t.subtype.indexOf("x-")?t.subtype.substring(2):t.subtype;switch(t.type){case"audio":switch(r){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(r){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(r){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}}}}ParserFactory$1.ParserFactory=ParserFactory;var RandomUint8ArrayReader$1={};Object.defineProperty(RandomUint8ArrayReader$1,"__esModule",{value:!0}),RandomUint8ArrayReader$1.RandomUint8ArrayReader=void 0;class RandomUint8ArrayReader{constructor(e){this.uint8Array=e,this.fileSize=e.length}async randomRead(e,t,r,n){return e.set(this.uint8Array.subarray(n,n+r),t),r}}RandomUint8ArrayReader$1.RandomUint8ArrayReader=RandomUint8ArrayReader;var Lyrics3={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getLyricsHeaderLength=e.endTag2=void 0,e.endTag2="LYRICS200",e.getLyricsHeaderLength=async function(t){if(t.fileSize>=143){const r=Buffer.alloc(15);await t.randomRead(r,0,r.length,t.fileSize-143);const n=r.toString("binary");if(n.substr(6)===e.endTag2)return parseInt(n.substr(0,6),10)+15}return 0}}(Lyrics3),Object.defineProperty(core$2,"__esModule",{value:!0}),core$2.scanAppendingHeaders=core$2.selectCover=core$2.ratingToStars=core$2.orderTags=core$2.parseFromTokenizer=parseBuffer_1=core$2.parseBuffer=core$2.parseStream=void 0;const strtok3=core$1,ParserFactory_1=ParserFactory$1,RandomUint8ArrayReader_1=RandomUint8ArrayReader$1,APEv2Parser_1=APEv2Parser$1,ID3v1Parser_1=ID3v1Parser,Lyrics3_1=Lyrics3;function parseStream(e,t,r={}){return parseFromTokenizer(strtok3.fromStream(e,"string"==typeof t?{mimeType:t}:t),r)}async function parseBuffer(e,t,r={}){const n=new RandomUint8ArrayReader_1.RandomUint8ArrayReader(e);await scanAppendingHeaders(n,r);return parseFromTokenizer(strtok3.fromBuffer(e,"string"==typeof t?{mimeType:t}:t),r)}core$2.parseStream=parseStream;var parseBuffer_1=core$2.parseBuffer=parseBuffer;function parseFromTokenizer(e,t){return ParserFactory_1.ParserFactory.parseOnContentType(e,t)}function orderTags(e){const t={};for(const r of e)(t[r.id]=t[r.id]||[]).push(r.value);return t}function ratingToStars(e){return void 0===e?0:1+Math.round(4*e)}function selectCover(e){return e?e.reduce(((e,t)=>t.name&&t.name.toLowerCase()in["front","cover","cover (front)"]?t:e)):null}async function scanAppendingHeaders(e,t={}){let r=e.fileSize;if(await ID3v1Parser_1.hasID3v1Header(e)){r-=128;r-=await Lyrics3_1.getLyricsHeaderLength(e)}t.apeHeader=await APEv2Parser_1.APEv2Parser.findApeFooterOffset(e,r)}core$2.parseFromTokenizer=parseFromTokenizer,core$2.orderTags=orderTags,core$2.ratingToStars=ratingToStars,core$2.selectCover=selectCover,core$2.scanAppendingHeaders=scanAppendingHeaders;export{withModifiers as A,withCtx as B,normalizeProps as C,guardReactiveProps as D,createApp as E,Fragment as F,a as G,createStaticVNode as H,commonjsGlobal as I,getAugmentedNamespace as J,AbstractTokenizer$1 as K,lib$1 as L,core$1 as M,core$2 as N,browser as O,ParserFactory$1 as P,commonjsRequire as Q,Teleport as T,createCommentVNode as a,createBaseVNode as b,createElementBlock as c,browserfs as d,eventemitter2 as e,parseBuffer_1 as f,pushScopeId as g,popScopeId as h,h$1 as i,createTextVNode as j,createVNode as k,normalizeStyle as l,reactive as m,normalizeClass as n,openBlock as o,pathBrowserify as p,vModelText as q,resolveComponent as r,withKeys as s,toDisplayString as t,renderList as u,vShow as v,withDirectives as w,createBlock as x,mergeProps as y,renderSlot as z};
